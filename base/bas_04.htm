<html><!-- #BeginTemplate "/Templates/Corso Base.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Capitolo 4 del Corso Base</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo">Corso base - Lezione <!-- #BeginEditable "LEZIONE" -->4<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/base.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<!-- #BeginEditable "ARGOMENTI" --> 
<ul>
  <li><a href="bas_04.htm#STEP1">Il nostro primo programma</a>.</li>
  <li><a href="bas_04.htm#STEP2">Prime propriet&agrave; degli oggetti Form e Label</a>.</li>
  <li><a href="bas_04.htm#STEP3">Esecuzione del programma</a>.</li>
  <li><a href="bas_04.htm#STEP4">Impostazione delle propriet&agrave; in fase di 
    progettazione ed in fase di esecuzione</a>.</li>
</ul>
<!-- #EndEditable -->
<hr>

<table width="100%" border="0">
  <tr> 
    <td width="80%"><script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><a name="STEP1"></a>&Egrave; giunto il momento di trasformare in pratica 
        tutto quello che abbiamo visto nelle lezioni precedenti. Qui comincia 
        la parte veramente divertente di questo linguaggio.<img src="../images/lezioni/bas04_01.jpg" width="195" height="146" align="right" alt="Figura 1"></p>
      <p>Riprendiamo il progetto iniziato nella lezione 1 e rivisto nella lezione 
        2.</p>
      <p> Non appena si presenta l'IDE con il nostro progetto, la prima cosa che 
        salta all'occhio &egrave; la parte centrale con quella finestra vuota, 
        la cui barra del titolo segnala <b>Form1</b>.</p>
      <p>Quello spazio &egrave; un <a href="../thunder/thnd_00.htm"><b><i>Form</i></b> 
        <img src="../images/controls/form.gif" width="25" height="25" align="absmiddle" border="0"></a>, 
        una finestra per l'utente del programma. Sar&agrave; la nostra area di 
        lavoro. Sopra il nostro form inseriremo tutti i componenti per fare un 
        programma che faccia qualcosa di utile e soprattutto, lo faccia bene.</p>
      <hr>
      <p><a name="STEP2"></a><img src="../images/lezioni/bas02_06.jpg" width="168" height="220" align="right" alt="Figura 2">Diamo 
        uno sguardo anche alla finestra delle propriet&agrave; <img src="../images/ide/propr.gif" width="16" height="16" align="absmiddle">, 
        vista nella lezione 2.<br>
        Nella figura a lato possiamo notare due aree: quella in alto identifica 
        l'oggetto preso in esame nell'area sottostante, area che evidenzier&agrave; 
        alcune propriet&agrave;.</p>
      <p>Nel nostro caso in alto abbiamo l'oggetto <b>Form1</b>, <a href="../glossary/i.htm#ISTANZA">istanza</a> 
        della <a href="../glossary/c.htm#CLASSE">classe</a> <img src="../images/ide/classe.gif" width="16" height="16" align="absmiddle"> 
        <b>Form</b>. Subito sotto abbiamo un elenco di propriet&agrave; <img src="../images/ide/propr.gif" width="16" height="16" align="absmiddle"> 
        legate a questa istanza.</p>
      <p>La prima propriet&agrave; &egrave; <i>Name</i>, che identifica univocamente 
        un oggetto. All'interno di uno stesso progetto non pu&ograve; esistere 
        un form il cui nome &egrave; uguale ad un altro oggetto, sia esso form 
        o altro. poich&eacute; faremo uso di un solo form, per ora, lasciamo il 
        nome standard fornito: Form1. Questo sar&agrave; il nome attraverso il 
        quale opereremo su questa particolare istanza di form.</p>
      <p>Subito sotto la propriet&agrave; Name ne troviamo altre che regolano 
        il comportamento e lo stile del nostro form. Nota che ci sono le freccette 
        per salire e scendere nell'elenco, indice che queste non sono le uniche 
        propriet&agrave; a disposizione. Abbiamo evidenziato l'ultima propriet&agrave; 
        visibile, cio&egrave; la propriet&agrave; <b>Caption</b>. Questa identifica 
        il titolo presente sopra la nostra finestra, come possiamo vedere nella 
        prima figura e come vediamo spiegato nella casella subito sotto la nostra 
        propriet&agrave;. Prova a modificare il valore della propriet&agrave; 
        Caption da Form1 a &quot;Visual Basic &egrave; semplice&quot; e vedrai 
        subito il cambiamento nel titolo del form.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>L'oggetto form ha decine di propriet&agrave; da impostare. Caption &egrave; 
        solo una d'esse. Vediamo per esempio altre due propriet&agrave;, poste 
        un po' pi&ugrave; in basso di quella appena vista, cio&egrave; le propriet&agrave; 
        MinButton e MaxButton. Queste due propriet&agrave; regolano la presenza 
        e l'attivazione dei pulsanti di riduzione ad icona e di ingrandimento 
        del form. Vediamo come stanno le cose inizialmente.</p>
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td width="152" height="49" valign="middle"><img src="../images/lezioni/bas04_02.jpg" width="152" height="49" align="left" alt="Figura 3"></td>
          <td>Come si nota, entrambe le propriet&agrave; sono impostate a True 
            (VERO) e sul form appaiono entrambi i pulsanti di riduzione ad icona 
            e di ingrandimento della finestra.</td>
          <td width="71" height="49" valign="middle"><img src="../images/lezioni/bas04_03.jpg" width="71" height="49" align="right" alt="Figura 4"></td>
        </tr>
      </table>
      <p><img src="../images/lezioni/bas04_04.jpg" width="275" height="119" align="right" alt="Figura 5">Proviamo 
        a vedere che succede se impostiamo entrambe le suddette propriet&agrave; 
        a False (FALSO).</p>
      <p>Ecco che i due pulsanti di ridimensionamento sono spariti.</p>
      <p>Se avessimo, invece, impostato soltanto una delle due propriet&agrave; 
        a False, i pulsanti sarebbero rimasti entrambi, ma quello la cui propriet&agrave; 
        &egrave; stata impostata a False sar&agrave; disabilitato. Visibile ma 
        non cliccabile.</p>
      <p>Per avere un'idea pi&ugrave; chiara della classe Form clicca sulla sezione 
        Controlli Thunder e poi Form. Se vuoi andare direttamente a quella pagina 
        clicca <a href="../thunder/thnd_00.htm">qui</a>.</p>
      <hr>
      <p>Introduciamo un nuovo tipo di oggetto, anzi di classe. La classe <a href="../thunder/thnd_01.htm"><b><i>Label</i></b></a> 
        &egrave; presente nella casella degli strumenti <img src="../images/ide/toolbox.gif" width="16" height="16" align="absmiddle"> 
        con il pulsante<a href="../thunder/thnd_01.htm"><img src="../images/controls/label.gif" width="25" height="25" align="texttop" border="0"></a> 
      </p>
      <p>Per creare un'istanza della classe Label (quindi un oggetto Label) basta 
        cliccare due volte sulla sua icona oppure cliccare solo una volta sull'icona 
        e tracciare un rettangolo sul form, tenendo il tasto sinistro del mouse 
        premuto.</p>
      <p>Verr&agrave; creato un oggetto di nome Label1 (il nome, lo ricordiamo, 
        &egrave; visibile nella finestra delle propriet&agrave; vista prima). 
        A che serve una Label? In inglese significa etichetta, e serve a scrivere 
        delle informazioni (in genere visibili) sopra un form. Potrebbe fungere 
        da istruzioni sull'uso delle funzioni della finestra.</p>
      <p>Per scrivere le informazioni sull'oggetto Label, impostare la propriet&agrave; 
        Caption con la frase che si intende far apparire in essa. Se la frase 
        &egrave; troppo lunga potrebbe non entrare nella Label. In tal caso basta 
        cliccare una volta sull'oggetto di cui modificare le dimensioni (la nostra 
        Label1), ed assicurarsi che compaiano i quadratini di ridimensionamento 
        come mostrato nella figura 6.<br>
        Fatto questo <i>prendere</i> uno dei quadratini e trascinarlo fino a formare 
        la dimensione desiderata. I quadratini per tutta l'operazione di trascinamento 
        spariranno e al loro posto si evidenzier&agrave; il bordo, come mostrato 
        nella figura 7. Quando ottenuta la forma desiderata, lasciare il tasto 
        del mouse, et voil&agrave;, il gioco &egrave; fatto.</p>
      <table border="0" cellspacing="0" cellpadding="0" width="528" align="center">
        <tr> 
          <td width="111" height="65" align="center" valign="top"> 
            <p><img src="../images/lezioni/bas04_05.png" width="111" height="65" alt="Figura 6"><br>
              <b>Figura 6</b> </p>
          </td>
          <td width="169" height="65" align="center" valign="top"><img src="../images/lezioni/bas04_06.png" width="169" height="65" alt="Figura 7"><br>
            <b>Figura 7</b> </td>
          <td height="65" valign="top" align="center" width="248"><img src="../images/lezioni/bas04_07.png" width="248" height="65" alt="Figura 8"><br>
            <b>Figura 8</b> </td>
        </tr>
      </table>
      <p>Se si vuole evitare di dover ridimensionare ogni volta la Label si pu&ograve; 
        impostare la propriet&agrave; <b>Autosize</b> (Autodimensionamento) a 
        True. Cos&igrave; facendo, ogni volta che si modifica il contenuto della 
        label, ossia la propriet&agrave; Caption, il rettangolo prender&agrave; 
        la forma giusta per far visualizzare il testo.</p>
      <p>Se si vuole spostare la posizione di una label si pu&ograve; afferrare 
        la nostra Label1 e trascinarla a spasso per lo schermo e rilasciarla dove 
        vogliamo che essa si posi.</p>
      <hr>
      <p><a name="STEP3"></a>&Egrave; giunto il tempo di provare il nostro programma 
        e vedere nei fatti cosa viene presentato all'utilizzatore del programma.</p>
      <p>Per passare dalla <a href="../glossary/f.htm#FASEDIPROGETTAZIONE">fase 
        di progettazione</a> alla <a href="../glossary/f.htm#FASEDIESECUZIONE">fase 
        di esecuzione</a> premere il tasto F5 oppure aprire il menu Esegui e cliccare 
        la voce Avvia. In pochi istanti apparir&agrave; il programma vero e proprio. 
        In questa fase potrete notare che non &egrave; pi&ugrave; possibile prendere 
        gli oggetti sul form e trascinarli, oppure modificarli.</p>
      <p>Infatti il programma, una volta terminato e <a href="../glossary/c.htm#COMPILAZIONE">compilato</a> 
        per renderlo utilizzabile su ogni computer, non pu&ograve; essere pi&ugrave; 
        modificato. L'unica possibilit&agrave; di effettuare modifiche al programma 
        &egrave; data dal possedere i codici sorgente, i codici in linguaggio 
        Visual Basic. Un normale utilizzatore normalmente riceve una copia del 
        programma funzionante, ma non i codici sorgente, escludendo quindi la 
        possibilit&agrave; di modificare il programma.</p>
      <p>Per chiudere il programma e ritornare a Visual Basic premere la X in 
        alto a destra del nostro Form1 (mi raccomando, non il pulsante di chiusura 
        di VB, ma quello del Form).</p>
      <hr>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><a name="STEP4"></a>Sarebbe molto stupido e del tutto inutile un programma 
        statico, non mutabile ed incapace di rispondere alle azioni del suo utilizzatore. 
        Per questo &egrave; possibile ripetere le stesse operazioni effettuate 
        nella fase di progettazione, al momento in cui &egrave; necessario.</p>
      <p>Per esempio possiamo fare in modo che ogni volta che l'utente clicca 
        su una parte del Form1, all'interno della nostra Label1 viene mostrata 
        la data e l'ora attuali.</p>
      <p>Per far questo ci dobbiamo ricollegare al concetto di <a href="../glossary/e.htm#EVENTO">evento</a> 
        <img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle">, 
        visto nella lezione precedente. Nel nostro caso vogliamo sfruttare l'evento 
        che scatta al momento in cui l'utente clicca con il mouse sul Form.</p>
      <p>Innanzitutto abbandoniamo la finestra di progettazione e passiamo alla 
        finesta del codice, la vera parte della programmazione Visual Basic. Aprire 
        il menu Visualizza e scegliere la voce Codice <img src="../images/ide/codice.gif" width="16" height="16" align="absmiddle"> 
        (la prima) oppure premere il tasto F7.</p>
      <p>Si aprir&agrave; la videata bianca del codice, come appare nella figura 
        9.</p>
      <p align="center"><img src="../images/lezioni/bas04_08.jpg" width="434" height="149" alt="Figura 9"> 
        <br>
        <b>Figura 9</b></p>
      <p align="left">Possiamo dividere questa finestra in tre parti:</p>
      <ol>
        <li>La casella in alto a sinistra indica gli oggetti presenti nel form.</li>
        <li>La casella in alto a destra riporta gli eventi corrispondenti all'oggetto 
          selezionato nella casella di sinistra.</li>
        <li>L'area principale dove si scrive il codice.</li>
      </ol>
      <p>Se premiamo sulla casella di sinistra ci vengono riportati tutti gli 
        oggetti del nostro form, cio&egrave; il Form stesso e la Label1 che abbiamo 
        inserito in esso.</p>
      <p>Se siete stati attenti avrete notato che nella casella di sinistra non 
        ci viene riportato il nome del form, cio&egrave; Form1, ma soltanto Form. 
        Tuttavia questa stranezza non intende cambiare il nome al form. Se vogliamo 
        riferirci al nostro Form1, dovremo scrivere sempre Form1. Se all'interno 
        di Form1 intendiamo impostare la propriet&agrave; Caption potremo utilizzare 
        Form1.Caption, oppure Me.Caption. Infatti ogni form, all'interno di se 
        stesso si chiama Me.</p>
      <p>Clicchiamo sulla casella degli oggetti e scegliamo l'oggetto Form. Ci 
        verr&agrave; in automatico creata una funzione di nome Form_Load. Se adesso 
        guardiamo sulla casella di destra troviamo scritto Load. Ebbene questo 
        significa che la funzione che il computer ci ha generato in automatico 
        &egrave; la funzione collegata all'<b>evento</b> Load.</p>
      <p>Ma la funzione che serve a noi &egrave; quella collegata all'evento del 
        click del mouse sul Form, non quella collegata al caricamento del form 
        (Load). Per cui clicchiamo sulla casella di destra e cerchiamo l'evento 
        Click (in alto). Alla selezione dell'evento viene creata in automatico 
        la funzione Form_Click.</p>
      <p>Le funzioni collegate agli eventi hanno questa struttura:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub <b>NomeOggetto_NomeEvento</b>(parametri)</li>
        <li></li>
        <li>End Sub</li>
      </ol>
      <p>Nel nostro esempio specifico abbiamo infatti:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub Form_Click()</li>
        <li></li>
        <li>End Sub</li>
      </ol>
      <p>Torniamo al nostro esempio. Vogliamo scrivere nella etichetta Label1 
        la data e l'ora del momento in cui l'utente clicca sul form. Innanzitutto, 
        come detto prima, per impostare il testo di una Label bisogna impostare 
        la propriet&agrave; Caption. Per cui scriviamo all'interno della funzione 
        legata all'evento l'istruzione di aggiornamento. L'istruzione che ci d&agrave; 
        la data e l'ora corrente &egrave; Now.<br>
      </p>
      <p>Ecco la funzione completa per effettuare il nostro lavoro:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub Form_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Label1.Caption = Now</li>
        <li>End Sub</li>
      </ol>
      <p>Eseguiamo il programma e proviamolo per vedere l'effetto dell'utilizzo 
        dell'evento Click.<br>
      </p>
      <p>Per ritornare alla finestra di progettazione del form aprite il menu 
        Visualizza e cliccate la voce oggetto <img src="../images/ide/oggetto.gif" width="16" height="16" align="absmiddle"> 
        oppure premete la combinazione di tasti SHIFT+F7.</p>
      <p>Non appena finite di lavorare con questo progetto ricordatevi di salvarlo, 
        ma stavolta il processo di salvataggio sar&agrave; pi&ugrave; facile della 
        volta precedente poich&eacute; il progetto ha gi&agrave; un nome ed i 
        files sono gi&agrave; stati impostati. In pratica non vi accorgerete neanche 
        che ha salvato.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" -->Questo era un ottimo esempio per vedere 
      il funzionamento delle propriet&agrave; a <a href="../glossary/r.htm#RUNTIME">Run 
      Time</a>, infatti durante l'esecuzione del programma non possiamo sfruttare 
      la finestra delle propriet&agrave; e non possiamo stabilire a priori il 
      momento in cui l'utente cliccher&agrave; sul form.<!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=2">Mauro 
        Scaini</a><br>
        25 Ottobre 2000<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><!-- #BeginEditable "LEZIONEPREC" --><a href="bas_03.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna alla terza lezione</a><!-- #EndEditable --></td>
    <td align="right"><!-- #BeginEditable "LEZIONESUCC" --><a href="bas_05.htm">Vai 
      alla quinta lezione <img src="../images/vbnext.jpg" width="49" height="32" align="absmiddle" border="0"></a><!-- #EndEditable --></td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
