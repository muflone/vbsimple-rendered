<html><!-- #BeginTemplate "/Templates/Corso Intermedio2.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Capitolo 3 del Corso Intermedio</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo">Corso Intermedio - Lezione <!-- #BeginEditable "LEZIONE" -->3<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/intermed.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<!-- #BeginEditable "ARGOMENTI" --> 
<ul>
  <li><a href="int_03.htm#STEP1">Analisi pi&ugrave; approfondita del problema</a>.</li>
  <li><a href="int_03.htm#STEP2">Definizione della base dati</a>.</li>
  <li><a href="int_03.htm#STEP3">I diversi modificatori di accesso</a>.</li>
</ul>
<!-- #EndEditable -->
<hr>

<table width="100%" border="0">
  <tr> 
    <td width="80%"><script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><img src="../images/lezioni/int02_07.png" width="347" height="200" align="right" alt="Figura 1"><a name="STEP1"></a>Abbiamo 
        visto nella lezione precedente il funzionamento di base della nostra semplicissima 
        interfaccia utente.</p>
      <p>Proveremo inizialmente ad implementare i tre comandi di inserimento, 
        eliminazione e modifica dei brani.</p>
      <p>Abbiamo deciso di utilizzare un file binario con record a lunghezza fissa 
        ma analizzando meglio il problema scopriamo che arrivano gi&agrave; le 
        prime complicazioni: non &egrave; sufficiente archiviare le sole informazioni 
        sul titolo del brano, autore, titolo CD, etc...</p>
      <p>Non sarebbe infatti agevole effettuare il ritrovamento di un brano precedentemente 
        archiviato oppure la semplice consultazione del terzo brano senza eseguire 
        una scansione dell'intero archivio per ritrovare il brano corrispondente. 
        Utilizzeremo pertanto anche un numero <b>indice</b> per recuperare pi&ugrave; 
        velocemente i dati.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Proseguendo pi&ugrave; a fondo nell'analisi - e questo &egrave; <b class="sottolineato">il 
        compito dell'analista</b> - cosa accade all'inserimento di un nuovo brano? 
        I dati inseriti verranno semplicemente accodati ai dati preesistenti, 
        quindi sembra che non ci siano problemi nell'inserimento.</p>
      <p>Cosa accade invece dopo la modifica di un record esistente? Se la lunghezza 
        del singolo record fosse variabile l'operazione di aggiornamento di un 
        brano potrebbe andare a sovrascrivere i dati del record successivo oppure 
        lasciare dei <i>&quot;buchi&quot;</i> tra un record ed il successivo generando 
        possibili errori durante la lettura del record successivo a quello modificato. 
        <i>Fortunatamente</i> abbiamo scelto di usare un record a dimensione fissa 
        e pertanto tali problemi non si pongono durante la modifica. Durante lo 
        sviluppo di un progetto che utilizza degli archivi a record variabile 
        &egrave; importante anche tener conto di questi fattori al fine di trattare 
        correttamente i dati e concedere una certa robustezza ad un codice a rischio.</p>
      <p>Lo stesso problema dei <i>buchi</i> si genera anche tramite l'operazione 
        di cancellazione di un record esistente (l'eliminazione di un brano) indipendentemente 
        dalla lunghezza del record (fissa o variabile). Per evitare possibili 
        situazioni a rischio effettueremo un'operazione molto semplice: la cancellazione 
        vera e propria non effettuer&agrave; l'eliminazione fisica del brano (almeno 
        non subito) ma lo render&agrave; semplicemente nascosto all'utente. Una 
        successiva operazione di <b>compattazione</b> effettuer&agrave; la cancellazione 
        dei record segnati come eliminati. L'uso di tale tecnica consentir&agrave; 
        anche il ripristino di record eliminati accidentalmente ed una gestione 
        dello spazio pi&ugrave; semplice, anche se meno efficiente.</p>
      <p><a name="STEP2"></a>Alla luce di queste considerazioni verr&agrave; aggiunto 
        anche un valore indicativo dello stato di cancellazione del brano. Definiamo 
        pertanto la struttura della nostra base dati ovvero la struttura del record 
        a lunghezza fissa per la nostra base dati. Esso conterr&agrave; le seguenti 
        informazioni:</p>
      <ol>
        <li>Indice del brano</li>
        <li>Stato di cancellazione</li>
        <li>Titolo del brano, fino a 30 caratteri</li>
        <li>Autore del brano, fino a 30 caratteri</li>
        <li>Titolo del CD, fino a 20 caratteri</li>
        <li>Numero di traccia all'interno del CD</li>
        <li>Anno di pubblicazione</li>
        <li>Note, fino a 255 caratteri</li>
      </ol>
      <p>Il tutto si traduce in Visual Basic con:</p>
      <ol class="codicevb" start="1">
        <li>Public Type uDisco</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;intIndice As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;blnEliminato As Boolean</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTitoloBrano As String * 30</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strAutore As String * 30</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTitoloCD As String * 20</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;intTraccia As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;intAnnoPubblicazione As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strNote As String * 255</li>
        <li>End Type</li>
      </ol>
      <p><a name="STEP3"></a>Affinch&eacute; il tipo di dati <img src="../images/ide/tipoudt.gif" width="16" height="16" align="absmiddle"> 
        definiti dall'utente, definito d'ora in poi come <b>UDT</b> ovvero <i>User 
        Defined Type</i>, possa essere definito <b>Public</b> ovvero utilizzabile 
        all'interno di pi&ugrave; parti del progetto &egrave; necessario inserirlo 
        all'interno di un modulo <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
        standard. Non &egrave; infatti possibile dichiarare <b>Public</b> UDT, 
        stringhe a lunghezza fissa e <a href="../glossary/m.htm#MATRICE">matrici</a> 
        all'interno di un form ma soltanti dichiararli <b>Private</b> ovvero inaccessibili 
        alle altre parti del progetto.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Le istruzioni Private e Public sono anche dette attributi o modificatori 
        di accesso e non sono le uniche; sono riportati di seguito tutti i modificatori 
        di accesso con le loro caratteristiche di limitazione:</p>
      <ul>
        <li><b>Private</b><br>
          Utilizzabile soltanto nell'area delle dichiarazioni facendo riferimento 
          a variabili o costanti ed utilizzabile come attributo nelle dichiarazioni 
          delle routine.<br>
          Rende i dati o le funzioni accessibili soltanto al codice all'interno 
          del modulo in cui essi sono dichiarati. Pu&ograve; essere inserito in 
          qualsiasi modulo e con qualsiasi tipo di dato. &Egrave; l'attributo 
          predefinito nelle dichiarazioni di dati tramite l'istruzione <b><i>Dim</i></b>.<br>
          <br>
        </li>
        <li><b>Public</b><br>
          Utilizzabile soltanto nell'area delle dichiarazioni facendo riferimento 
          a variabili o costanti ed utilizzabile come attributo nelle dichiarazioni 
          delle routine.<br>
          Rende i dati o le routine accessibili a qualunque parte del codice e 
          non solo a quelle nello stesso modulo in cui essi sono dichiarati.<br>
          <br>
          Se inserito all'interno di un modulo standard, rende il dato accessibile 
          senza l'obbligo di specifica del nome del modulo ovvero mediante il 
          semplice riferimento al nome del dato o della funzione (ad esempio <b>NomeVar</b>).<br>
          <br>
          Non pu&ograve; essere inserito in moduli di classe, forms, o controlli 
          utente per rendere pubbliche costanti, stringhe di lunghezza fissa, 
          matrici o UDT. Per tutti gli altri tipi di dati rende gli stessi accesibili 
          mediante la specifica del nome dell'istanza seguita dal nome del membro 
          pubblico (ad esempio <b>Form1.NomeVar</b>).<br>
          <br>
        </li>
        <li><b>Global</b><br>
          Obsoleto e rimpiazzato da Public.<br>
          Pu&ograve; essere utilizzato soltanto all'interno di un modulo <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
          standard per rendere una variabile o una costante accessibile a tutte 
          le altre parti del progetto e solo in tale situazione svolge la stessa 
          azione dell'attributo Public.<br>
          <br>
        </li>
        <li><b>Friend</b><br>
          Applicabile esclusivamente alle routine, &egrave; utilizzabile esclusivamente 
          nei moduli di classe e nei forms per definire propriet&agrave; <img src="../images/ide/propr.gif" width="16" height="16" align="absmiddle"> 
          o metodi <img src="../images/ide/metodo.gif" width="16" height="16" align="absmiddle"> 
          accessibili a tutte le parti del codice presenti nel progetto in cui 
          il modulo &egrave; contenuto.<br>
          <br>
          In caso di un progetto singolo equivale l'attributo Public; inserito 
          invece in un modulo all'interno di un gruppo <img src="../images/ide/gruppo.gif" width="16" height="16" align="absmiddle"> 
          di progetti rende la routine utilizzabile esclusivamente all'interno 
          del progetto in cui tale modulo &egrave; contenuto.<br>
          <br>
          Ad esempio una routine di un controllo utente <img src="../images/ide/ctlutent.gif" width="16" height="16" align="absmiddle"> 
          dichiarata come Friend &egrave; accessibile all'intero progetto che 
          contiene il controllo utente stesso ma non al progetto che usufruisce 
          del controllo utente. Lo stessa situazione diventa palese nel momento 
          in cui il controllo utente viene compilato sotto forma di <a href="../glossary/o.htm#OCX">OCX</a>. 
          La routine dichiarata Friend sparisce dall'elenco delle routine.</li>
      </ul>
      <p>Allora perch&eacute; non dichiarare tutti i dati tramite Public e renderli 
        accessibili al resto del codice? Semplicemente perch&eacute; la buona 
        programmazione si fonda sulla robustezza di ogni modulo componente e sulla 
        sua autonomia dal resto del progetto. Rendere tutti i dati accessibili 
        alle altre parti del progetto ha parecchi svantaggi: innanzitutto un rischio 
        maggiore di confusione durante la scrittura del codice; a questo si aggiunge 
        anche la cattiva gestione di quei dati particolari la cui modifica dovrebbe 
        implicare la successione di altre strade. Ad esempio non c'&egrave; verso 
        di modificare la velocit&agrave; di una moto in corsa da 100 Km/h a 30 
        Km/h senza l'utilizzo del freno e quindi del richiamo del metodo <b>Freno</b> 
        della classe <b>Moto</b>. Altres&igrave; in caso di pi&ugrave; progetti 
        componenti potrebbe essere fondamentale nascondere certe informazioni 
        agli utilizzatori del componente oppure modificare il funzionamento interno 
        di una classe senza tuttavia influenzare i progetti utilizzatori dei suoi 
        dati.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Le classi, soprattutto, devono essere pensate come delle <b>scatole nere</b> 
        il cui contenuto &egrave; sconosciuto. Quello che il programmatore deve 
        conoscere &egrave; la loro utilit&agrave; ed ignorare, anche volontariamente, 
        le modalit&agrave; con cui tale utilit&agrave; viene eseguita.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" -->Inizieremo l'implementazione del nostro 
      progetto nella prossima lezione.<!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        3 Febbraio 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar2.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><!-- #BeginEditable "LEZIONEPREC" --><a href="int_02.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna alla seconda lezione</a><!-- #EndEditable --></td>
    <td align="right"><!-- #BeginEditable "LEZIONESUCC" --><a href="int_04.htm">Vai 
      alla quarta lezione <img src="../images/vbnext.jpg" width="49" height="32" align="absmiddle" border="0"></a><!-- #EndEditable --></td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
