<html><!-- #BeginTemplate "/Templates/Info.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Informazioni aggiuntive sulle finestre di Windows</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo">Informazioni aggiuntive <!-- #BeginEditable "TITOLO" -->sulle 
    finestre di Windows<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/infos.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"><script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p>Il nome <i>Windows</i> significa letteralmente <i><b>&quot;finestre&quot;</b></i> 
        ed il pensiero ricade subito su quelle aree che contengono i controlli 
        e formano l'interfaccia grafica di un programma. Ma uno studio pi&ugrave; 
        approfondito del sistema rivela che le finestre non sono soltanto quelle 
        grandi aree contenitore.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Una banale applicazione in ambiente Windows si compone di una finestra 
        contenitore chiamata <b>Application Window</b> contenente al suo interno 
        una barra del titolo, i <a href="../howto/ht_001.htm">pulsanti di sistema</a>, 
        la barra dei menu e l'area inferiore chiamata <b>Client Area</b> o <b>Client 
        Window</b>. Pertanto un'applicazione non si compone di una sola finestra 
        ma di tante finestre, contenute all'interno di una grande <i>Application 
        Window</i>. All'interno della <i>Client Area</i> sono contenute tante 
        finestrelle che consistono in caselle di testo, pulsanti di comando, pulsanti 
        di opzione, cornici, definite generalmente come <i>controlli</i>.</p>
      <p>Pertanto quando si parla generalmente di finestre si indicano le Application 
        Window o le finestre di dialogo, ma quando si fa riferimento a funzioni 
        <a href="../glossary/a.htm#API">API</a>, il concetto di finestra si allarga: 
        in linea generale indica qualsiasi area, identificata da un <a href="../glossary/h.htm#HANDLE">handle</a> 
        unico, in grado di ricevere i <a href="../glossary/m.htm#MESSAGGIO">messaggi</a> 
        del sistema e gestirli tramite una <a href="../glossary/w.htm#WINDOWPROCEDURE">Window 
        Procedure</a>.</p>
      <hr>
      <p>Le finestre sono organizzate gerarchicamente. All'avvio di Windows viene 
        creata la prima finestra, il <b>Desktop</b>, la finestra <a href="../glossary/p.htm#PARENT">Parent</a> 
        (genitore) di tutte le finestre; tutte le altre finestre saranno <a href="../glossary/c.htm#CHILD">Child</a> 
        (figlie) della loro finestra contenitore.</p>
      <p>Pertanto il Desktop &egrave; la prima finestra Parent e tutte le altre 
        sono sue Child, comprese la barra delle applicazioni e la TrayBar. A loro 
        volta, tutte le <i>Application Window</i> sono finestre Parent dei controlli 
        in esse contenuti.</p>
      <p>Tutte le finestre sono generalmente costituite da:</p>
      <ul>
        <li>Un handle unico detto <i>hWnd</i> (Handle Window) che identifica univocamente 
          ciascuna finestra</li>
        <li>Una finestra Parent nella quale la finestra &egrave; contenuta</li>
        <li>Un classname che identifica la tipologia di finestra</li>
        <li>Un testo Caption che aggiunge una descrizione alla finestra</li>
        <li>Una serie di attributi e stili che ne definisce forma, posizione e 
          caratteristiche </li>
        <li>Una Window Procedure che gestisce i messaggi inviati alla finestra</li>
      </ul>
      <p>In linea generale i <a href="../glossary/p.htm#PROCESSO">processi</a> 
        generano <a href="../glossary/t.htm#THREAD">threads</a> che a loro volta 
        generano finestre organizzate gerarchicamente. Utilizzando <i>Microsoft 
        Spy++</i>, fornito con Visual Basic, &egrave; possibile avere una chiara 
        idea dell'organizzazione gerarchica e della struttura di ogni finestra. 
        Vedi anche le <a href="info_14.htm">Informazioni aggiuntive su Processi 
        e Threads</a>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/info/info17_01.png" width="181" height="144" align="right" alt="Figura 1">Prendiamo 
        come esempio una semplice applicazione come quella mostrata qui a fianco: 
        un form contenente al suo interno una <b>TextBox</b> ed un <b>Frame</b>. 
        Il Frame conterr&agrave; al suo interno un <b>CommandButton</b> ed una 
        <b>PictureBox</b> che a sua volta contiene un <b>CheckBox</b>.</p>
      <p>Analizzandola con il <i>Microsoft Spy++</i> otterremmo il risultato mostrato 
        nella Figura 2. Naturalmente gli handle delle finestre, dei processi e 
        dei threads sono rigorosamente casuali e variano da un'esecuzione all'altra.</p>
      <p>Nel nostro esempio l'esecuzione dell'applicazione Progetto1.EXE composto 
        da un solo form con i predetti controlli, genera la creazione di due finestre 
        principali: <b>00000EDC</b> di classe <i>ThunderRT5Form</i> e <b>00000ED8</b> 
        di classe <i>ThunderRT5Main</i>. La seconda finestra sar&agrave; creata 
        automaticamente dal <a href="../glossary/c.htm#COMPILAZIONE">compilatore</a> 
        ma non verr&agrave; mai mostrata. La seconda finestra rappresenta il form 
        con i controlli posizionati.</p>
      <p align="center"><img src="../images/info/info17_02.png" width="428" height="144" alt="Figura 2"><br>
        <b>Figura 2</b></p>
      <p>La finestra si presenta di classe ThunderRT5Form e contiene al suo interno 
        altre finestre, rappresentate logicamente e graficamente in forma di gerarchia, 
        come nella Figura 2.</p>
      <p>Il Form (<b>00000EDC</b>) contiene al suo interno un Frame (<b>00000EE8</b>) 
        ed una TextBox (<b>00000E4C</b>); il Frame contiene invece il CommandButton 
        (<b>00000EEC</b>) e la PictureBox (<b>00000EF0</b>), la quale contiene 
        a sua volta un CheckBox (<b>00000EC8</b>).</p>
      <p>Prendiamo ad esempio l'ultima finestra, che presenta le seguenti caratteristiche:</p>
      <ul>
        <li><i>hWnd</i> = 0x00000EC8</li>
        <li><i>Parent</i> = 0x00000EF0, che identifica il controllo Contenitore 
          PictureBox</li>
        <li><i>ClassName</i> = ThunderRT5CheckBox</li>
        <li><i>Caption</i> = &quot;Check1&quot;</li>
        <li><i>Attributi di posizione e grandezza</i> = (21, 120)-(78, 133), 57x13</li>
        <li><i>Stili</i> = WS_CHILD, WS_VISIBLE, etc...</li>
        <li><i>Window Procedure</i> = Indirizzo 0x0F01D3F3</li>
        <li><i>Thread ID</i> = Indirizzo 0xFFFA268D</li>
        <li><i>Process ID</i> = Indirizzo 0xFFFA8745</li>
      </ul>
      <p>Tutti questi dati sono comuni a tutte le finestre eccetto il Desktop 
        che non possiede una finestra Parent, essendo il genitore di tutte le 
        finestre. Naturalmente alcuni valori dei campi differiscono da finestra 
        a finestra e da un'esecuzione all'altra, poich&eacute; &egrave; il sistema 
        operativo ad assegnare gli handle alla finestra Child ed a quella Parent, 
        nonch&eacute; gli indirizzi del Thread e del Processo.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/notes2.gif" width="31" height="32" align="left">Da 
        questo semplice esperimento di analisi &egrave; facile comprendere perch&eacute; 
        abbiamo chiamato chiamato <a href="../glossary/t.htm#THUNDER">Thunder</a> 
        la sezione dedicata ai controlli intrinseci di Visual Basic. Nello specifico 
        le loro classi prendono il suffisso <i>ThunderRT5</i> relativamente alla 
        versione 5 di VB.</p>
      <hr>
      <p>Esistono decine di migliaia di messaggi gi&agrave; definiti a livello 
        di sistema, alcuni generali, altri specifici per un tipo particolare di 
        finestra, ad esempio i messaggi <i><b>LB_</b></i> riguardano esclusivamente 
        i controlli ListBox, ovvero le finestre di classe <i>ThunderRT5ListBox</i>. 
        Ciascuna Window Procedure &egrave; e deve essere progettata per elaborare 
        soltanto i messaggi interessati e lasciare al sistema operativo la gestione 
        di tutti gli altri messaggi, per eseguire ad esempio l'aggiornamento del 
        video o lo spostamento del cursore.</p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" -->Il <i>Microsoft Spy++</i> consente di 
      eseguire tantissime verifiche del genere ed &egrave; in grado di svelare 
      con semplicit&agrave; molte delle difficolt&agrave; celate dietro questo 
      intricato labirinto di oggetti.<br>
      <i>Microsoft Spy++</i> si trova nel CD di Visual Basic 5 Professional all'interno 
      della cartella TOOLS\SPY.<!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI </a><br>
        10 Ottobre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar2.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
