<html><!-- #BeginTemplate "/Templates/Weird.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Il Forms Untiding</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Il Forms Untiding<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/weird.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Nei progetti che utilizzano pi&ugrave; form un errore molto comune &egrave; 
        quello di trovare riferimenti al secondo form senza un esplicito caricamento. 
        Questo quindi provoca il caricamento automatico del form a cui si fa riferimento; 
        tuttavia questa maniera di lavorare pu&ograve; portare ad errori involontari 
        che, inaspettatamente, lasciano il form in memoria ma in maniera invisibile. 
      </p>
      <p>Il significato letterale del termine <b>Forms Untiding</b> significa 
        <i>disordinamento dei forms</i> e si applica in genere su quei forms secondari 
        che al momento dell'avvio sono nascosti, ad esempio per inizializzarne 
        i dati dall'esterno.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/weird/weird05_01.png" width="134" height="58" align="right" alt="Figura 1">Sviluppiamo 
        un brevissimo esempio esplicativo composto da due forms: il primo conterr&agrave; 
        un solo pulsante di nome <b>cmdLoadForm2</b> mentre il secondo form non 
        necessita di alcun controllo.</p>
      <p>Il codice del pulsante fa uso esplicito di alcune propriet&agrave; del 
        secondo form, senza tuttavia utilizzare un'istruzione Load che avrebbe 
        piuttosto evidenziato meglio l'errore.</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub cmdLoadForm2_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Form2.Visible = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Form2.Caption = &quot;Form nascosto&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If MsgBox(&quot;Faccio apparire il form?&quot;, 
          vbYesNo) = vbYes Then Form2.Show</li>
        <li>End Sub</li>
      </ol>
      <p>Le righe 4 e 5 modificano due propriet&agrave; del secondo form forzando 
        il caricamento automatico dello stesso. La riga 6 invece pone una domanda 
        all'utente: <i><b>&quot;Faccio apparire il form?&quot;</b></i>. Naturalmente 
        al suo posto avrebbe potuto esserci qualunque istruzione di controllo 
        il cui risultato decidesse se visualizzare o meno il secondo form.</p>
      <p>Se alla domanda l'utente risponde con SI, il secondo form &egrave; mostato 
        sullo schermo tramite <i>Form2.Show</i> e l'elaborazione procede regolarmente. 
        Sar&agrave; quindi compito del secondo form scaricarsi quando non serve 
        pi&ugrave; oppure lasciare all'utente la possibilit&agrave; di chiuderlo 
        tramite il pulsante di chiusura <img src="../images/icons/wndclose.gif" width="16" height="14" align="absmiddle"> 
        sulla barra del titolo.</p>
      <p>Se invece l'utente risponde con un NO, il secondo form non sar&agrave; 
        mostrato e la routine terminer&agrave; normalmente, non avendo altro codice 
        da eseguire. L'utente neanche si accorge del problema in quanto il secondo 
        form &egrave; nascosto (e non &egrave; stato mostrato); tuttavia questo 
        genera una situtazione di <i>Forms Untiding</i>. Uno o pi&ugrave; forms 
        non sono stati scaricati dalla memoria, complice anche l'assenza di un'esplicita 
        istruzione <b>Load</b> che avrebbe ricordato o fatto risaltare l'eventuale 
        necessit&agrave; di un'istruzione <b>Unload</b>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>In una situazione di Forms Untiding se l'utente chiude il form principale, 
        nonch&eacute; l'unico visibile, il processo non termina ma rimane sospeso. 
        Se il progetto &egrave; eseguito all'interno dell'<a href="../glossary/i.htm#IDE">IDE</a> 
        di VB ci si accorge del problema per il fatto che l'esecuzione non ritorna 
        alla fase di progettazione; il codice del progetto &egrave; visibile ma 
        non modificabile e l'esecuzione risulta ancora in atto.</p>
      <p>Se invece il progetto fosse stato compilato ed avviato dal file eseguibile 
        risulta impossibile accorgersi della situazione sospesa. Nascosto ogni 
        form il progetto sembra non esistere e non presenta alcuna icona sulla 
        barra delle applicazioni; ci si pu&ograve; accorgere del processo sospeso 
        soltanto premendo ad esempio i tasti <b>CTRL+ALT+CANC</b>.</p>
      <p align="center"><img src="../images/howto/howto028_02.png" width="318" height="226" alt="Figura 2"><br>
        <b>Figura 2</b></p>
      <hr>
      <p>Risolvere una situazione di Forms Untiding &egrave; relativamente semplice. 
        Basta applicare un po' di attenzione durante l'utilizzo di form secondari:</p>
      <ul>
        <li>Evitare il caricamento di un form prima dell'effettiva necessit&agrave;</li>
        <li>Esplicitare le istruzioni Load / Unload</li>
        <li>Verificare i forms caricati in memoria</li>
        <li>Chiudere tutti i forms durante la chiusura del form principale che 
          verr&agrave; chiuso per ultimo</li>
      </ul>
      <p>Lo stesso progetto poteva essere scritto nel seguente modo:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub cmdLoadForm2_Click()</li>
        <li> &nbsp;&nbsp;&nbsp;&nbsp;If MsgBox(&quot;Faccio apparire il form?&quot;, 
          vbYesNo) = vbYes Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load Form2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form2.Visible = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form2.Caption = &quot;Form 
          nascosto&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form2.Show</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Questa operazione applica le prime due regole precedenti: il caricamento 
        del form &egrave; eseguito soltanto quando &egrave; necessario farlo (l'utente 
        ha risposto di voler mostrare il form) ed &egrave; esplicitata l'istruzione 
        Load. Se il form fosse stato visualizzato in maniera <a href="../glossary/m.htm#MODALE">modale</a> 
        sarebbe stato necessario aggiungere un'istruzione Unload subito dopo la 
        visualizzazione.</p>
      <p>Alla riga 4 viene verificata la condizione che determina se mostrare 
        o meno il secondo form. Soltanto se l'utente decide di voler mostrare 
        il form questo sar&agrave; caricato e mostrato. Non cos&igrave; avviene 
        se l'utente decide di non mostrare il form.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Inoltre la chiusura del form principale deve essere eseguita come segue:</p>
      <ol start="12" class="codicevb">
        <li>Private Sub Form_Unload(Cancel As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim intConta As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Forms.Count &gt; 1 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For intConta = Forms.Count 
          - 1 To 1 Step -1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unload 
          Forms(intConta)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next intConta</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub </li>
      </ol>
      <p>Sar&agrave; verificato il numero di forms caricati e scaricati i forms 
        non necessari.<br>
        Alla chiusura del form principale sar&agrave; verificato il numero di 
        forms caricati in memoria. Se il numero di forms &egrave; superiore ad 
        1, ovvero esiste almeno un altro form oltre il principale, saranno chiusi 
        uno per uno i forms secondari iterando ciascun form dall'ultimo al secondo. 
        Il form principale si chiuder&agrave; da s&eacute; al termine della routine 
        Form_Unload.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Questa &egrave; una possibile soluzione. In certi casi anche questo controllo 
        pu&ograve; fallire, ad esempio quando uno dei forms secondari rifiuta 
        la chiusura nell'<a href="../glossary/e.htm#EVENTO">evento</a> <img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle"> 
        Unload.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        23 Ottobre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice delle Stranezze</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
