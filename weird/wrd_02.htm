<html><!-- #BeginTemplate "/Templates/Weird.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Capienza massima di una Textbox</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Capienza massima di una 
    Textbox<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/weird.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Le caselle di testo di Visual Basic possono contenere qualsiasi stringa 
        di testo ma, negli ambienti Windows 9x esiste un limite massimo di caratteri 
        che possono contenere. Nei sistemi Windows NT questo limite &egrave; dettato 
        da due fattori: memoria libera disponibile e tipologia di utilizzo dei 
        dati.</p>
      <p>Dimostreremo in questo articolo il numero massimo di caratteri che una 
        Textbox &egrave; in grado di contenere. La guida di VB si esprime con 
        queste parole: &quot;L'impostazione di <i>Text</i> per un controllo TextBox 
        pu&ograve; contenere <b>al massimo 2048 caratteri</b>, a meno che la propriet&agrave; 
        <i>MultiLine</i> non sia True. In quest'ultimo caso <b>il limite massimo 
        &egrave; di circa 32K</b>&quot;. Tuttavia la realt&agrave; non &egrave; 
        proprio cos&igrave; semplice.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/weird/weird02_01.png" width="200" height="210" align="right" alt="Figura 1">Utilizzeremo 
        un progetto molto semplice per dimostrare la capienza massima di due Textbox, 
        una a riga singola ed una multiriga.</p>
      <p>In fondo al form ci sono 6 pulsanti divisi in due colonne da tre pulsanti 
        ciascuna. La prima delle due colonne di pulsanti restituisce la dimensione 
        massima della prima casella di testo, quella a riga singola; la seconda 
        colonna di pulsanti effettua gli stessi test sulla casella multiriga.</p>
      <p>I tre test eseguono tre rilevazioni molto semplici:</p>
      <ol>
        <li>Il primo test effettua un ciclo che concatena alla propriet&agrave; 
          <b><i>Text</i></b> ad ogni passaggio una stringa di 1024 caratteri. 
          &Egrave; utilizzata anche un'istruzione di gestione di errori per proseguire 
          l'elaborazione nel caso che la casella di testo superi la capienza massima. 
          Nel momento in cui verr&agrave; generato un errore dovuto al superamento 
          della capienza massima, verr&agrave; rifatto il controllo ma un blocco 
          di dati pi&ugrave; piccolo, in modo da determinare con precisione la 
          capacit&agrave; massima del controllo.<br>
          <br>
        </li>
        <li>Il secondo test esegue le medesime operazioni del test precedente 
          ma anzich&eacute; operare sulla propriet&agrave; <i><b>Text</b></i>, 
          utilizza la propriet&agrave; <i> <b>SelText</b></i>. Questo test &egrave; 
          stato affrontato esclusivamente con una seconda finalit&agrave; che 
          vedremo in seguito, ma per la nostra elaborazione i risultati saranno 
          esattamente identici.<br>
          <br>
        </li>
        <li>L'ultimo test effettua la ricerca della capienza massima per tentativi. 
          Verr&agrave; inizialmente provata una stringa di 36000 caratteri, che 
          quasi sicuramente produrr&agrave; un errore, e verr&agrave; ripetuto 
          il test, con una stringa pi&ugrave; corta fino a quando la casella di 
          testo smetter&agrave; di produrre errori.</li>
      </ol>
      <p>Delle tre soluzioni, la terza si presenta come la pi&ugrave; lenta, seguita 
        dal test che utilizza la propriet&agrave; <i><b>Text</b></i> della casella 
        di testo; il secondo test &egrave; invece il pi&ugrave; veloce. Altres&igrave; 
        i test sulla seconda casella di testo saranno pi&ugrave; lenti di quelli 
        sulla casella a riga singola.</p>
      <hr>
      <p>Lanciamo il nostro programma dimostrativo ed effettuiamo uno per uno 
        tutti i test possibili. </p>
      <p><img src="../images/weird/weird02_02.png" width="131" height="80" align="left" alt="Figura 2">Noteremo 
        che nei sistemi Windows 9x i test relativi alla Casella 1 restituiranno 
        tutti il medesimo risultato: lunghezza della casella txtTesto1: 32766 
        caratteri.</p>
      <p>Questo dimostra che la prima realt&agrave; va in contrasto con la spiegazione 
        fornita dalla guida in linea di VB vista all'inizio di questo articolo.<br>
        Indipendentemente dal numero di volte e dal computer utilizzato per eseguire 
        questi test, <b>l'ampiezza massima</b> di una casella di testo a riga 
        singola <b>&egrave; 32766 caratteri</b>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Nei sistemi Windows NT invece, i test restituiscono dei valori differenti: 
        <b>l'uso della propriet&agrave; Text</b> (il primo ed il terzo test, mostrati 
        nella Figura 3) <b>&egrave; limitato a 65535 caratteri</b>, mentre <b>l'uso 
        della propriet&agrave; SelText</b> (mostrato nella Figura 4) <b>non presenta 
        alcuna limitazione</b>, se non la memoria disponibile. Per il secondo 
        test verr&agrave; infatti restituito il risultato 308224, corrispondente 
        a 301 * 1024, ma avrebbe potuto contenere ulteriori caratteri. Abbiamo 
        interrotto volontariamente l'elaborazione dopo 301 esecuzioni del ciclo, 
        che avrebbe potuto continuare ancora per molto tempo.</p>
      <table width="90%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td align="center" valign="top"><img src="../images/weird/weird02_03.png" width="134" height="80" alt="Figura 3"><br>
            <b>Figura 3</b></td>
          <td align="center" valign="top"><img src="../images/weird/weird02_04.png" width="138" height="80" alt="Figura 4"><br>
            <b>Figura 4</b></td>
        </tr>
      </table>
      <hr>
      <p><img src="../images/weird/weird02_05.png" width="131" height="80" align="right" alt="Figura 5">Le 
        casella di testo multiriga si presentano indiscutibilmente pi&ugrave; 
        lente di quelle a riga singola.</p>
      <p>Nei sistemi Windows 9x qualunque sia il test che eseguiamo il risultato 
        dovrebbe essere sempre lo stesso: <b>il numero massimo di caratteri</b> 
        per una casella di testo multiriga <b>&egrave; un numero in genere compreso 
        tra 32000 e 35000</b>. Nel nostro esempio a fianco la dimensione massima 
        &egrave; risultata essere 33825 caratteri ma l'esecuzione dello stesso 
        test con condizioni di elaborazione differenti, ad esempio con pi&ugrave; 
        o meno programmi aperti potrebbe produrre risultati differenti.</p>
      <p>Nei sistemi Windows NT l'operazione riflette i test della casella a riga 
        singola: il primo ed il terzo test <b>restituiscono</b> entrambi <b>il 
        valore 65535 caratteri</b> (vedi Figura 6); il secondo test, che utilizza 
        la propriet&agrave; <i>SelText</i>, <b>procede in maniera interminabile</b>. 
        Nella Figura 7 il valore 233472 &egrave; simbolico e rappresenta la lunghezza 
        della stringa elaborata fino all'interruzione del progetto, che avrebbe 
        portato via molto tempo, senza produrre alcun risultato utile.</p>
      <table width="90%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td align="center" valign="top"><img src="../images/weird/weird02_06.png" width="134" height="80" alt="Figura 6"><br>
            <b>Figura 6</b></td>
          <td align="center" valign="top"><img src="../images/weird/weird02_07.png" width="138" height="80" alt="Figura 7"><br>
            <b>Figura 7</b></td>
        </tr>
      </table>
      <hr>
      <p>Riepiloghiamo quindi i risultati, differenziandoli per sistema operativo 
        utilizzato:</p>
      <table width="80%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <th align="center" valign="middle" height="25">Test effettuato</th>
          <th align="center" valign="middle" height="25">Windows 9x</th>
          <th align="center" valign="middle" height="25">Windows NT</th>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto1 con .Text</td>
          <td align="center" valign="middle" height="25">32766</td>
          <td align="center" valign="middle" height="25">65535</td>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto1 con .SelText</td>
          <td align="center" valign="middle" height="25">32766</td>
          <td align="center" valign="middle" height="25">Infinito (*)</td>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto1 a tentativi</td>
          <td align="center" valign="middle" height="25">32766</td>
          <td align="center" valign="middle" height="25">65535</td>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto2 con .Text</td>
          <td align="center" valign="middle" height="25">32000-35000</td>
          <td align="center" valign="middle" height="25">65535</td>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto2 con .SelText</td>
          <td align="center" valign="middle" height="25">32000-35000</td>
          <td align="center" valign="middle" height="25">Inifinito (*)</td>
        </tr>
        <tr> 
          <td align="center" valign="middle" height="25">txtTesto2 a tentativi</td>
          <td align="center" valign="middle" height="25">32000-35000</td>
          <td align="center" valign="middle" height="25">65535</td>
        </tr>
      </table>
      <p> <img src="../images/notes2.gif" width="31" height="32" align="left">(*) 
        Infinito indica che non esiste un limite fisso ma la capacit&agrave; &egrave; 
        dettata dalla memoria disponibile nel sistema.</p>
      <hr>
      <p>Si raccomanda l'esecuzione di questi test su pc differenti oppure con 
        condizioni differenti, ad esempio all'avvio del sistema operativo potremmo 
        avere un numero maggiore di quello fornito dopo ore di lavoro con il pc.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><b class="colorerosso">Attenzione</b>: se il programma dovesse smettere 
        di rispondere e state utilizzando un sistema Windows 9x, si raccomanda 
        di attendere il termine dell'elaborazione. Infatti sui computer pi&ugrave; 
        lenti l'elaborazione dei test sulla casella multiriga potrebbe richiedere 
        qualche minuto.</p>
      <p></p>
      <p>Dall'esecuzione di questi test &egrave; palese la differenza di capacit&agrave; 
        tra le caselle di testo a riga singola e quelle multiriga. Viene altres&igrave; 
        dimostrato che le caselle di testo multiriga sono molto pi&ugrave; lente 
        di quelle a riga singola.</p>
      <p>Nell'esecuzione dei tre test &egrave; per&ograve; dimostrato anche che 
        l'utilizzo della propriet&agrave; <i><b>SelText</b></i>, come alternativa 
        alla propriet&agrave; <i><b>Text</b></i>, produce risultati di gran lunga 
        migliori in termini di velocit&agrave;. Si raccomanda pertanto, quando 
        possibile, la scrittura di dati tramite questa propriet&agrave;, anzich&eacute; 
        usando Text, predefinita per il controllo. L'unico accorgimento da tenere 
        consiste nel verificare la posizione in cui si trova il cursore e, se 
        necessario, azzerare il contenuto della casella di testo prima di concatenare 
        del nuovo testo.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>&Egrave; anche possibile migliorare la velocit&agrave; di chiusura del 
        nostro programma azzerando le caselle di testo contenenti molti dati, 
        prima di procedere con l'effettivo scaricamento del form, ad esempio sfruttando 
        l'<a href="../glossary/e.htm#EVENTO">evento</a>&nbsp;<img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle">&nbsp;Unload.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        11 Settembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice delle Stranezze</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
