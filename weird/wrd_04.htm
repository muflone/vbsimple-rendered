<html><!-- #BeginTemplate "/Templates/Weird.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Propriet&agrave; Enabled dei controlli ScrollBar</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Propriet&agrave; Enabled 
    dei controlli ScrollBar<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/weird.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Quasi tutti i controlli <a href="../glossary/t.htm#THUNDER">Thunder</a> 
        possiedono una <a href="../glossary/p.htm#PROPRIETA">propriet&agrave;</a> 
        <img src="../images/ide/propr.gif" width="16" height="16" align="absmiddle"> 
        <b>Enabled</b> che determina se il controllo &egrave; in grado di ricevere 
        informazioni dall'utente. Quando il suo valore &egrave; impostato su False 
        tutte le azioni dell'utente sono ignorate ed il controllo non riceve alcuna 
        notifica degli eventi.</p>
      <p>Questo tuttavia non avviene quando gli eventi<img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle">sono 
        generati - direttamente o indirettamente - dal codice del progetto. Ad 
        esempio se il codice va a modificare il contenuto di una casella di testo 
        la cui propriet&agrave; Enabled &egrave; impostata su False, sar&agrave; 
        comunque generato l'evento <i>Change</i> della casella stessa.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>In alcune situazioni &egrave; necessario far modificare al codice il 
        valore di certi controlli, ad esempio svuotare le caselle di testo senza 
        tuttavia per questo eseguire il codice associato all'evento Change che 
        potrebbe avere effetti collaterali. Una soluzione al problema potrebbe 
        essere quella di testare il valore della propriet&agrave; <i>Enabled</i> 
        all'interno di quelle procedure critiche e <b>non eseguire</b> le azioni 
        associate all'evento se il valore della propriet&agrave; &egrave; <i><b>False</b></i>.</p>
      <p>Mentre questa soluzione &egrave; ragionevolmente funzionale per i controlli 
        pi&ugrave; comuni, cos&igrave; non &egrave; per i controlli di scorrimento 
        <b>HScrollBar</b>&nbsp;<img src="../images/controls/hscrollbar.gif" width="25" height="25" align="absmiddle"> 
        e <b>VScrollBar</b><img src="../images/controls/vscrollbar.gif" width="25" height="25" align="absmiddle">poich&eacute; 
        essi si comportano in una maniera del tutto differente e fuorviante dalla 
        normale logica.</p>
      <p>In un progetto reale questo comportamento anomalo mi ha fatto perdere 
        almeno un'ora di <a href="../glossary/d.htm#DEBUG">debug</a> su un codice 
        apparentemente perfetto. Per riprodurre la situazione sar&agrave; sviluppato 
        un progetto davvero molto semplice che conterr&agrave; tutti i controlli 
        Thunder visibili e che possiedono la propriet&agrave; Enabled.</p>
      <p><img src="../images/weird/weird04_01.png" width="240" height="145" align="right" alt="Figura 1">Escludendo 
        il pulsante in basso, tutti i controlli sono piazzati a casaccio mantenendo 
        i loro nomi e valori originali (Text1, Combo1 ...) ed impostando la loro 
        propriet&agrave; Enabled a False. Giusto per semplificare, il controllo 
        ListBox sar&agrave; riempito a <a href="../glossary/r.htm#RUNTIME">runtime</a> 
        con i numeri da 1 a 10.</p>
      <p>Il pulsante in basso con il testo <i><b>&quot;Avvia dimostrazione&quot;</b></i> 
        prender&agrave; il nome <b>cmdAvvia</b> ed a differenza di tutti gli altri 
        controlli, questo non sar&agrave; disabilitato.</p>
      <p>&Egrave; necessario quindi aggiungere una semplice riga di codice per 
        ogni controllo da verificare. Il codice legger&agrave; semplicemente il 
        valore della propriet&agrave; <i><b>Enabled</b></i> e ne mostrer&agrave; 
        il valore con una finestra di messaggio. Questa singola riga di codice 
        andr&agrave; inserita nell'evento <i>Change</i> se esiste oppure nell'evento 
        <i>Click</i>, in mancanza dell'altro evento.</p>
      <p>Il codice sar&agrave; come il seguente:</p>
      <ol start="1" class="codicevb">
        <li>Private Sub Combo1_Change()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Combo1.Enabled = &quot; &amp; 
          Combo1.Enabled</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Naturalmente ogni controllo avr&agrave; il nome del suo controllo. Cos&igrave; 
        Command1_Click apparir&agrave; come:</p>
      <ol start="5" class="codicevb">
        <li>Private Sub Command1_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Command1.Enabled = &quot; &amp; 
          Command1.Enabled</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Potr&agrave; sembrare noiosa come operazione ma &egrave; necessaria per 
        distinguere i singoli controlli durante la dimostrazione. Alternativamente 
        si potrebbe costruire una semplice routine che ricevendo un argomento 
        di tipo Control, mostri la finestra di avviso leggendo il nome del controllo 
        ed il valore della propriet&agrave; Enabled.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Passiamo al codice vero e proprio, quello del pulsante <b>cmdAvvia</b>:</p>
      <ol start="42" class="codicevb">
        <li>Private Sub cmdAvvia_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Command1.Value = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;HScroll1.Value = Rnd * HScroll1.Max</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Text1.Text = String$(10, Rnd * 25 + 65)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Check1.Value = Abs(Check1.Value - 1)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Option1.Value = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Option1.Value = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Combo1.Text = Text1.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;List1.ListIndex = Rnd * List1.ListCount</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;File1.ListIndex = Rnd * File1.ListCount</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;VScroll1.Value = Rnd * VScroll1.Max</li>
        <li>End Sub</li>
      </ol>
      <p>Fondamentalmente molto banale, richiama uno per uno gli eventi <i>Change</i> 
        o <i>Click</i> dei controlli inseriti nel form. La riga 43 ad esempio 
        attiva l'evento <i>Click</i> del pulsante <b>Command1</b> (in una maniera 
        vista in <a href="../howto/ht_006.htm">un HowTo</a>), il quale lancer&agrave; 
        la routine Command1_Click(), mostrando quindi il valore della propriet&agrave; 
        Enabled all'interno della routine.</p>
      <p>La riga 44 invece sceglier&agrave; un valore casuale nell'intervallo 
        compreso tra 0 ed il valore massimo della barra di scorrimento <b>HScroll1</b>. 
        In maniera analoga anche la riga 52 per il controllo <b>VScroll1</b>.<br>
        Tutte le righe sono atte a modificare il valore corrente di ogni controllo.</p>
      <p><img src="../images/weird/weird04_02.png" width="129" height="80" align="right" alt="Figura 2">L'esecuzione 
        del progetto mostrer&agrave; innanzitutto il valore della propriet&agrave; 
        Enabled del controllo Command1 all'interno della routine Command1_Click. 
        Altrettanto faranno le altre routine, ciascuna per il suo controllo.</p>
      <p>Il comportamento anomalo si verificher&agrave; <b class="sottolineato">soltanto</b> 
        per i controlli <b>HScrollBar</b> e <b>VScrollBar</b>. Sebbene essi siano 
        disattivati, il test nella routine HScroll1_Change e VScroll1_Change mostrer&agrave; 
        il valore <i><b>True</b></i> della propriet&agrave; Enabled (vedi Figura 
        3 in basso).</p>
      <p align="center"><img src="../images/weird/weird04_03.png" width="256" height="145" alt="Figura 3"><br>
        <b>Figura 3</b></p>
      <p>Un'analisi pi&ugrave; approfondita mostrer&agrave; che in realt&agrave; 
        la barra di scorrimento viene attivata solo un attimo, nel momento in 
        cui scatta l'evento Change e si disattiva automaticamente all'uscita dell'evento.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Possiamo notare infatti la differenza di colorazione tra la barra disattivata 
        inizialmente (Figura 4) e la barra attivata durante l'esecuzione dell'evento 
        Change (Figura 5). Possiano anche notare nella Figura 5 la barretta che 
        indica il valore corrente della barra di scorrimento.</p>
      <table width="50%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td align="center" valign="top" width="50%"><img src="../images/weird/weird04_04.gif" width="25" height="109" alt="Figura 4"><br>
            <b>Figura 4</b></td>
          <td align="center" valign="top" width="50%"><img src="../images/weird/weird04_05.gif" width="25" height="109" alt="Figura 5"><br>
            <b>Figura 5</b></td>
        </tr>
      </table>
      <br>
      <br>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Questo strano comportamento rende inutile la verifica del valore della 
        propriet&agrave; Enabled all'interno degli eventi Change delle barre di 
        scorrimento. Se si rende necessario inibire temporaneamente l'azione dell'evento 
        Change sar&agrave; quindi necessario trovare una soluzione alternativa, 
        utilizzando variabili Statiche o esterne all'evento.</p>
      <p>Per tutti gli altri controlli Thunder, la propriet&agrave; Enabled si 
        comporta nella maniera corretta ed il controllo non si attiva e disattiva 
        automaticamente.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        29 Settembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice delle Stranezze</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
