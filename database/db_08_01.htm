<html><!-- #BeginTemplate "/Templates/Database2.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Il linguaggio SQL (l'istruzione SELECT)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Il linguaggio SQL<br>
    L'istruzione SELECT <!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/database.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Sicuramente la prima e la pi&ugrave; utilizzata tra le istruzioni di 
        questo linguaggio. Serve letteralmente a selezionare un gruppo di valori 
        da un insieme di tabelle, specificando opzionalmente dei criteri di selezione, 
        di raggruppamento e di ordinamento. La sintassi generale dell'istruzione 
        &egrave;:</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p class="codicevb2">SELECT &lt;campi&gt;<br>
        [ <a href="db_08_04.htm#SELECTINTO">INTO</a> &lt;tabella&gt; ]<br>
        FROM &lt;origini&gt;<br>
        [ <a href="db_08_09.htm">JOIN</a> &lt;origine&gt; ON &lt;criteri&gt; ]<br>
        [ <a href="db_08_02.htm">WHERE</a> &lt;criteri&gt; ]<br>
        [ <a href="db_08_08.htm">GROUP BY</a> &lt;campi&gt; ]<br>
        [ <a href="db_08_08.htm#HAVING">HAVING</a> &lt;criteri&gt; ]<br>
        [ <a href="db_08_03.htm">ORDER BY</a> &lt;criteri di ordinamento&gt; ]</p>
      <p>Delle 5 righe indicate soltanto la prima &egrave; obbligatoria; le successive 
        rappresentano ulteriori clausole oppure operatori SQL che vedremo in seguito. 
        Nella sua forma pi&ugrave; semplice si compone del nome dei campi da scegliere 
        e dal nome di una tabella come origine:</p>
      <p class="codicevb2">SELECT id, nome, cognome FROM dipendenti</p>
      <p>L'esempio estrae i campi ID, NOME e COGNOME dalla tabella di nome <i>dipendenti</i>; 
        nessun filtro sar&agrave; operato ma saranno quindi restituite tutte le 
        righe presenti all'interno della tabella indicata. Se dovesse essere necessario 
        estrarre <b>tutti i campi</b> dall'origine indicata pu&ograve; essere 
        utilizzato il <b>simbolo *</b> come segue:</p>
      <p class="codicevb2">SELECT * FROM dipendenti</p>
      <p>Si tratta di una pratica generalmente da evitare se non &egrave; davvero 
        necessario. In tal modo infatti l'intero contenuto della tabella sar&agrave; 
        recuperato e trasferito lungo la rete al richiedente. Generalmente baster&agrave; 
        selezionare solo i campi interessati.</p>
      <p>I dati saranno restituiti in forma tabellare (quindi a righe e colonne) 
        ed i nomi dei campi saranno quelli originali recuperati dalla tabella 
        di origine. In caso di necessit&agrave; sar&agrave; possibile modificare 
        il nome dei singoli campi restituiti utilizzando l'operatore <b>AS</b>:</p>
      <p class="codicevb2">SELECT id AS id_cliente, nome AS nome_cliente, cognome 
        AS cognome_cliente FROM clienti</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La riga precedente estrae i tre campi ID, NOME e COGNOME e li assegna 
        ai campi di nome <i>ID_CLIENTE</i>, <i>NOME_CLIENTE</i> e <i>COGNOME_CLIENTE</i>. 
        Sebbene sia possibile inserire degli spazi nei nomi dei campi si consiglia 
        di evitarlo sia per diminuire la probabilit&agrave; di errori sia perch&eacute; 
        non tutti i database lo consentono. Esistono due sintassi molto comuni 
        per racchiudere i nomi dei campi quando questi contengono degli spazi 
        o altri simboli che potrebbero arrecare disturbo all'elaborazione. I due 
        simboli sono le parentesi quadre <b>[ ]</b> ed il carattere di accento 
        <b>`</b> (non si tratta dell'apostrofo della tastiera italiana) riproducibile 
        con la sequenza di tasti <b>ALT+096</b> oppure con l'apposito tasto sotto 
        ESC nella tastiera americana. Alcuni database preferiscono le parentesi 
        quadre mentre altri l'accento, pertanto si rimanda alla documentazione 
        del singolo database.</p>
      <p class="codicevb2">SELECT id AS [id cliente], nome AS [nome cliente], 
        cognome AS [cognome cliente] FROM clienti</p>
      <p>oppure</p>
      <p class="codicevb2">SELECT id AS `id cliente`, nome AS `nome cliente`, 
        cognome AS `cognome cliente` FROM clienti</p>
      <p></p>
      <p>Alla stessa maniera naturalmente vanno racchiusi i nomi dei campi di 
        origine, cio&egrave; quelli che si trovano alla sinistra di AS, quando 
        questo si renda necessario per la presenza di spazi o altri simboli particolari. 
        Solitamente i programmi che generano istruzioni SQL racchiudono tutti 
        i nomi dei campi tra i precedenti simboli anche quando non &egrave; strettamente 
        necessario.</p>
      <p>Quando un campo pu&ograve; riferirsi a pi&ugrave; di una tabella dell'origine 
        (vedremo subito dopo come specificare pi&ugrave; di un'origine), &egrave; 
        necessario fornire il nome dell'origine cui il campo si riferisce, ma 
        &egrave; comunque possibile farlo anche quando si tratta di una sola origine:</p>
      <p class="codicevb2">SELECT dipendenti.id, dipendenti.nome, dipendenti.cognome 
        FROM dipendenti</p>
      <p>&Egrave; anche possibile rinominare il nome delle singole origini, semplicemente 
        specificando il nuovo nome immediatamente dopo il nome originale:</p>
      <p class="codicevb2">SELECT dip.id, dip.nome, dip.cognome FROM dipendenti 
        dip</p>
      <p>Tutte le espressioni che abbiamo visto finora riportavano i campi di 
        tutti i record di una sola tabella nell'<b>ordine casuale</b> con cui 
        le righe vengono estratte. Utilizzando la <a href="db_08_02.htm">clausola 
        WHERE</a> che vedremo in seguito &egrave; possibile filtrare la scelta 
        dei record da estrarre. La clausola <a href="db_08_03.htm">ORDER BY</a> 
        invece consente di ordinare i risultati. Tralasciamo per il momento le 
        forme pi&ugrave; avanzate di uso dell'istruzione SELECT per concentrarci 
        sui fondamenti.</p>
      <hr class="hrseparator">
      <p>Specificando come origine pi&ugrave; di un nome di tabella si ottiene 
        una permutazione di righe per ciascuna tabella, ad esempio date due tabelle 
        di nome dipendenti e dettaglio, con un campo ciascuna di nome ID e quattro 
        righe in entrambe le tabelle, la selezione:</p>
      <p class="codicevb2">SELECT dipendenti.id AS id1, saldi.id AS id2 FROM dipendenti, 
        saldi</p>
      <p>Saranno restituite 16 righe (4*4):</p>
      <table width="30%" border="0">
        <tr> 
          <td rowspan="2" width="20%">&nbsp;</td>
          <th width="40%">id1</th>
          <th width="40%">id2</th>
        </tr>
        <tr> 
          <td width="40%" align="center" valign="top">1<br>
            1<br>
            1<br>
            1<br>
            2<br>
            2<br>
            2<br>
            2<br>
            3<br>
            3<br>
            3<br>
            3<br>
            4<br>
            4<br>
            4<br>
            4</td>
          <td width="40%" align="center" valign="top">1<br>
            2<br>
            3<br>
            4<br>
            1<br>
            2<br>
            3<br>
            4<br>
            1<br>
            2<br>
            3<br>
            4<br>
            1<br>
            2<br>
            3<br>
            4</td>
        </tr>
      </table>
      <p>Naturalmente se le tabelle fossero state 3, le righe restituite saranno 
        64 (4*4*4). Questa scelta potr&agrave; sembrare una sciocchezza ma in 
        realt&agrave; si tratta di un'ampia possibilit&agrave;: sono infatti presentate 
        tutte le possibili combinazioni con i due gruppi di 4 numeri; sar&agrave; 
        sempre possibile scegliere solo quelli che necessitano. Questa operazione 
        &egrave; alla base dell'operatore <a href="db_08_09.htm">JOIN</a> che 
        unisce pi&ugrave; origini con un certo criterio di scelta, ma pu&ograve; 
        essere risolta anche con l'uso della <a href="db_08_02.htm">clausola WHERE</a>.</p>
      <hr class="hrseparator">
      <p><a name="DISTINCT"></a>Abbiamo lasciato per ultimo un operatore particolare 
        utilizzabile nelle istruzioni di selezione: si tratta di <b>DISTINCT</b>, 
        dedicato a filtrare le righe ripetute. La sua sintassi &egrave; molto 
        semplice:</p>
      <p class="codicevb2">SELECT DISTINCT &lt;campi&gt; FROM &lt;origini&gt;</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Essendo posto prima dei campi, la sua azione &egrave; valida su tutti 
        i campi; saranno infatti eliminate le righe dei risultati completamente 
        uguali tra loro. Vediamo un esempio per semplificare la comprensione del 
        problema:</p>
      <p class="codicevb2">SELECT DISTINCT nome FROM dipendenti</p>
      <p>Restituir&agrave; tutti i nominativi unici dei dipendenti; saranno ovvero 
        esclusi i nomi duplicati. Dipendenti con nome uguale e cognome differente 
        saranno comunque annoverati nell'unica riga con il loro nome.</p>
      <p class="codicevb2">SELECT DISTINCT nome, cognome FROM dipendenti</p>
      <p>Tuttavia in questo caso, se due dipendenti avessero lo stesso nome, sarebbero 
        comunque riportati entrambi perch&eacute; l'esclusione dei duplicati agisce 
        soltanto <b>sulle righe intere dei risultati</b> e non sui dati da recuperare 
        dall'origine. Sarebbero allora esclusi soltanto quei dipendenti con lo 
        stesso nome e lo stesso cognome, caso assai difficile in una singola azienda.</p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --><!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        14 Marzo 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar2.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice della sezione Database</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
