<html><!-- #BeginTemplate "/Templates/Database2.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Il linguaggio SQL (l'istruzione INSERT INTO)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Il linguaggio SQL<br>
    L'istruzione INSERT INTO<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/database.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>La prima istruzione utilizzata dalle query di inserimento &egrave; INSERT 
        INTO, che presuppone che la tabella di destinazione esista e presenta 
        due sintassi differenti:</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p class="codicevb2">INSERT INTO &lt;tabella&gt; [ (campi) ] &lt;istruzione 
        SELECT&gt;<br>
        INSERT INTO &lt;tabella&gt; [ (campi) ] VALUES( &lt;valori&gt; )</p>
      <p>Ciascuno dei due casi pu&ograve; essere indicato con due possibilit&agrave;. 
        Vediamole tutte e quattro:</p>
      <p class="codicevb2">INSERT INTO &lt;tabella&gt; &lt;istruzione SELECT&gt;</p>
      <p>Inserisce all'interno della tabella indicata i valori recuperati dall'<a href="db_08_01.htm">istruzione 
        SELECT</a> (che pu&ograve; presentare qualsiasi operatore, come una normale 
        query di interrogazione). L'ordine con cui i valori sono immessi nella 
        tabella di destinazione &egrave; quello dal primo all'ultimo campo in 
        ordine. Prendiamo due tabelle come esempio: la prima &egrave; la solita 
        <b>dipendenti</b> con i campi id, nome, cognome e ruolo. La seconda tabella 
        la chiameremo <b>dirigenti</b> e conterr&agrave; i campi nome, cognome 
        e ID (notare l'assenza del campo <i>RUOLO</i>).</p>
      <table width="95%" border="1" align="center">
        <tr> 
          <th colspan="4">TABELLA dipendenti</th>
          <td width="5%">&nbsp;</td>
          <th colspan="3">TABELLA dirigenti</th>
        </tr>
        <tr> 
          <th width="5%">ID</th>
          <th width="15%">NOME</th>
          <th width="20%">COGNOME</th>
          <th width="15%">RUOLO</th>
          <td width="5%">&nbsp;</td>
          <th width="15%">NOME</th>
          <th width="20%">COGNOME</th>
          <th width="5%">ID</th>
        </tr>
        <tr> 
          <td width="5%" align="center">1</td>
          <td width="15%">Filippo</td>
          <td width="20%">Cambrini</td>
          <td width="15%">Direttore</td>
          <td width="5%">&nbsp;</td>
          <td rowspan="4">&nbsp;</td>
          <td rowspan="4">&nbsp;</td>
          <td rowspan="4" align="center">&nbsp;</td>
        </tr>
        <tr> 
          <td width="5%" align="center">2</td>
          <td width="15%">Lucia</td>
          <td width="20%">Totti</td>
          <td width="15%">Impiegata</td>
          <td width="5%">&nbsp;</td>
        </tr>
        <tr> 
          <td width="5%" align="center">3</td>
          <td width="15%">Mauro</td>
          <td width="20%">Festina</td>
          <td width="15%">Direttore</td>
          <td width="5%">&nbsp;</td>
        </tr>
        <tr> 
          <td width="5%" align="center">4</td>
          <td width="15%">Paolo</td>
          <td width="20%">Cotroneo</td>
          <td width="15%">Direttore</td>
          <td width="5%">&nbsp;</td>
        </tr>
      </table>
      <p>Con una semplice istruzione SELECT recupereremo tutti i direttori dalla 
        tabella dipendenti come segue:</p>
      <p class="codicevb2">SELECT id, nome, cognome FROM dipendenti WHERE ruolo='Direttore'</p>
      <p>Naturalmente non sar&agrave; possibile utilizzare l'asterisco al posto 
        dei nomi dei campi perch&eacute; il numero di colonne delle due tabelle 
        &egrave; differente; l'istruzione INSERT INTO richiede che il numero di 
        campi da inserire sia uguale a quello specificato nella tabella di destinazione.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Recuperate le tre righe sar&agrave; necessario inserirle all'interno 
        della tabella dirigenti. Prima di inserire quest'istruzione SELECT in 
        coda all'istruzione INSERT INTO dobbiamo sistemare l'incongruenza! Infatti 
        i campi verrebbero inseriti in ordine dal primo all'ultimo, cio&egrave; 
        da sinistra verso destra; per cui il campo ID finirebbe su Nome, il campo 
        Nome su Cognome e Cognome su ID. Vediamo come risolvere questa problematica:</p>
      <p class="codicevb2">INSERT INTO dirigenti<br>
        SELECT nome, cognome, id FROM dipendenti WHERE ruolo='Direttore'</p>
      <p>La soluzione pi&ugrave; naturale &egrave; quella di riordinare i campi 
        nell'istruzione SELECT. &Egrave; importante ricordare l'ordine dei campi 
        i cui dati verrebbero inseriti nella tabella: i nomi dei campi infatti 
        sono ignorati e la sequenza &egrave; quella da sinistra verso destra. 
        Se invece avessimo utilizzato quest'altra istruzione SELECT avremmo ottenuto 
        un risultato inaspettato e non voluto:</p>
      <p class="codicevb2">INSERT INTO dirigenti<br>
        SELECT cognome, nome, id FROM dipendenti WHERE ruolo='Direttore'</p>
      <p>I dati del campo cognome sarebbero finiti nel campo nome e viceversa 
        per l'altro. Il campo ID invece sarebbe andato al suo posto, in coda a 
        tutti gli altri.<br>
        Un'altra soluzione invece consiste nel non disordinare i campi nell'istruzione 
        SELECT ma piuttosto specificare l'ordine con cui i dati dovrebbero essere 
        inseriti nella tabella di destinazione con una sintassi del genere:</p>
      <p class="codicevb2">INSERT INTO &lt;tabella&gt; ( &lt;campi&gt; ) &lt;istruzione 
        SELECT&gt;</p>
      <p>Utilizzabile come nell'esempio seguente:</p>
      <p class="codicevb2">INSERT INTO dirigenti(id, nome, cognome)<br>
        SELECT id, nome, cognome FROM dipendenti WHERE ruolo='Direttore'</p>
      <p>Quest'istruzione forza l'inserimento dei dati nei rispettivi campi (ID, 
        Nome e Cognome) della tabella di destinazione, rendendo l'inserimento 
        corretto. </p>
      <hr class="hrseparator">
      <p>&Egrave; tuttavia possibile inserire singoli valori all'interno di una 
        tabella, senza utilizzare un'istruzione SELECT, ad esempio per includere 
        dei valori arbitrari; la sintassi generale &egrave; questa:</p>
      <p class="codicevb2">INSERT INTO &lt;tabella&gt; VALUES( &lt;valori&gt; 
        )</p>
      <p>Ciascun valore specificato a seguito dell'operatore VALUES e seguito 
        da parentesi, deve essere separato da una virgola. Ad esempio inseriremo 
        nella tabella dirigenti i seguenti valori</p>
      <p> 
      <ul>
        <li>Nome: Mimmo</li>
        <li>Cognome: Corinzi</li>
        <li>ID=10</li>
      </ul>
      <p></p>
      <p class="codicevb2">INSERT INTO dirigenti VALUES('Mimmo', 'Corinzi', 10)</p>
      <p>Naturalmente 10 essendo un numero non sar&agrave; circondato dal carattere 
        di apostrofo che contraddistingue soltanto le strighe.<br>
        In maniera analoga ai casi precedenti possiamo forzare l'ordine d'inserimento 
        dei dati nei campi:</p>
      <p class="codicevb2">INSERT INTO &lt;tabella&gt; ( &lt;campi&gt; ) VALUES( 
        &lt;valori&gt; )</p>
      <p>Da trascrivere quindi con:</p>
      <p class="codicevb2">INSERT INTO dirigenti(id, cognome, nome) VALUES(10, 
        'Corinzi', 'Mimmo')</p>
      <hr class="hrseparator">
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><a name="SELECTINTO"></a>Esiste inoltre una seconda istruzione per l'inserimento 
        di dati che non tutti i database supportano. Questa, a differenza della 
        precedente, richiede che la tabella di destinazione non esista; infatti 
        sar&agrave; l'istruzione stessa a crearla, con i dati specificati. Se 
        la tabella di destinazione dovesse esistere sar&agrave; generato un errore:</p>
      <p class="codicevb2">SELECT &lt;campi&gt; INTO &lt;tabella&gt; FROM ...</p>
      <p>Si tratta di una normale istruzione SELECT, che pu&ograve; includere 
        qualsiasi operatore o altra clausola, che contiene la specifica della 
        tabella di destinazione da creare ed in cui inserire i dati estratti dall'espressione 
        seguente.</p>
      <p class="codicevb2">SELECT * INTO dipendenti2 FROM dipendenti</p>
      <p>Questa istruzione semplicemente copia l'intera tabella dipendenti dentro 
        una nuova tabella di nome dipendenti2. Saranno creati i campi con i nomi 
        ed i tipi corrispondenti della tabella di origine (dipendenti). Naturalmente 
        l'espressione avrebbe potuto essere anche molto pi&ugrave; complessa, 
        con la completa libert&agrave; e flessibilit&agrave; offerte dall'istruzione 
        SELECT.</p>
      <p>Tuttavia questa copia non sar&agrave; assolutamente identica; saranno 
        infatti creati i campi dello stesso tipo ma non saranno stabiliti i vincoli, 
        le chiavi o le caratteristiche avanzate presenti nella tabella di origine.</p>
      <p class="codicevb2">SELECT nome, cognome, id INTO dirigenti FROM dipendenti 
        WHERE ruolo='Direttore'</p>
      <p>Riprodurr&agrave; gli effetti ottenuti con gli esempi precedenti ma in 
        pi&ugrave; si occuper&agrave; di creare la nuova tabella dirigenti:<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --><!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        14 Marzo 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar2.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice della sezione Database</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
