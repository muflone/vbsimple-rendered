<html><!-- #BeginTemplate "/Templates/Database2.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Il linguaggio SQL (l'operatore UNION)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Il linguaggio SQL<br>
    L'operatore UNION<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/database.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script>
      <!-- #BeginEditable "CORPO" --> 
      <p>Si tratta di un operatore di unione verticale da utilizzare nelle selezioni, 
        non supportato da tutti i database, che consente di specificare una selezione 
        aggiuntiva ed un filtro opzionale per le righe duplicate. La sintassi 
        generale &egrave;:</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p class="codicevb2"><a href="db_08_01.htm">SELECT</a> &lt;campi&gt;<br>
        FROM &lt;origine&gt;<br>
        UNION [ALL]<br>
        <a href="db_08_01.htm">SELECT</a> &lt;campi&gt;<br>
        FROM &lt;origine&gt;<br>
        <a href="db_08_03.htm">ORDER BY</a> &lt;campi&gt;</p>
      <p>Ogni riga della seconda selezione viene accodata alla prima nell'ordine 
        dei campi specificati, in tal modo il risultato finale sar&agrave; la 
        somma verticale delle righe della prima selezione con quelle della seconda; 
        sono automaticamente escluse le righe duplicate. Il predicato opzionale 
        <b>ALL</b> consente di includere anche quelle righe che all'unione risultano 
        duplicate e qunidi ottenere un set di risultati composto esattamente dal 
        numero di righe della prima e della seconda selezione.</p>
      <p>Date le due tabelle PERSONALE e DIPENDENTI esposte nell'<a href="db_08_09.htm">articolo 
        precedente</a> l'unione verticale si espone come segue:</p>
      <p class="codicevb2">SELECT nome, cognome, ruolo FROM personale<br>
        UNION<br>
        SELECT nome, cognome, ruolo FROM dipendenti</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Estrarr&agrave; 6 righe contenenti tutti i nominativi unici contenuti 
        nelle due tabelle.</p>
      <table width="50%" border="1" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <th width="30%">NOME</th>
          <th width="30%">COGNOME</th>
          <th width="40%">RUOLO</th>
        </tr>
        <tr> 
          <td width="30%">Silvana</td>
          <td width="30%">Perugia</td>
          <td width="40%">Consulente</td>
        </tr>
        <tr> 
          <td width="30%">Milena</td>
          <td width="30%">Piconi</td>
          <td width="40%">Responsabile Acq.</td>
        </tr>
        <tr> 
          <td width="30%">Marco</td>
          <td width="30%">Tardi</td>
          <td width="40%">Ragioniere</td>
        </tr>
        <tr> 
          <td width="30%">Pasquale</td>
          <td width="30%">Catozzo</td>
          <td width="40%">Manager</td>
        </tr>
        <tr> 
          <td width="30%">Maurizio</td>
          <td width="30%">Maugeri</td>
          <td width="40%">Usciere</td>
        </tr>
        <tr> 
          <td width="30%">Lucio</td>
          <td width="30%">Capelli</td>
          <td width="40%">Ragioniere</td>
        </tr>
      </table>
      <p>I 3 nominativi duplicati contenuti in entrambe le tabelle saranno esclusi; 
        per includere tutte le righe, senza esclusione di quelle duplicate &egrave; 
        necessario specificare il predicato ALL:</p>
      <p class="codicevb2">SELECT nome, cognome, ruolo FROM personale<br>
        UNION ALL<br>
        SELECT nome, cognome, ruolo FROM dipendenti</p>
      <p>Estrarr&agrave; le 9 righe date dalla somma di 5 righe della tabella 
        personale e di 4 righe della tabella dipendenti. &Egrave; possibile ordinare 
        il set di risultati finale semplicemente includendo la clausola <a href="db_08_03.htm">ORDER 
        BY</a> in coda all'ultima selezione. Non sar&agrave; infatti possibile 
        ordinare i risultati restituiti dalle singole selezioni ma soltanto tutti 
        i dati restituiti dall'unione:</p>
      <p class="codicevb2">SELECT nome, cognome, ruolo FROM personale<br>
        UNION<br>
        SELECT nome, cognome, ruolo FROM dipendenti<br>
        ORDER BY ruolo</p>
      <p>Viceversa &egrave; possibile raggruppare i risultati delle singole selezioni 
        specificando la clausola <a href="db_08_08.htm">GROUP BY e HAVING</a> 
        ma non sar&agrave; possibile applicare il raggruppamento all'insieme dato 
        dall'unione delle due selezioni. Un'eventuale clausola GROUP BY aggiunta 
        in fondo all'istruzione di unione sar&agrave; invece applicata all'ultima 
        selezione soltanto:</p>
      <p class="codicevb2">SELECT ruolo FROM personale<br>
        GROUP BY ruolo<br>
        UNION ALL<br>
        SELECT ruolo FROM dipendenti<br>
        GROUP BY ruolo</p>
      <p>Restituir&agrave; 7 righe corrispondenti ai 4 ruoli della tabella personale 
        ed ai 3 ruoli della tabella dipendenti; se non avessimo incluso il predicato 
        ALL l'unione avrebbe filtrato ed escluso automaticamente le righe duplicate. 
        &Egrave; tuttavia possibile aggirare questa limitazione <a href="db_08_12.htm">creando 
        una vista (VIEW)</a> e quindi applicare il raggruppamento ai risultati 
        della vista stessa.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Si ricorda che i campi esposti nell'unione vanno considerati in ordine 
        anzich&eacute; assunti per nome; ci&ograve; significa che una selezione 
        del genere non restituisce i dati aspettati:</p>
      <p class="codicevb2">SELECT nome, cognome, ruolo FROM personale<br>
        UNION<br>
        SELECT cognome, nome, ruolo FROM dipendenti</p>
      <table width="50%" border="1" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <th width="30%" bgcolor="#CCFFCC">NOME</th>
          <th width="30%" bgcolor="#FFE3CC">COGNOME</th>
          <th width="40%">RUOLO</th>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#CCFFCC">Marco</td>
          <td width="30%" bgcolor="#FFE3CC">Tardi</td>
          <td width="40%">Ragioniere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#FFE3CC">Tardi</td>
          <td width="30%" bgcolor="#CCFFCC">Marco</td>
          <td width="40%">Ragioniere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#FFE3CC">Maugeri</td>
          <td width="30%" bgcolor="#CCFFCC">Maurizio</td>
          <td width="40%">Usciere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#CCFFCC">Maurizio</td>
          <td width="30%" bgcolor="#FFE3CC">Maugeri</td>
          <td width="40%">Usciere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#CCFFCC">Lucio</td>
          <td width="30%" bgcolor="#FFE3CC">Capelli</td>
          <td width="40%">Ragioniere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#FFE3CC">Capelli</td>
          <td width="30%" bgcolor="#CCFFCC">Lucio</td>
          <td width="40%">Ragioniere</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#CCFFCC">Pasquale</td>
          <td width="30%" bgcolor="#FFE3CC">Catozzo</td>
          <td width="40%">Manager</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#FFE3CC">Perugia</td>
          <td width="30%" bgcolor="#CCFFCC">Silvana</td>
          <td width="40%">Consulente</td>
        </tr>
        <tr> 
          <td width="30%" bgcolor="#CCFFCC">Milena</td>
          <td width="30%" bgcolor="#FFE3CC">Piconi</td>
          <td width="40%">Responsabile Acq.</td>
        </tr>
      </table>
      <p>Saranno infatti restituite sempre 9 righe (notare l'assenza del predicato 
        ALL) contenenti le 5 righe della tabella personale e quattro righe composte 
        dai dati del cognome all'interno della colonna del nome e dei dati del 
        nome all'interno della colonna del cognome.</p>
      <p>Sebbene non fosse stato finora accennato, &egrave; possibile unire pi&ugrave; 
        di due set di risultati separando ciascun insieme dal relativo operatore 
        UNION:</p>
      <p class="codicevb2">SELECT &lt;campi&gt; FROM &lt;origine&gt;<br>
        UNION [ALL]<br>
        SELECT &lt;campi&gt;FROM &lt;origine&gt;<br>
        UNION [ALL]<br>
        SELECT &lt;campi&gt; FROM &lt;origine&gt;<br>
        ... </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --><!-- #EndEditable --> 
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        25 Aprile 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar2.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice della sezione Database</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
