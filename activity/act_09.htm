<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Visualizzare lo stato di avanzamento del caricamento di una pagina Web</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Visualizzare lo stato di 
    avanzamento del caricamento di una pagina Web<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Furetto 
        83<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->7 Dicembre 
        2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>All'interno di un form ho inserito un controllo WebBrowser che carica 
        una determinata pagina Web al suo interno. Vorrei utilizzare una ProgressBar 
        per monitorare l'avanzamento del caricamento della pagina Web.</i></p>
      <hr>
      <p>Il progetto in questione &egrave; molto semplice, ma &egrave; necessario 
        possedere due <a href="../glossary/e.htm#ESTENSIONIVB">controlli OCX</a>: 
        <i>Microsoft Internet Controls</i> (<b>SHDOCVW.OCX</b>) e <i>Microsoft 
        Windows Common Controls 5.0 </i> (<b>COMCTL32.OCX</b>). Il primo &egrave; 
        incluso in ogni versione di Microsoft Internet Explorer 5.0, mentre il 
        secondo &egrave; installato con Visual Basic 5 Professional. Entrambi 
        comunque sono liberamente scaricabili all'indirizzo web di casa <a href="http://www.microsoft.com/italy" target="_blank">Microsoft</a>.</p>
      <p><img src="../images/activity/att09_01.jpg" width="55" height="141" align="right" alt="Figura 1">Una 
        volta assicurati che questi controlli sono installati sul computer apriamo 
        la voce <b>Componenti</b> dal menu Progetto di VB. Selezioniamo i due 
        controlli in questione e premiamo OK. Questo far&agrave; s&igrave; che 
        appaiano sulla casella dei controlli le icone che vediamo a lato.</p>
      <p>I primi 8 sono i controlli comuni di Windows (COMCTL32.OCX), mentre l'ultimo 
        &egrave; l'oggetto <i>WebBrowser</i> che istanzia una finestra di Internet 
        Explorer all'interno di un form.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Passiamo al nostro progetto: all'interno di un form inseriamo un <i>WebBrowser</i><img src="../images/controls/webbrowser.gif" width="25" height="25" align="absmiddle">di 
        nome <b>WebBrowser1</b>, una <i>ProgressBar</i><img src="../images/controls/progressbar.gif" width="25" height="25" align="absmiddle">di 
        nome <b>Avanzamento</b> ed un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>PulsanteVai</b>. Noi li abbiamo disposti cos&igrave;:</p>
      <p align="center"><img src="../images/activity/att09_02.png" width="346" height="195" alt="Figura 2"><br>
        <b>Figura 2</b></p>
      <p>Nel momento in cui l'utente clicca il pulsante Vai viene comunicato alla 
        finestra del browser di caricare e mostrare una pagina web. Vediamo intanto 
        questo pezzettino di codice:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub PulsanteVai_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;WebBrowser1.Navigate2 &quot;http://www.geocities.com/fibiafbi&quot;</li>
        <li>End Sub</li>
      </ol>
      <p>La funzione &egrave; semplicissima: all'evento <i>Click</i> sul pulsante 
        <b>PulsanteVai</b> viene eseguito il metodo <i>Navigate2</i> con l'indirizzo 
        web da mostrare.</p>
      <p>Passiamo ora allo scopo di questa richiesta: monitorare con una <i>ProgressBar</i> 
        il caricamento della pagina web.<br>
        Il controllo <i>WebBrowser</i> ha un evento di nome <b>ProgressChange</b> 
        che identifica l'avanzamento nel caricamento della pagina in corso.<br>
        Ci baster&agrave; semplicemente leggere i valori riportati da tale evento 
        per trovare la posizione di caricamento. Tale evento infatti passa due 
        valori: <b>Progress</b> che indica la posizione attualmente raggiunta 
        e <b>ProgressMax</b> che indica il valore che deve essere raggiunto per 
        completare il caricamento. Il nostro codice, per cui, sar&agrave;:</p>
      <ol class="codicevb" start="5">
        <li>Private Sub WebBrowser1_ProgressChange(ByVal Progress As Long, ByVal 
          ProgressMax As Long)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Avanzamento.Min = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Avanzamento.Max = ProgressMax</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Avanzamento.Value = Progress</li>
        <li>End Sub</li>
      </ol>
      <p>Alla riga 6 abbiamo inserito un'istruzione di gestione degli errori perch&eacute; 
        al termine del caricamento il valore dell'avanzamento pu&ograve; essere 
        inferiore a 0 e pu&ograve; generare un errore. Esistono soluzioni pi&ugrave; 
        pulite per effettuare queste operazioni, ma questa &egrave; la pi&ugrave; 
        semplice.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alle righe 7 e 8 definiamo i limiti della barra di avanzamento, impostando 
        la propriet&agrave; <i>Min</i> a 0 e la propriet&agrave; <i>Max</i> a 
        ProgressMax.<br>
        Ad ogni stato di avanzamento del caricamento verr&agrave; richiamato questo 
        evento con un valore <b>Progress</b> diverso. Per questo motivo assegnamo 
        il valore dell'avanzamento alla propriet&agrave; Value della barra.</p>
      <p align="center"><img src="../images/activity/att09_03.jpg" width="346" height="195" alt="Figura 3"> 
        <br>
        <b>Figura 3</b></p>
      <p>Eseguiamo il programma e vediamo il suo effetto. Naturalmente per vedere 
        il corretto funzionamento del codice &egrave; necessario che la connessione 
        ad Internet sia attiva.<br>
        Man mano che la pagina viene caricata la barra di avanzamento in basso 
        aumenter&agrave; il suo valore. Al termine del caricamento la stessa barra 
        sar&agrave; automaticamente svuotata.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Come per tutte le altre richieste, &egrave; presente il progetto scaricabile, 
        ma in questo caso il caricamento del codice da noi fornito pu&ograve; 
        presentare alcune difficolt&agrave;. Infatti tutti i componenti <a href="../glossary/a.htm#ACTIVEX">ActiveX</a> 
        hanno un loro <a href="../glossary/c.htm#CLSID">CLSID</a> registrato nel 
        sistema. In caso di versioni differenti dei componenti, anche il CLSID 
        pu&ograve; differire, rendendo il progetto non eseguibile.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        7 Dicembre 2000</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
