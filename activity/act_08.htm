<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Mandare in esecuzione un file *.inf</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Mandare in esecuzione un 
    file *.inf<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Daniel<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" --> 25 Novembre 2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>Devo creare un programmino EXE in Visual Basic che permetta di lanciare 
        un file di nome <b>MPEG4FIX.INF</b>.<br>
        Praticamente dovrei automatizzare l'operazione che si effettua cliccando 
        con il pulsante destro del mouse su un file *.INF e scegliendo l'opzione 
        <b>INSTALLA</b>.</i><i> </i></p>
      <hr>
      <p>L'operazione in questione &egrave; molto semplice.<br>
        Chiunque sappia maneggiare un po' il <a href="../glossary/r.htm#REGISTRO">registro 
        di Windows</a> pu&ograve; ricavarsi la stringa che esegue Windows nel 
        momento in cui si clicca sopra un file INF con il tasto destro del mouse 
        e si sceglie l'opzione <i>Installa</i>.</p>
      <p>La stringa da far eseguire al sistema &egrave;:</p>
      <p>&nbsp;&nbsp;&quot;RUNDLL.EXE setupx.dll,InstallHinfSection DefaultInstall 
        132 %1&quot;</p>
      <p>Naturalmente, secondo le regole del sistema Windows, al posto del %1 
        va inserito il nome completo del file da installare.</p>
      <p>La soluzione che adotteremo in questo esempio &egrave; quella di inserire 
        questo programma nella stessa cartella dove il file INF risiede.</p>
      <p>Inseriamo sopra un form un pulsante di nome <b>InstallButton</b>. Il 
        click sopra di esso invocher&agrave; l'installazione del file INF.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Il codice si compone di poche righe. Per comodit&agrave; abbiamo inserito 
        anche una funzione che attende la chiusura del programma di installazione 
        del file INF. Al termine d'essa apparir&agrave; un messaggio di conferma.</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li>Private Const RigaInstallazione As String = &quot;RUNDLL.EXE setupx.dll,InstallHinfSection 
          DefaultInstall 132 &quot;</li>
        <li>Private Const FileINF As String = &quot;MPEG4FIX.INF&quot;</li>
        <li></li>
        <li>Private Sub InstallButton_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim ReturnValue As Long</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ReturnValue = Shell(RigaInstallazione &amp; 
          App.Path &amp; &quot;\&quot; &amp; FileINF)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;While ReturnValue &lt;&gt; 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppActivate ReturnValue</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DoEvents</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Err.Number &lt;&gt; 
          0 Then ReturnValue = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Wend</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Installazione eseguita&quot;, 
          vbInformation + vbOKOnly</li>
        <li>End Sub</li>
      </ol>
      <p>La riga 2 definisce una <a href="../glossary/c.htm#COSTANTE">costante</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" border="0" align="absmiddle"> 
        di nome <b>RigaInstallazione</b> che contiene la stringa da eseguire al 
        fine di installare un file INF. Ovviamente abbiamo rimosso il %1 perch&eacute; 
        al posto di esso forniremo il nome del file INF.<br>
        Cos&igrave; la riga 3 definisce un'altra costante di nome <b>FileINF</b> 
        che contiene il nome, senza percorso del file da installare, ovvero <i>MPEG4FIX.INF</i>.</p>
      <p>All'interno della routine legata all'evento <i>Click</i> sopra il pulsante 
        <b>InstallButton</b> abbiamo le istruzioni di installazione.<br>
        La variabile <b>ReturnValue</b> conterr&agrave; il valore ritornato dalla 
        funzione <i>Shell</i>, valore che utilizzeremo per capire se l'installazione 
        &egrave; terminata o meno.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>In quest'operazione sfrutteremo la gestione degli errori.<br>
        Infatti non esistono funzioni per comprendere se l'esecuzione di processo 
        esterno &egrave; terminata, senza usare l'<a href="../glossary/a.htm#API">API</a>.<br>
        La riga 7 ci consente di non bloccare il programma nel momento in cui 
        si verifica un errore.</p>
      <p>La riga successiva utilizza l'istruzione <i>Shell</i> che chiama un processo 
        esterno in maniera <a href="../glossary/a.htm#ASINCRONO">asincrona</a>, 
        ovvero non attende la chiusura del programma esterno.<br>
        Vediamo con calma questa riga:</p>
      <p>&nbsp;&nbsp;ReturnValue = Shell(RigaInstallazione &amp; App.Path &amp; 
        &quot;\&quot; &amp; FileINF)</p>
      <p>La funzione <i>Shell</i> riceve come parametro una stringa composta da 
        4 parti:</p>
      <ol>
        <li>La costante <b>RigaInstallazione</b>, vista prima.</li>
        <li>La propriet&agrave; <b>App.Path</b>, che ci restituisce il percorso 
          dove si trova il programma in esecuzione, ovvero la cartella dentro 
          la quale sono contenuti il programma ed il file INF.</li>
        <li>Una piccola stringa <b>&quot;\&quot;</b> per separare il percorso 
          dal nome del file INF.</li>
        <li>La costante <b>FileINF</b> che contiene il nome, senza percorso del 
          file INF.</li>
      </ol>
      <p>L'unione dei quattro segmenti compone la corretta stringa di installazione 
        del programma contenuto nel file <i><b>MPEG4FIX.INF</b></i>.</p>
      <p>La funzione <i>Shell</i> restituisce il PID (Process ID - Numero del 
        processo) del programma chiamato.</p>
      <p>Alla riga 9 inizia un ciclo che dura fintanto che <b>ReturnValue</b> 
        &egrave; diverso da 0.<br>
        Se l'esecuzione del programma esterno &egrave; andata a buon fine, la 
        variabile ReturnValue conterr&agrave; il PID del programma, che &egrave; 
        sempre diverso da 0.</p>
      <p>Per cui all'interno del ciclo abbiamo l'istruzione <i>AppActivate</i> 
        che assicura che la finestra d'installazione del file INF sia in primo 
        piano. AppActivate riceve come parametro il PID del programma da attivare.</p>
      <p>All'interno dei cicli a lunghezza indeterminata &egrave; fondamentale 
        inserire sempre un'istruzione <i>DoEvents</i>. Senza d'essa il nostro 
        programma andrebbe alla massima velocit&agrave; permessa dal processore, 
        con il conseguente difetto di rallentare (se non addirittura bloccare) 
        il programma esterno.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Nel momento in cui l'esecuzione del programma esterno chiamato attraverso 
        la funzione <i>Shell</i> termina, non viene comunicato nulla al programma 
        Visual Basic.<br>
        Tuttavia se continuassimo a tentare di attivare un programma ormai chiuso 
        si verificherebbe un errore. Ma, poich&eacute;, abbiamo inserito un'istruzione 
        <i>On Error</i>, il programma non si bloccher&agrave; all'errore detto.<br>
        All'interno di questo ciclo, alla riga 12, abbiamo un controllo degli 
        errori verificatisi. Il verificarsi di un errore all'interno di questo 
        ciclo identifica la fine del programma esterno. Ecco perch&eacute; con 
        la riga 12 imposteremo il valore di ReturnValue a 0. Infatti il ciclo 
        verr&agrave; eseguito fintanto che il valore di ReturnValue &egrave; diverso 
        da 0.<br>
        L'esecuzione dell'assegnamento ReturnValue = 0 provoca l'uscita dal ciclo.</p>
      <p>Subito dopo il ciclo abbiamo una semplice istruzione <i>MsgBox</i> che 
        visualizza un messaggio di conferma dell'avvenuta installazione.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il difetto principale di questo semplice programmino &egrave; quello 
        di non poter controllare se l'installazione del programma &egrave; andata 
        a buon fine.<br>
        L'unica soluzione consiste nel controllare, subito dopo l'uscita del ciclo, 
        se alcuni o tutti i files installati dal file INF sono presenti sul disco, 
        ma questo richiede uno studio specifico del file INF in questione.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        25 Novembre 2000</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
