<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Conversione testo in ottetti per messaggi SMS (seconda parte)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Conversione testo in ottetti 
    per messaggi SMS<br>
    (seconda&nbsp;parte)<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Marcello 
        Gaidone<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" --> 
        6 Novembre 2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level5.gif" width="17" height="18" align="absmiddle"> 
        5<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p><i>Devo trasformare (ad esempio) la parola <b>hellohello</b> in una stringa 
        formata da 8 bit, in modo da poterla utilizzare per mandare SMS sui cellulari.</i></p>
      <hr>
      <p align="center"><a href="act_02.htm">&lt;&lt; Continua dalla parte 1</a></p>
      <p>Dopo aver visto l'alfabeto da utilizzare per effettuare la conversione, 
        ci serviremo di una funzione che converte un numero decimale in numero 
        binario ed un'altra funzione che effettua l'operazione inversa.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Cominciamo a definire le due funzioni appena citate:</p>
      <ol class="codicevb" start="1">
        <li>Public Function Dec2Bin(ByVal NUMERO As Integer, Optional ByVal LUNGHEZZA 
          As Integer) As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;While NUMERO &gt; 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dec2Bin = IIf(NUMERO 
          Mod 2 = 0, &quot;0&quot;, &quot;1&quot;) &amp; Dec2Bin</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMERO = Int(NUMERO 
          / 2)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Wend</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If (LUNGHEZZA &gt; 0) And (Len(Dec2Bin) &lt; 
          LUNGHEZZA) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dec2Bin = String(LUNGHEZZA 
          - Len(Dec2Bin), Asc(&quot;0&quot;)) &amp; Dec2Bin</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Function</li>
        <li></li>
      </ol>
      <p>La prima funzione si chiama Dec2Bin, che pronunciato in inglese suona 
        come Dec To Bin, ovvero Decimale a binario. Questa effettua una serie 
        di divisioni e di moduli, secondo il sistema di conversione in binario. 
        Questa funzione verifica che la stringa binaria risultante sia lunga almeno 
        un certo numero di caratteri (valore di LUNGHEZZA). Se la lunghezza &egrave; 
        minore di tale valore inserisce degli zeri alla sinistra del numero.</p>
      <ol class="codicevb" start="11">
        <li>Public Function Bin2Dec(ByVal NUMERO As String) As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim TEMP As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For TEMP = 1 To Len(NUMERO)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bin2Dec = Bin2Dec 
          + (Mid(NUMERO, TEMP, 1) * 2) ^ (Len(NUMERO) - TEMP)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next TEMP</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Right(NUMERO, 1) = &quot;0&quot; Then Bin2Dec 
          = Bin2Dec - 1</li>
        <li>End Function</li>
        <li></li>
      </ol>
      <p>Quest'ultima funzione effettua l'operazione inversa della funzione precedente. 
        Da un stringa binaria restituisce il valore intero corrispondente.</p>
      <p>Prima di iniziare con la vera funzione di conversione spiegamo con calma 
        il procedimento da seguire.</p>
      <p>Prendiamo innanzitutto in esame la stringa <b>hellohello</b> da convertire. 
        Convertiamo i singoli valori ASCII di ogni carattere in binario:</p>
      <table width="100%" border="1" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td align="center" width="10%"><b>h</b></td>
          <td align="center" width="10%"><b>e</b></td>
          <td align="center" width="10%"><b>l</b></td>
          <td width="10%" align="center"><b>l</b></td>
          <td align="center" width="10%"><b>o</b></td>
          <td width="10%" align="center"><b>h</b></td>
          <td width="10%" align="center"><b>e</b></td>
          <td align="center" width="10%"><b>l</b></td>
          <td align="center" width="10%"><b>l</b></td>
          <td align="center" width="10%"><b>o</b></td>
        </tr>
        <tr> 
          <td align="center" width="10%">104</td>
          <td align="center" width="10%">101</td>
          <td align="center" width="10%">108</td>
          <td align="center" width="10%">108</td>
          <td align="center" width="10%">111</td>
          <td align="center" width="10%">104</td>
          <td align="center" width="10%">101</td>
          <td align="center" width="10%">108</td>
          <td align="center" width="10%">108</td>
          <td width="10%" align="center">111</td>
        </tr>
        <tr> 
          <td align="center" width="10%" class="colorenero">1101000</td>
          <td align="center" width="10%" class="colorerosso">1100101</td>
          <td align="center" width="10%" class="coloreverde2">1101100</td>
          <td align="center" width="10%" class="coloreverde">1101100</td>
          <td align="center" width="10%" class="coloreblu">1101111</td>
          <td align="center" width="10%" class="coloregrigio">1101000</td>
          <td align="center" width="10%" class="coloreviola">1100101</td>
          <td align="center" width="10%" class="colorerosa">1101100</td>
          <td align="center" width="10%" class="coloreverde3">1101100</td>
          <td align="center" width="10%" class="coloreviola2">1101111</td>
        </tr>
      </table>
      <p>Come possiamo vedere dalla tabella sopra, ogni carattere di testo &egrave; 
        formato da un massimo di 7 bit. Per questo ogni carattere semplice verr&agrave; 
        chiamato <b><i>Settetto</i></b>. Il processo di conversione per l'invio 
        via SMS richiede che il testo sia convertito in <i><b>ottetti</b></i>, 
        in una maniera particolare.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Il primo settetto viene convertito in ottetto prendendo il bit all'estrema 
        destra del secondo carattere e mettendolo alla sinistra del primo bit 
        del primo carattere. Otterremmo cos&igrave; il primo ottetto: <b class="colorerosso">1</b>1101000. 
        Il primo bit in rosso &egrave; l'ultimo bit del secondo carattere.</p>
      <p>Il secondo settetto perde l'ultimo bit e rimangono sei bit. Aggiungiamo 
        a questi sei bit gli ultimi due (8 - 6) bit del terzo carattere. Otteniamo: 
        <b class="coloreverde2">00</b><b class="colorerosso">110010</b>. Due bit 
        del terzo carattere e sei bit del secondo, perch&eacute; l'ultimo bit 
        del secondo carattere &egrave; stato utilizzato per il primo.</p>
      <p>Procediamo con il terzo ottetto: abbiamo 5 bit del settetto e 3 bit del 
        carattere successivo: <b class="coloreverde">100</b><b class="coloreverde2">11011</b>. 
        E cos&igrave; via...</p>
      <p>Otterremmo quindi il seguente risultato:</p>
      <ul>
        <li>11101000 = 232 = E8 esadecimale</li>
        <li>00110010 = &nbsp;50 = 32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>10011011 = 155 = 9B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>11111101 = 253 = FD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>01000110 = &nbsp;70 = 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>10010111 = 151 = 97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>11011001 = 217 = D9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>11101100 = 236 = EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
        <li>00110111 = &nbsp;55 = 37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</li>
      </ul>
      <p>Cos&igrave; i 10 settetti verranno convertiti in 9 ottetti.<br>
        In teoria &egrave; stato semplice. Ora viene la parte del codice:</p>
      <ol class="codicevb" start="19">
        <li>Public Function CodificaSMS(ByVal MESSAGGIO As String) As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim TEMP As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim LUNGHEZZADAESAMINARE As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim TEMPSTR As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim OTTETTO As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;InizializzaAlfabeto</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For TEMP = 1 To Len(MESSAGGIO)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE = TrovaCarattereAlfabeto7(Mid(MESSAGGIO, 
          TEMP, 1))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If LUNGHEZZADAESAMINARE &gt; 127 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin((LUNGHEZZADAESAMINARE And &amp;HFF00) / &amp;H100, 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin((LUNGHEZZADAESAMINARE And &amp;HFF), 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin(LUNGHEZZADAESAMINARE, 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next TEMP</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR &amp; String(7, Asc(&quot;0&quot;))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE = 7</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For TEMP = 1 To Int(Len(TEMPSTR) / 8) + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Mid(TEMPSTR, 
          TEMP * 7 - 6, LUNGHEZZADAESAMINARE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Mid(TEMPSTR, 
          (TEMP + 1) * 7 - (7 - LUNGHEZZADAESAMINARE), 8 - LUNGHEZZADAESAMINARE) 
          &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE 
          = LUNGHEZZADAESAMINARE - 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If LUNGHEZZADAESAMINARE 
          = 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE 
          = 7</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMP 
          = TEMP + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Hex(Bin2Dec(OTTETTO))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(OTTETTO) = 
          1 Then OTTETTO = &quot;0&quot; &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodificaSMS = CodificaSMS 
          &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next TEMP</li>
        <li>End Function</li>
      </ol>
      <p>Le prime 4 righe dopo l'intestazione della funzione dichiarano 4 variabili:</p>
      <ul>
        <li>TEMP, usata per effettuare i cicli e calcoli generici</li>
        <li>LUNGEZZADAESAMINARE, valore numerico che indica il numero di bit da 
          prendere per volta. Per il primo settetto sono 7, per il secondo sono 
          6, etc.</li>
        <li>TEMPSTR &egrave; una stringa dentro la quale sar&agrave; memorizzata 
          la sequenza di bit.</li>
        <li>OTTETTO &egrave; un ottetto generato.</li>
      </ul>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alla riga 24 inizializziamo l'alfabeto creato nel modulo precedente con 
        la Sub <b>InizializzaAlfabeto</b>.</p>
      <p>Subito dopo abbiamo un ciclo for che costruisce la stringa TEMPSTR.</p>
      <ol class="codicevb" start="25">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For TEMP = 1 To Len(MESSAGGIO)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE = TrovaCarattereAlfabeto7(Mid(MESSAGGIO, 
          TEMP, 1))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If LUNGHEZZADAESAMINARE &gt; 127 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin((LUNGHEZZADAESAMINARE And &amp;HFF00) / &amp;H100, 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin((LUNGHEZZADAESAMINARE And &amp;HFF), 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR 
          &amp; Dec2Bin(LUNGHEZZADAESAMINARE, 7)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next TEMP</li>
      </ol>
      <p>Per ogni singolo carattere della stringa MESSAGGIO estrae la stringa 
        di 7 bit con Dec2Bin e la concatena alla stringa TEMPSTR.<br>
        L'unico problema che pu&ograve; sorgere &egrave; con i caratteri speciali 
        composti da due bytes. Pertanto viene controllato se il valore estratto 
        (<b>LUNGHEZZADAESAMINARE</b>) &egrave; maggiore di 127. In tal caso vengono 
        processati i due caratteri in maniera separata (righe 28-29) dopo averi 
        estratti con delle operazioni di AND. Se il numero non &egrave; superiore 
        a 127, possiamo elaborare tale numero traducendolo in sequenze di bit.</p>
      <ol class="codicevb" start="34">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TEMPSTR = TEMPSTR &amp; String(7, Asc(&quot;0&quot;))</li>
      </ol>
      <p>Questa riga aggiunge 7 zeri finali alla stringa TEMPSTR che verranno 
        utilizzati dall'ultimo ottetto.</p>
      <p>La funzione String genera una stringa di un certo numero di caratteri, 
        tutti uguali.<br>
        Richiede due parametri: il primo &egrave; il numero di caratteri da generare 
        ed il secondo &egrave; il codice ASCII del carattere da replicare.<br>
        Nel nostro esempio abbiamo usato la funzione Asc(&quot;0&quot;) per farci 
        tornare il codice ASCII del numero 0. Abbiamo creato allora una stringa 
        di 7 zeri e l'abbiamo concatenata alla stringa di bit.</p>
      <ol class="codicevb" start="35">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE = 7</li>
      </ol>
      <p>Sulla riga 35 memorizziamo il numero iniziale di bit da prendere in considerazione 
        per ogni settetto. All'inizio prenderemo l'intero settetto, per cui il 
        valore di <b>LUNGHEZZADAESAMINARE</b> sar&agrave; 7.</p>
      <ol class="codicevb" start="36">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For TEMP = 1 To Int(Len(TEMPSTR) / 8) + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Mid(TEMPSTR, 
          TEMP * 7 - 6, LUNGHEZZADAESAMINARE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Mid(TEMPSTR, 
          (TEMP + 1) * 7 - (7 - LUNGHEZZADAESAMINARE), 8 - LUNGHEZZADAESAMINARE) 
          &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE 
          = LUNGHEZZADAESAMINARE - 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If LUNGHEZZADAESAMINARE 
          = 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LUNGHEZZADAESAMINARE 
          = 7</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMP 
          = TEMP + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Hex(Bin2Dec(OTTETTO))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(OTTETTO) = 
          1 Then OTTETTO = &quot;0&quot; &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodificaSMS = CodificaSMS 
          &amp; OTTETTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next TEMP</li>
      </ol>
      <p>Ora inizia il vero ciclo di conversione. Per ogni settetto della stringa 
        eseguiremo certe operazioni.</p>
      <p>Alla riga 37 memorizziamo la prima parte dell'ottetto ovvero i caratteri 
        rimasti del settetto preso in esame. Il numero di bit da memorizzare in 
        OTTETTO &egrave; specificato dalla variabile <b>LUNGHEZZADAESAMINARE</b>.</p>
      <ol class="codicevb" start="38">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Mid(TEMPSTR, 
          (TEMP + 1) * 7 - (7 - LUNGHEZZADAESAMINARE), 8 - LUNGHEZZADAESAMINARE) 
          &amp; OTTETTO</li>
      </ol>
      <p>La riga 38 &egrave; il centro di questa funzione. Essa fa precedere a 
        OTTETTO i bit finali del settetto successivo.<br>
        Il numero di bit da prendere dal settetto successivo &egrave; dato dalla 
        differenza di 8 - <b>LUNGHEZZADAESAMINARE</b>.<br>
      </p>
      <p>A partire da dove deve prendere quei bit?<br>
        TEMP &egrave; il carattere attuale, quindi TEMP+1 &egrave; il carattere 
        successivo. Moltiplichiamo questo valore per 7, il numero di bit per settetto 
        e troviamo il punto dove finisce il settetto che ci serve. Da l&igrave; 
        torniamo indietro di 7-LUNGHEZZADAESAMINARE caratteri.</p>
      <p>Infatti al primo ciclo TEMP avr&agrave; valore 1 e LUNGHEZZADAESAMINARE 
        7.<br>
        La riga dice di partire da (1 + 1) * 7, quindi 14, la fine del secondo 
        settetto; dice pure di tornare indietro di (7 - 7) caratteri. Quindi il 
        risultato di quest'operazione &egrave; il 14 carattere perch&eacute; lo 
        spostamento all'indietro &egrave; di 0 caratteri.</p>
      <p>Dal 14&deg; carattere abbiamo bisogno di un certo numero di caratteri 
        per generare un ottetto, quindi 8&nbsp;-&nbsp;LUNGHEZZADAESAMINARE. Prenderemo 
        allora 1 carattere dal 14 bit.</p>
      <p>In seguito di questo diminuiamo LUNGHEZZADAESAMINARE di 1. Dopo il primo 
        ciclo allora sar&agrave; 6 il suo valore.</p>
      <p>Se mediante l'ultima operazione LUNGHEZZADAESAMINARE giunge a 0 dice 
        di ricominciare il conteggio da 7 e saltare un carattere poich&eacute; 
        tutti i bit di questo settetto saranno gi&agrave; stati presi dal ottetto 
        precedente.<br>
        Quest'operazione avviene al completamento del 7&deg; ottetto.</p>
      <ol class="codicevb" start="44">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTTETTO = Hex(Bin2Dec(OTTETTO))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(OTTETTO) = 
          1 Then OTTETTO = &quot;0&quot; &amp; OTTETTO</li>
      </ol>
      <p>La riga 44 prende l'ottetto binario e lo converte in esadecimale mediante 
        due operazioni. Prende l'ottetto binario, lo converte in decimale utilizzando 
        la funzione Bin2Dec. Il risultato di quest'operazione sar&agrave; un numero 
        decimale che andr&agrave; ad essere convertito in esadecimale dalla funzione 
        di VB Hex. Il risultato di Hex sar&agrave; memorizzato nella variabile 
        OTTETTO.</p>
      <p>Dopo questo momento OTTETTO conterr&agrave; un valore esadecimale e non 
        pi&ugrave; un valore binario.</p>
      <p>La riga 45 effettua un controllo d'obbligo. Se la lunghezza di OTTETTO 
        &egrave; di un carattere, aggiunge alla sinistra di tale carattere uno 
        zero ottenendo una cifra esadecimali completa di 2 caratteri.</p>
      <ol class="codicevb" start="46">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CodificaSMS = CodificaSMS 
          &amp; OTTETTO</li>
      </ol>
      <p>L'ultima riga del ciclo memorizza i singoli ottetti nella variabile CodificaSMS 
        che sar&agrave; il valore restituito all'uscita della funzione.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Questo processo di conversione termina qui.<br>
        Il consiglio a chi legge questo codice &egrave; di provarlo ed utilizzare 
        gli strumenti di debug forniti in VB. Il codice &egrave; alquanto complesso. 
        Una valida comprensione pu&ograve; essere data solo da una serie di prove 
        e controlli pratici.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        7 Novembre 2000<br>
        Corretto il 28 Marzo 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
