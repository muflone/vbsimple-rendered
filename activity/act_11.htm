<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Generare dei files in base ad un particolare tracciato (prima parte)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Generare dei files in base 
    ad un particolare tracciato<br>
    (prima&nbsp;parte)<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Roberto 
        Corona<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->12 
        Gennaio 2001<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level5.gif" width="17" height="18" align="absmiddle"> 
        5<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p><i>Ho bisogno di scrivere un programmino che, dopo aver analizzato dei 
        files contenenti dei particolari tracciati, estragga dei dati da un foglio 
        di Excel e tramite questi generi dei files di testo con una particolare 
        struttura determinata dal file del tracciato.</i></p>
      <hr>
      <p>Il problema si presenta molto complesso. Abbiamo, infatti, una serie 
        di files tracciato e in base a quello selezionato il programma deve generare 
        un file di testo.</p>
      <p>Pertanto la struttura del file di output non &egrave; predeterminabile. 
        Sar&agrave; necessario ogni volta leggere il file del tracciato per generare 
        il file di output.</p>
      <p>Per tale scopo creeremo un data parser, ovvero un programmino che analizzi 
        i files tracciato e dia all'utente la possibilit&agrave; di studiare i 
        tracciati e determinare alcune caratteristiche quali la lunghezza dei 
        dati, la loro formattazione, etc...</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Prima di iniziare con il programma vediamo uno di questi file tracciato:</p>
      <ol class="codicevb" start="1">
        <li>//CbV0001958AUVANN01UNFNNNNNARCONTIENV&quot;</li>
        <li>//GL01CI0NNNNN&quot;</li>
        <li>//GL02CRINNNNN&quot;</li>
        <li>@T</li>
        <li>@APINCO PALLINO</li>
        <li>VIA GIUSEPPE VERDI, 40</li>
        <li>00050 ROMA &nbsp;RM</li>
        <li>@T</li>
        <li>!NEW 2;SPA 6; INL 19</li>
        <li>XXXXXXXXXXXXXXXXXX &nbsp;&nbsp;XXXXXXXXXXXXXXXXXX XXX , XXXXXX &nbsp;XXXXX 
          (XX)</li>
        <li>!SPA 1</li>
        <li>XXXXXXXXXXXXXXXX &nbsp;&nbsp;XXXXXXXXXXXXXXXX</li>
        <li>!SPA; 1</li>
        <li>XXXXXXXXXXXXXXXX</li>
        <li>!INL; 0; TEX; 3; Top; SPA; 23</li>
        <li>@&gt;@?52&gt;XXXXXX&lt;@?0012345678&gt;@?XXXXXX+@?0123&lt;@&lt;</li>
      </ol>
      <p>Questo &egrave;il foglio di Excel che contiene i dati che andranno inseriti 
        nel file di output in sostituzione delle &quot;X&quot; del file tracciato:</p>
      <table width="90%" cellspacing="1" cellpadding="0" align="center">
        <tr bgcolor="#CCCCCC"> 
          <th width="25%">COGNOME_E NOME</th>
          <th width="25%">VIA_RESIDENZA</th>
          <th width="25%">NUMERO_CIV</th>
          <th width="25%">C_A_P_</th>
        </tr>
        <tr> 
          <th width="25%">COMUNE_RESIDENZA</th>
          <th width="25%">PROV_COM_R</th>
          <th width="25%">CODICE_FISCALE</th>
          <th width="25%">IMPORTO</th>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">ATXXS ANXXNINA</td>
          <td width="25%">GIULIO CESARE</td>
          <td width="25%">34</td>
          <td width="25%">09100</td>
        </tr>
        <tr> 
          <td width="25%">ROMA</td>
          <td width="25%">RM</td>
          <td width="25%">TZSVVVV5D49A380Z</td>
          <td width="25%">284060</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">AZIENDA SANITARIA LOCALE</td>
          <td width="25%">VIA CARDUCCI</td>
          <td width="25%">19</td>
          <td width="25%">09101</td>
        </tr>
        <tr> 
          <td width="25%">MILANO</td>
          <td width="25%">MI</td>
          <td width="25%">90003440956</td>
          <td width="25%">106200</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">AZIENDA SANITARIA LOCALE</td>
          <td width="25%">VIA CARDUCCI</td>
          <td width="25%">19</td>
          <td width="25%">09102</td>
        </tr>
        <tr> 
          <td width="25%">PIACENZA</td>
          <td width="25%">PZ</td>
          <td width="25%">90003440956</td>
          <td width="25%">106200</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">BILXXXCI ANTXXXO</td>
          <td width="25%">VIA CESARE BATTISTI</td>
          <td width="25%">8</td>
          <td width="25%">09103</td>
        </tr>
        <tr> 
          <td width="25%">TORINO</td>
          <td width="25%">TO</td>
          <td width="25%">BLLVVV61M03F839O</td>
          <td width="25%">80350</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">BISXXXXNI LEXXXNO</td>
          <td width="25%">VIA LEOPARDI</td>
          <td width="25%">22</td>
          <td width="25%">09104</td>
        </tr>
        <tr> 
          <td width="25%">NAPOLI</td>
          <td width="25%">NA</td>
          <td width="25%">BSGVVV52L20H825I</td>
          <td width="25%">80350</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">BXXXXU FRAXXXSCO</td>
          <td width="25%">VIA PAGANINI</td>
          <td width="25%">6</td>
          <td width="25%">09105</td>
        </tr>
        <tr> 
          <td width="25%">BARI</td>
          <td width="25%">BA</td>
          <td width="25%">BNNVVV16R06E285P</td>
          <td width="25%">80350</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">BONXXU FRANCESCO</td>
          <td width="25%">VIA PAGANINI</td>
          <td width="25%">6</td>
          <td width="25%">09106</td>
        </tr>
        <tr> 
          <td width="25%">PALERMO</td>
          <td width="25%">PA</td>
          <td width="25%">BNNVVV16R06E285P</td>
          <td width="25%">155526</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">CAXXXDU SEBASTIANO</td>
          <td width="25%">VIA FRA TOMMASO</td>
          <td width="25%">94</td>
          <td width="25%">09107</td>
        </tr>
        <tr> 
          <td width="25%">BOLOGNA</td>
          <td width="25%">BO</td>
          <td width="25%">CBDVVV53L05G147S</td>
          <td width="25%">106200</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">CABXXDU SEBASTIANO</td>
          <td width="25%">VIA FRA TOMMASO</td>
          <td width="25%">94</td>
          <td width="25%">09108</td>
        </tr>
        <tr> 
          <td width="25%">PISA</td>
          <td width="25%">PI</td>
          <td width="25%">CBDVVV53L05G147S</td>
          <td width="25%">192371</td>
        </tr>
        <tr bgcolor="#CCCCCC"> 
          <td width="25%">CAO NICXXO'</td>
          <td width="25%">VIA NAZARIO SAURO</td>
          <td width="25%">6</td>
          <td width="25%">09109</td>
        </tr>
        <tr> 
          <td width="25%">FIRENZE</td>
          <td width="25%">FI</td>
          <td width="25%">CAOVVL25T16G146G</td>
          <td width="25%">80350</td>
        </tr>
      </table>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Naturalmente i dati sopra sono soltanto degli esempi. Inutile preoccuparsi 
        della correttezza dei codici di avviamento postale o dei codici fiscale.</p>
      <p>Il file risultante dopo l'elaborazione delle prime due righe del foglio 
        di Excel dovrebbe essere il seguente:</p>
      <ol class="codicevb" start="1">
        <li>//CbV0001958AUVANN01UNFNNNNNARCONTIENV&quot;</li>
        <li>//GL01CI0NNNNN&quot;</li>
        <li>//GL02CRINNNNN&quot;</li>
        <li>@T</li>
        <li>@APINCO PALLINO</li>
        <li>VIA GIUSEPPE VERDI , 40</li>
        <li>00050 ROMA &nbsp;RM</li>
        <li>@T</li>
        <li>!NEW 2;SPA 6; INL 19</li>
        <li>ATXXS ANXXNINA &nbsp;&nbsp;GIULIO CESARE 34 , 09100 &nbsp;ROMA (RM)</li>
        <li>!SPA 1</li>
        <li>TZSVVVV5D49A380Z &nbsp;&nbsp;TZSVVVV5D49A380Z</li>
        <li>!SPA; 1</li>
        <li>TZSVVVV5D49A380Z</li>
        <li>!INL; 0; TEX; 3; Top; SPA; 23</li>
        <li>@&gt;@?52&gt;284060&lt;@?0012345678&gt;@?284060+@?0123&lt;@&lt;</li>
        <li>@T</li>
        <li>@APINCO PALLINO</li>
        <li>VIA GIUSEPPE VERDI , 40</li>
        <li>00050 ROMA &nbsp;RM</li>
        <li>@T</li>
        <li>!NEW 2;SPA 6; INL 19</li>
        <li>AZIENDA SANITARIA LOCALE &nbsp;&nbsp;VIA CARDUCCI 19 , 09101 &nbsp;MILANO 
          (MI)</li>
        <li>!SPA 1</li>
        <li>90003440956 &nbsp;&nbsp;90003440956</li>
        <li>!SPA; 1</li>
        <li>90003440956</li>
        <li>!INL; 0; TEX; 3; Top; SPA; 23</li>
        <li>@&gt;@?52&gt;106200&lt;@?0012345678&gt;@?106200+@?0123&lt;@&lt;</li>
      </ol>
      <p>Non vi sgomentate se tutti questi dati sembrano insignificanti; la spiegazione 
        seguir&agrave; a breve. Abbiamo soltanto voluto dare un'idea del problema.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La cosa che notiamo confrontando il file tracciato con il file risultante 
        &egrave; che le prime tre righe del tracciato sono fisse, vengono ovvero 
        scritte solo una volta, in cima al file.<br>
        Il seguito del file &egrave; invece lineare: ad ogni occorrenza di sequenze 
        di &quot;X&quot; viene estratto un campo dal foglio di Excel.</p>
      <p>In questo progettino creeremo una piccola utility che analizza i file 
        tracciato e, senza modificarli, crea un file di specifiche intese a determinare 
        la struttura dei campi del file tracciato. In sostanza il programmino 
        generer&agrave; un file con <a href="../glossary/e.htm#ESTENSIONEFILES">estensione</a> 
        .FDF (File Definition) per determinare quali righe all'interno del file 
        tracciato sono fisse e segner&agrave; le porzioni del file tracciato (quelle 
        con &quot;XXX&quot;) che andranno sostituite con un campo del foglio di 
        Excel.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p align="center"><a href="act_11_2.htm">Segue parte 2 &gt;&gt;</a></p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        27 Gennaio 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
