<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Gioco dell'impiccato</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Gioco dell'impiccato<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Rosario 
        Manto<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->11 
        Gennaio 2001<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>Vorrei implementare in Visual Basic il gioco dell'impiccato.</i></p>
      <hr>
      <p>Il problema in esame non &egrave; complesso, ma richiede un bel po' di 
        codice.<br>
        Il gioco &egrave; il solito rompicapo dove il giocatore deve indovinare 
        una determinata frase, della quale &egrave; nota soltanto la lunghezza 
        e la presenza di eventuali spazi, lettere accentate e numeri. Il giocatore 
        pu&ograve; scegliere una lettera dell'alfabeto a caso. Se tale lettera 
        esiste all'interno della frase sar&agrave; mostrata, altrimenti, il numero 
        di tentativi messi a disposizione diminuir&agrave; di 1.</p>
      <p>Nel nostro esempio daremo al giocatore fino a 10 possibilit&agrave; e 
        le parole saranno scelte in maniera casuale dal computer da un file di 
        testo di nome <b>PAROLE.TXT</b> presente nella stessa cartella dove si 
        trova il programma.</p>
      <p>Prima di cominciare ci si assicuri di avere tale file o crearlo ed inserirlo 
        nella cartella del programma.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/activity/att10_01.jpg" width="166" height="190" align="right" alt="Figura 1">Cominciamo 
        disegnando l'interfaccia utente per il giocatore.<br>
        Essa si compone dei seguenti controlli:</p>
      <ul>
        <li>Un'area <i>Shape</i><img src="../images/controls/shape.gif" width="25" height="25" align="absmiddle">di 
          nome <b>AreaCompleta</b> con tali propriet&agrave;: 
          <ul>
            <li><i>BackColor</i>: Celeste (&amp;H00FFFF00&amp;)</li>
            <li><i>BackStyle</i>: 1 - Opaque</li>
            <li><i>Shape</i>: 0 - Rectangle</li>
            <li><i>Top</i>: 120</li>
            <li><i>Height</i>: 3015</li>
          </ul>
        </li>
        <li>Un'area <i>Shape</i><img src="../images/controls/shape.gif" width="25" height="25" align="absmiddle">di 
          nome <b>AreaAttuale</b> con tali propriet&agrave;: 
          <ul>
            <li><i>BackColor</i>: Giallo (&amp;H0000FFFF&amp;)</li>
            <li><i>BackStyle</i>: 1 - Opaque</li>
            <li><i>Shape</i>: 0 - Rectangle</li>
            <li><i>Top</i>: 780</li>
            <li><i>Height</i>: 2355</li>
          </ul>
        </li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>Parola</b> con tali propriet&agrave;: 
          <ul>
            <li><i>Caption</i>: &quot;CAMPO PER LE PAROLE&quot;</li>
            <li><i>AutoSize</i>: True</li>
            <li><i>Font</i>: Fixedsys stile normale e grandezza 9</li>
          </ul>
        </li>
        <li>Un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
          nome <b>Arrendo</b> e <i>Caption</i> &quot;Mi arrendo&quot;</li>
        <li>Un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
          nome <b>NuovaParola</b> e <i>Caption</i> &quot;Nuova parola&quot;</li>
        <li>Un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
          nome <b>Soluzione</b> e <i>Caption</i> &quot;Propongo la soluzione&quot;</li>
        <li>Una <i>ListBox</i><img src="../images/controls/listbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>Lettere</b> con propriet&agrave; <i>Columns</i> a 7</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>TentativiLabel</b> e <i>Caption</i> &quot;Tentativi rimasti&quot;</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>TentativiRimasti</b> e <i>Caption</i> &quot;10 / 10&quot;</li>
      </ul>
      <p>Definita l'interfaccia utente, spieghiamone rapidamente il funzionamento, 
        per comprendere cosa dovr&agrave; fare il codice.</p>
      <p>All'inizio della partita il giocatore premer&agrave; il pulsante &quot;Nuova 
        parola&quot; e sar&agrave; mostrata la frase in maniera nascosta, ovvero 
        ogni carattere della parola sar&agrave; sostituito con un trattino. Il 
        giocatore di tale frase capir&agrave; soltanto la lunghezza ed il numero 
        di parole di cui si compone; per il resto vedr&agrave; soltanto una serie 
        di trattini.</p>
      <p>Vediamo le singole routine di cui il codice si compone:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li>Private Const MAXTENTATIVI = 10</li>
        <li>Private TENTATIVI As Integer</li>
        <li>Private LISTAPAROLE As Collection</li>
        <li>Private PAROLACERCATA As String</li>
        <li></li>
      </ol>
      <p>Innanzitutto definiamo alcuni dati globali all'interno del form.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alla riga 2 abbiamo definito la <a href="../glossary/c.htm#COSTANTE">costante</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" border="0" align="absmiddle"> 
        <b>MAXTENTATIVI</b> che indica il numero massimo di tentativi concessi 
        per indovinare la frase.</p>
      <p>Alla riga 3 abbiamo la variabile <b>TENTATIVI</b> che conterr&agrave; 
        il numero di tentativi finora fatti per indovinare la frase. Il numero 
        andr&agrave; da 0 a <b>MAXTENTATIVI</b>.</p>
      <p>Abbiamo definito anche una <i><a href="../glossary/c.htm#COLLECTION">Collection</a></i> 
        di nome <b>LISTAPAROLE</b> che conterr&agrave; tutte le frasi estratte 
        dal file. Per semplificare il processo, inizialmente tutte le frasi del 
        file saranno lette e memorizzate nella Collection. Man mano avanti con 
        il gioco le frasi saranno estratte in maniera casuale dalla Collection.</p>
      <p>Alla riga 5 abbiamo la variabile <b>PAROLACERCATA</b> che ospiter&agrave; 
        la parola (frase) ricercata durante il gioco.</p>
      <ol class="codicevb" start="7">
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim FILENR As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim BUFFER As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set LISTAPAROLE = New Collection</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Clear</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TentativiRimasti.Caption = &quot;0 / &quot; 
          &amp; MAXTENTATIVI</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Parola.Caption = &quot;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Top = AreaCompleta.Top</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Height = AreaCompleta.Height</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;FILENR = FreeFile</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Open App.Path &amp; &quot;\PAROLE.TXT&quot; 
          For Input As FILENR</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;While Not EOF(FILENR)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Line Input #FILENR, 
          BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LISTAPAROLE.Add UCase(BUFFER)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Wend</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Close FILENR</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>All'esecuzione dell'<a href="../glossary/e.htm#EVENTO">evento</a><img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle">Load 
        del form verranno eseguite alcune inizializzazioni dei controlli del form 
        e delle variabili.</p>
      <p>Alla riga 8 abbiamo dichiarato la variabile <b>FILENR</b> che conterr&agrave; 
        il numero dell'<a href="../glossary/h.htm#HANDLE">handle</a> del file 
        da cui leggere i dati.</p>
      <p>Alla riga 9 dichiariamo la variabile <b>BUFFER</b> che servir&agrave; 
        come <a href="../glossary/b.htm#BUFFER">buffer</a> di lettura dal file 
        contenente le frasi.</p>
      <p>Prima di poter utilizzare la Collection <b>LISTAPAROLE</b> &egrave; necessario 
        <a href="../glossary/i.htm#ISTANZA">istanziare</a> la <a href="../glossary/c.htm#CLASSE">classe</a> 
        mediante l'utilizzo della parola chiave <i>New</i> (riga 10).</p>
      <p>Nelle righe dal 10 al 15 vengono inizializzati i <a href="../glossary/c.htm#CONTROLLO">controlli</a> 
        sul form: viene azzerata la <i>ListBox</i> <b>Lettere</b>, viene preparata 
        la <i>Label</i> <b>TentativiRimasti</b> scrivendo in essa il numero massimo 
        di tentativi <i><b>MAXTENTATIVI</b></i>, viene azzerata la <i>Label</i> 
        <b>PAROLA</b> che conterr&agrave; la frase da indovinare ed infine viene 
        posta l'area <i>Shape</i> <b>AreaAttuale</b> alle stesse coordinate dell'altra 
        area <b>AreaCompleta</b>.</p>
      <p>Alle righe da 16 a 22 viene effettuata <a href="../howto/ht_003.htm">l'apertura, 
        la lettura e chiusura del file</a>. Ogni riga del file viene scritta (in 
        maiuscolo) all'interno della <i>Collection</i>.</p>
      <ol class="codicevb" start="25">
        <li>Private Sub Form_Terminate()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set LISTAPAROLE = Nothing</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Poich&eacute; abbiamo <a href="../glossary/i.htm#ISTANZA">istanziato</a> 
        la <i>Collection</i> <b>LISTAPAROLE</b> &egrave; consigliabile effettuare 
        la <a href="../glossary/d.htm#DEALLOCARE">deallocazione</a> della Collection 
        alla chiusura del form. L'evento Terminate &egrave; l'ultima routine eseguita 
        prima dell'effettivo scaricamento del form dalla memoria.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La riga 26 effettua lo scaricamento della Collection <b>LISTAPAROLE</b> 
        dalla memoria.</p>
      <ol class="codicevb" start="29">
        <li>Private Sub NuovaParola_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PAROLACASUALE As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim CONTA As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PAROLANASCOSTA As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Randomize</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PAROLACASUALE = Rnd * (LISTAPAROLE.Count - 
          1) + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PAROLACERCATA = LISTAPAROLE.Item(PAROLACASUALE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PAROLANASCOSTA = &quot;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For CONTA = 1 To Len(PAROLACERCATA)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAROLACASUALE = Asc(Mid(PAROLACERCATA, 
          CONTA, 1))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If (PAROLACASUALE 
          &gt;= Asc(&quot;A&quot;)) And (PAROLACASUALE &lt;= Asc(&quot;Z&quot;)) 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAROLANASCOSTA 
          = PAROLANASCOSTA &amp; &quot;-&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAROLANASCOSTA 
          = PAROLANASCOSTA &amp; Chr(PAROLACASUALE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next CONTA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Parola.Caption = PAROLANASCOSTA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Clear</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For CONTA = Asc(&quot;A&quot;) To Asc(&quot;Z&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lettere.AddItem Chr(CONTA)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next CONTA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.ListIndex = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Top = AreaCompleta.Top</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Height = AreaCompleta.Height</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Enabled = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Soluzione.Enabled = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Arrendo.Enabled = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TENTATIVI = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TentativiRimasti.Caption = MAXTENTATIVI - 
          TENTATIVI &amp; &quot; / &quot; &amp; MAXTENTATIVI</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Il click sopra il pulsante <b>NuovaParola</b> effettuer&agrave; la scelta 
        casuale di una frase dalla Collection, nasconder&agrave; la frase immettendo 
        trattini al posto delle lettere alfabetiche e reinizializzer&agrave; i 
        controlli.</p>
      <p>All'interno di questa routine abbiamo dichiarato tre variabili: <b>PAROLACASUALE</b> 
        indicher&agrave; il numero casuale della frase da estrarre dalla Collection, 
        <b>CONTA</b> servir&agrave; per effettuare dei cicli ripetitivi e <b>PAROLANASCOSTA</b> 
        sar&agrave; uno spazio temporaneo per preparare la frase da indovinare.</p>
      <p>Alla riga 33 viene inizializzato il generatore di numeri casuali ed alla 
        riga successiva viene scelta una frase casuale compresa tra 1 ed il numero 
        complessivo di frasi contenute nella Collection. Il numero della frase 
        viene memorizzato nella variabile <b>PAROLACASUALE</b>. Alla riga 35 viene 
        memorizzata nella variabile globale <b>PAROLACERCATA</b> la frase da indovinare.</p>
      <p>Nelle righe comprese tra 36 e 45 viene creata la frase nascosta. Prima 
        viene azzerata la variabile <b>PAROLANASCOSTA</b>, e man mano viene estratto 
        un carattere dalla frase <b>PAROLACERCATA</b> e memorizzato in <b>PAROLACASUALE</b>. 
        Se il carattere estratto &egrave; compreso nell'insieme delle lettere 
        alfabetiche esso viene sostituito con un trattino, altrimenti non viene 
        toccato. Cos&igrave;, man mano viene generata la frase in maniera nascosta 
        e memorizzata in <b>PAROLANASCOSTA</b>.<br>
        Al termine della generazione viene mostrata nella <i>Label</i> <b>Parola</b> 
        la frase nascosta (riga 45).</p>
      <p>Nelle righe tra 46 e 57 vengono reinizializzati i controlli.<br>
        Viene prima azzerata e poi riempita nuovamente la <i>ListBox</i> <b>Lettere</b> 
        con le lettere alfabetiche; fatto questo viene selezionata la prima lettera, 
        quella con indice 0.<br>
        In seguito viene ridisposta l'area <i>Shape</i> <b>AreaAttuale</b>, sono 
        riattivati i controlli <b>Lettere</b>, <b>Soluzione</b> ed <b>Arrendo</b>.<br>
        Alla riga 56 viene azzerato il numero di tentativi effettuati e viene 
        ridisegnata la <i>Label</i> indicante il numero di possibilit&agrave; 
        rimaste.</p>
      <ol class="codicevb" start="60">
        <li>Public Function TrovaLettera(ByVal LETTERA As String) As Boolean</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim CONTA As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PAROLANASCOSTA As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PAROLANASCOSTA = Parola.Caption</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TrovaLettera = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For CONTA = 1 To Len(PAROLACERCATA)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Mid(PAROLACERCATA, 
          CONTA, 1) = LETTERA Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAROLANASCOSTA 
          = Left(PAROLANASCOSTA, CONTA - 1) &amp; LETTERA &amp; Mid(PAROLANASCOSTA, 
          CONTA + 1)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TrovaLettera 
          = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next CONTA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Parola.Caption = PAROLANASCOSTA</li>
        <li>End Function</li>
        <li></li>
      </ol>
      <p>Prepariamo una funzione booleana di nome <b>TrovaLettera</b>. Essa effettua 
        la sostituzione dei trattini della frase nascosta con la lettera scelta 
        e passata come parametro. Il valore che la funzione restituisce indica 
        se la frase da indovinare conteneva almeno un'occorrenza della lettera 
        ricercata. </p>
      <p>Alla riga 62 viene dichiarata la variabile <b>PAROLANASCOSTA</b> che 
        conterr&agrave; la frase nascosta, contenuta nella <i>Label</i> <b>Parola</b>.</p>
      <p>Alla riga 65 inizia un ciclo che controlla tutte le lettere della frase 
        originale memorizzata nella variabile <b>PAROLACERCATA</b>. Se la lettera 
        in analisi &egrave; uguale a quella ricercata (riga 66), viene sostituito 
        il trattino della frase nascosta con la lettera ricercata (riga 67) e 
        viene impostato a True il valore <b>TrovaLettera</b> che sar&agrave; restituito 
        all'uscita della funzione (riga 68).</p>
      <p>Alla riga 71, infine, viene aggiornata la <i>Label</i> <b>Parola</b> 
        con la nuova frase.</p>
      <ol class="codicevb" start="74">
        <li>Private Sub Lettere_DblClick()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim LETTERAOK As Boolean</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim SPOSTAMENTO As Single</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LETTERAOK = TrovaLettera(Lettere.List(Lettere.ListIndex))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.RemoveItem Lettere.ListIndex</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.ListIndex = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If LETTERAOK = True Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Parola.Caption 
          = PAROLACERCATA Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox 
          &quot;Hai vinto!&quot;, vbInformation + vbOKOnly, &quot;Il nuovo impiccato&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Enabled 
          = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Soluzione.Enabled 
          = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrendo.Enabled 
          = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TENTATIVI = TENTATIVI 
          + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPOSTAMENTO = (AreaCompleta.Height 
          / MAXTENTATIVI)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Top = 
          AreaAttuale.Top + SPOSTAMENTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If AreaAttuale.Height 
          &lt; SPOSTAMENTO Then AreaAttuale.Height = SPOSTAMENTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AreaAttuale.Height 
          = AreaAttuale.Height - SPOSTAMENTO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TentativiRimasti.Caption = MAXTENTATIVI - 
          TENTATIVI &amp; &quot; / &quot; &amp; MAXTENTATIVI</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If TENTATIVI = MAXTENTATIVI Then Arrendo_Click</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Nel momento in cui l'utente clicca due volte rapidamente sopra una lettera 
        della <i>ListBox</i> viene effettuato il controllo di tale lettera. Se 
        essa esiste, saranno scoperte le occorrenze della lettera, altrimenti 
        il numero di tentativi incrementer&agrave; di 1. La lettera sar&agrave; 
        in ogni caso elimininata dalla <i>ListBox</i> <b>Lettere</b>.</p>
      <p>Alla riga 77 viene chiamata la funzione TrovaLettera con la lettera al 
        momento selezionata, indicata dalla propriet&agrave; <i><b>ListIndex</b></i> 
        della <i>ListBox</i>. Il valore restituito dalla funzione TrovaLettera 
        viene memorizzato nella variabile <b>LETTERAOK</b>.</p>
      <p>Se &egrave; stata trovata almeno un'occorrenza della lettera cercata 
        viene verificato se la nuova frase (riga 81), con le lettere scoperte, 
        &egrave; uguale alla frase originale PAROLACERCATA. In tal caso il giocatore 
        ha completato il gioco. Sar&agrave; mostrato un messaggio e verranno bloccati 
        i controlli <b>Lettere</b>, <b>Soluzione</b> e <b>Arrendo</b>.</p>
      <p>Se, invece, la ricerca della lettera specificata d&agrave; esito negativo 
        (riga 87), il giocatore ha commesso un errore; viene aumentato il valore 
        di TENTATIVI (riga 88) e viene aggiornata la posizione dell'area <b>AreaAttuale</b>, 
        spostandola di una certa misura, data dalla divisione dell'area complessiva 
        per il numero massimo di tentativi.</p>
      <p>Alla riga 94 viene aggiornata la <i>Label</i> che indica il numero di 
        tentativi rimasti.</p>
      <p>Se il numero di tentativi effettuati &egrave; uguale al numero massimo 
        di tentativi concessi, la partita termina, come se il giocatore si arrendesse 
        (riga 95).</p>
      <ol class="codicevb" start="98">
        <li>Private Sub Arrendo_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TENTATIVI = MAXTENTATIVI</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TentativiRimasti.Caption = MAXTENTATIVI - 
          TENTATIVI &amp; &quot; / &quot; &amp; MAXTENTATIVI</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Hai perso!&quot;, vbCritical 
          + vbOKOnly, &quot;Il nuovo impiccato&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Enabled = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Soluzione.Enabled = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Arrendo.Enabled = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Parola.Caption = PAROLACERCATA</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Il click sopra il pulsante <b>Arrendo</b> provoca la perdita della partita, 
        la visualizzazione di un messaggio (riga 101) ed il blocco dei soliti 
        controlli <b>Lettere</b>, <b>Soluzione</b> e <b>Arrendo</b>.</p>
      <p>Alla riga 105 viene mostrata la frase da indovinare (<b>PAROLACERCATA</b>).</p>
      <ol class="codicevb" start="108">
        <li>Private Sub Soluzione_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If (UCase(InputBox(&quot;La soluzione secondo 
          me &egrave;:&quot;, &quot;Prova soluzione&quot;)) = PAROLACERCATA) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parola.Caption = PAROLACERCATA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Hai vinto!&quot;, 
          vbInformation + vbOKOnly, &quot;Il nuovo impiccato&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lettere.Enabled = 
          False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Soluzione.Enabled 
          = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrendo.Enabled = 
          False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrendo_Click</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub</li>
      </ol>
      <p>L'ultima routine da vedere &egrave; il click sopra il pulsante <b>Soluzione</b>. 
        Esso provoca la visualizzazione di una finestra che chiede la soluzione 
        secondo il giocatore. Se il messaggio immesso &egrave; uguale alla frase 
        ricercata (riga) 109, viene mostrata la frase, appare un messaggio che 
        indica la vittoria e sono bloccati i controlli <b>Lettere</b>, <b>Soluzione</b> 
        ed <b>Arrendo</b>.</p>
      <p>Se la soluzione proposta dal giocatore &egrave; sbagliata, la partita 
        termina immediatamente, come se il giocatore si arrendesse (riga 116).</p>
      <hr>
      <p><img src="../images/activity/att10_02.jpg" width="166" height="190" align="right" alt="Figura 2">Il 
        progetto termina qui. Rimane solo di provarlo.</p>
      <p>All'avvio del programma appare soltanto un form tutto bloccato. &Egrave; 
        attivo soltanto il pulsante la cui Caption indica <b><i>&quot;Nuova parola&quot;</i></b>.</p>
      <p>Provando a cliccarlo inizia una nuova parita, con un frase scelta a caso 
        dal file PAROLE.TXT.</p>
      <p>Si attiva la <i>ListBox</i> <b>Lettere</b> ed i pulsanti <b><i>&quot;Mi 
        arrendo&quot;</i></b> e <b><i>&quot;Propongo la soluzione&quot;</i></b>.</p>
      <hr>
      <p><img src="../images/activity/att10_03.jpg" width="166" height="190" align="right" alt="Figura 3">Man 
        mano che il gioco procede, le lettere dalla <i>ListBox</i> spariscono.</p>
      <p>Se la lettera scelta compare nella frase da indovinare essa sar&agrave; 
        mostrata. In caso contrario il numero di tentativi rimasti diminuisce 
        di 1 e la barra gialla alla sinistra scende.</p>
      <p>Se, entro il numero massimo di tentativi concessi, il giocatore indovina 
        la frase apparir&agrave; il messaggio mostrato nella figura 4.</p>
      <p>Se il giocatore si arrende, non riesce ad indovinare la frase nascosta 
        entro il numero di tentativi messi a disposizione, o sbaglia la soluzione, 
        apparir&agrave; il messaggio mostrato nella figura 5.</p>
      <p>Nel momento in cui l'utente clicca sul pulsante <b><i>&quot;Propongo 
        la soluzione&quot;</i></b> gli viene presentata la finestra mostrata nella 
        figura 6. Viene richiesta la soluzione.</p>
      <p>Se la frase inserita &egrave; quella corretta apparir&agrave; un messaggio 
        che indica la vittoria (figura 4), altrimenti la partita si chiuder&agrave; 
        con una sconfitta (figura 5).</p>
      <table width="70%" border="0" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <td align="center" valign="top" width="50%"><img src="../images/activity/att10_04.jpg" width="98" height="95" alt="Figura 4"><br>
            <b>Figura 4</b> </td>
          <td align="center" valign="top" width="50%"><img src="../images/activity/att10_05.jpg" width="98" height="95" alt="Figura 5"><br>
            <b>Figura 5</b> </td>
        </tr>
        <tr align="center" valign="top"> 
          <td colspan="2"><img src="../images/activity/att10_06.jpg" width="290" height="116" alt="Figura 6"><br>
            <b>Figura 6</b> </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il gioco non offre alcuna tecnica particolare. &Egrave; dedicata soltanto 
        una particolare cura sugli elementi che compongono l'interfaccia utente.</p>
      <p>Non &egrave; un progetto ambizioso, ma pu&ograve; essere uno spunto per 
        qualche altro progetto.<br>
        Male che vada potrete godervi qualche piacevole ora con questo gioco che 
        prende sempre molto piede tra i giovanissimi tra i banchi di scuola.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        15 Gennaio 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
