<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Utilizzo dei pulsanti di opzione per la scelta del form da caricare</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Utilizzo dei pulsanti di 
    opzione per la scelta del form da caricare<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Mauro 
        Scaini<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->18 
        Novembre 2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>Sto sviluppando un progetto e vorrei dare all'utente la possibilit&agrave; 
        di scegliere quale form caricare utilizzando i pulsanti di opzione.</i></p>
      <hr>
      <p>Questa &egrave; una scelta implementativa molto comune.<br>
        Abbiamo una serie di OptionButton<img src="../images/controls/optionbutton.gif" width="25" height="25" align="absmiddle">e 
        vogliamo che in base ad essi appaiano all'utente diversi forms.</p>
      <p><img src="../images/activity/att06_01.jpg" width="130" height="155" align="right" alt="Figura 1">Come 
        punto di partenza definiamo il primo form che fornir&agrave; le scelte 
        all'utente. Nel nostro caso avremo quattro programmi che l'utente pu&ograve; 
        scegliere e quattro OptionButton sul form principale.</p>
      <p>Dunque sul nostro Form1 abbiamo una matrice di quattro pulsanti di opzione. 
        Ricordiamo che per formare una matrice di controlli basta inserire almeno 
        due pulsanti e dargli lo stesso nome. Verr&agrave; chiesto se si desidera 
        formare una matrice di controlli. Rispondendo SI verr&agrave; impostata 
        in automatico la propriet&agrave; Index, che differenzia i diversi pulsanti 
        all'interno della matrice.</p>
      <p>Nel nostro esempio i quattro pulsanti si chiameranno <b>Selezione</b> 
        e le loro propriet&agrave; Index andranno da 0 a 3. Posizioniamo i quattro 
        pulsanti nel modo visibile nella figura, avendo cura di posizionare il 
        pulsante con Index 0 nella prima posizione, quello con Index 1 subito 
        sotto e cos&igrave; via.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Inseriamo anche un pulsante standard di nome <b>PulsanteOK</b> ed assegnamogli 
        la Caption <i>Esegui</i>. Al click sopra di esso verr&agrave; controllato 
        lo stato dei quattro pulsanti e verr&agrave; caricato il programma corrispondente 
        al pulsante la cui propriet&agrave; Value &egrave; True. Per questo scopo 
        &egrave; fondamentale che i pulsanti abbiano valori della propriet&agrave; 
        Index consecutivi (0, 1, 2, 3).</p>
      <p>Prima di passare al codice stabiliamo quali saranno i forms che verranno 
        caricato nel momento in cui sar&agrave; premuto il pulsante <i>Esegui</i>.<br>
        Nel nostro esempio inseriamo altri quattro forms di nome <b>Programma1</b>, 
        <b>Programma2</b>, <b>Programma3</b> e <b>Programmma4</b>.<br>
        Per il nostro scopo non ci interessa cosa faranno i diversi programmi; 
        tuttavia inseriamo qualche controllo per riconoscere ogni programma da 
        un altro.<br>
        Ecci i nostri 4 forms:</p>
      <table width="100%" border="1" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <td align="center" valign="middle" width="50%"><img src="../images/activity/att06_02.jpg" width="226" height="95" alt="Figura 2"><br>
            <b>Programma 1</b> </td>
          <td align="center" valign="middle" width="50%"><img src="../images/activity/att06_03.jpg" width="248" height="106" alt="Figura 3"><br>
            <b>Programma 2</b> </td>
        </tr>
        <tr> 
          <td align="center" valign="middle" width="50%"><img src="../images/activity/att06_04.jpg" width="252" height="131" alt="Figura 4"><br>
            <b>Programma 3</b> </td>
          <td align="center" valign="middle" width="50%"><img src="../images/activity/att06_05.jpg" width="182" height="72" alt="Figura 5"><br>
            <b>Programma 4</b> </td>
        </tr>
      </table>
      <p>Faremo in modo che non sia possibile aprire pi&ugrave; di un programma 
        per volta e la chiusura di un programma provochi la ricomparsa del form 
        di scelta. Quando l'utente ha deciso di terminare l'uso del programma 
        dovr&agrave; chiudere il form di scelta.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Cominciamo a lavorare nel codice dei diversi programmi.<br>
        Apriamo la finestra del codice dei quattro forms Programma1, Programma2, 
        Programma3 e Programma4 e, nella routine legata all'evento <i>Unload</i> 
        dell'oggetto <b>Form</b>, scriviamo: <code>Form1.Show 0</code></p>
      <p>Per <b class="sottolineato">ognuno dei quattro forms</b> dovremmo avere 
        quindi:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub Form_Unload(Cancel As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Form1.Show 0</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Fatto questo apriamo la finestra del codice di <b>Form1</b> ovvero del 
        form di scelta programma e scriviamo nella routine dell'evento <i>Click</i> 
        di <b>PulsanteOK</b>:</p>
      <ol class="codicevb" start="5">
        <li>Private Sub PulsanteOK_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PulsantePremuto As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim Contatore As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For Contatore = 0 To 3</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Selezione(Contatore).Value 
          = True Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PulsantePremuto 
          = Contatore</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit 
          For</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next Contatore</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Select Case PulsantePremuto</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load 
          Programma1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programma1.Show 
          0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load 
          Programma2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programma2.Show 
          0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case 2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load 
          Programma3</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programma3.Show 
          0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case 3</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load 
          Programma4</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programma4.Show 
          0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End Select</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Me.Hide</li>
        <li>End Sub</li>
      </ol>
      <p>In quesa routine dichiareremo due variabili: <b>PulsantePremuto</b> che 
        indicher&agrave; l'indice (ovvero il contenuto della propriet&agrave; 
        Index) del pulsante premuto e <b>Contatore</b> che ci servir&agrave; come 
        appoggio per controllare qual'&egrave; il pulsante premuto.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>      <p>All'interno del codice i singoli elementi della matrice sono indicati 
        con Selezione(0), Selezione(1) a seconda del loro indice.</p>
      <p>Subito sotto le dichiarazioni abbiamo un ciclo che controlla tutti i 
        pulsanti <b>Selezione</b>. Se durante il ciclo un pulsante &egrave; attivato, 
        ergo ha la propriet&agrave; <i>Value</i> impostata a True, viene memorizzato 
        il valore di Contatore all'interno della variabile <b>PulsantePremuto</b> 
        ed avviene l'uscita forzata dal ciclo con <code>Exit For</code>.<br>
        All'uscita del ciclo viene effettuato un controllo del valore di PulsantePremuto 
        mediante un'istruzione Select Case.</p>
      <p>Viene fatto un controllo per i singoli valori ammissibili (dallo 0 al 
        3) e di conseguenza viene caricato (con Load) e mostrato (con Show) il 
        form relativo.</p>
      <p>Prima di uscire dalla routine viene nascosto il form di scelta, ma non 
        verr&agrave; scaricato dalla memoria. Il Form1 verr&agrave; mostrato nuovamente 
        all'uscita dei singoli programmi, attraverso l'istruzione <code>Form1.Show 
        0</code>.</p>
      <p>&Egrave; estremamente non sottovalutare questo: un form nascosto mediante 
        l'istruzione Hide non viene n&eacute; chiuso n&eacute; scaricato dalla 
        memoria. &Egrave; un errore molto comune nascondere un form, mostrarne 
        un altro e, quando terminato l'uso, chiudere il secondo senza chiudere 
        il primo.<br>
        Visibilmente potrebbe sembrare tutto a posto perch&eacute; non ci sono 
        sullo schermo finestre visibili, ma in questa situazione di errore il 
        form nascosto occupa aree di memoria e pu&ograve; pregiudicare il corretto 
        funzionamento del computer fintanto che questa situazione dura.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Si &egrave; preferito in quest'esempio la chiarezza del codice e la sua 
        semplicit&agrave; al risparmio di istruzioni. Lo stesso codice poteva, 
        infatti, essere rappresentato con circa 11 righe di codice anzich&eacute; 
        le 25 viste sopra.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        18 Novembre 2000</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
