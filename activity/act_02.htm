<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Conversione testo in ottetti per messaggi SMS (prima parte)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Conversione testo in ottetti 
    per messaggi SMS<br>
    (prima&nbsp;parte)<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Marcello 
        Gaidone<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->6 
        Novembre 2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level5.gif" width="17" height="18" align="absmiddle"> 
        5<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p><i>Devo trasformare (ad esempio) la parola <b>hellohello</b> in una stringa 
        formata da 8 bit, in modo da poterla utilizzare per mandare SMS sui cellulari.</i></p>
      <hr>
      <p>Ammetto che questa richiesta mi ha impegnato per almeno un'ora (e un'altra 
        ora aggiuntiva per effettuare alcune correzzioni), ma alla fine siamo 
        riusciti a produrre i risultati voluti. Per effettuare quest'operazione 
        &egrave; necessario conoscere bene i diversi sistemi di numerazione, in 
        particolare la conversione da sistema decimale a sistema binario, per 
        questo motivo le due funzioni di conversioni da un sistema all'altro non 
        verranno approfondite. Per effettuare queste operazioni consultare la 
        sezione <a href="../info/info_03.htm">Informazioni aggiuntive</a>.</p>
      <p>Prima di cominciare dobbiamo prendere coscienza che l'invio di messaggi 
        telefonici pu&ograve; avvenire su qualsiasi piattaforma. Pertanto l'alfabeto 
        da utilizzare non &egrave; il solito charset <a href="../glossary/a.htm#ASCII">ASCII</a>. 
        Esiste un alfabeto apposito che definisce i codici per tutti i simboli 
        utilizzabili in un messaggio SMS. Inseriremo l'intero alfabeto e le formule 
        per trattarlo in un modulo <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
        separato. Purtroppo alcuni simboli non possono essere rappresentati con 
        il charset ASCII e pertanto non saranno convertiti; questi simboli sono 
        alcune lettere greche maiuscole.<br>
        Ulteriori informazioni su questo alfabeto si trovano all'indirizzo <a
        href="http://www.dreamfabric.com/sms/">http://www.dreamfabric.com/sms/</a>.</p>
      <p>L'alfabeto dedicato utilizza una cifra composta da sette bit per la maggior 
        parte dei caratteri. Soltanto 10 caratteri non rientrano in tale range. 
        I caratteri che non rientrano in tale spazio allocato saranno trattati 
        come una coppia di tali valori, pertanto saranno rappresentati da due 
        caratteri. </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>All'interno del primo modulo definiamo le seguenti variabili globali 
        pubbliche:</p>
      <ol class="codicevb" start="1">
        <li>Private LettereAlfabeto(127) As String</li>
        <li>Private ExtraAlfabeto(9) As String</li>
        <li>Private ValoreExtraAlfabeto(9) As Integer</li>
        <li></li>
      </ol>
      <p>Alla riga 1 abbiamo definito un <a href="../glossary/a.htm#ARRAY">array</a> 
        di 128 (ovvero 7 cifre binarie) stringhe compresa quella a posizione zero 
        di nome <b>LettereAlfabeto</b>. Esso conterr&agrave; tutti i caratteri 
        normali composti da un solo carattere.</p>
      <p>Alla riga 2 abbiamo un altro array di 10 stringhe di nome <b>ExtraAlfabeto</b> 
        per contenere i dieci simboli che sono composti da due caratteri. Ad esso 
        si affianca un terzo array di nome <b>ValoreExtraAlfabeto</b>, sempre 
        di 10 elementi, che conterr&agrave; il codice corrispondente al simbolo 
        speciale.</p>
      <p>Tali vettori andranno riempiti (inzializzati) da una funzione apposita. 
        Il suo nome &egrave; <b>InizializzaAlfabeto</b>, dichiarata pubblica. 
        Ne vediamo un pezzetto perch&eacute; &egrave; molto ampia:</p>
      <ol class="codicevb" start="5">
        <li>Public Sub InizializzaAlfabeto()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LettereAlfabeto(0) = &quot;@&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LettereAlfabeto(1) = &quot;&#163;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LettereAlfabeto(2) = &quot;$&quot;</li>
      </ol>
      <p>Seguono i vari simboli...</p>
      <ol class="codicevb" start="144">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LettereAlfabeto(126) = &quot;&uml;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;LettereAlfabeto(127) = &quot;&agrave;&quot;</li>
        <li></li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(0) = vbFormFeed: ValoreExtraAlfabeto(0) 
          = 6922</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(1) = &quot;^&quot;: ValoreExtraAlfabeto(1) 
          = 6932</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(2) = &quot;{&quot;: ValoreExtraAlfabeto(2) 
          = 6952</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(3) = &quot;}&quot;: ValoreExtraAlfabeto(3) 
          = 6953</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(4) = &quot;\&quot;: ValoreExtraAlfabeto(4) 
          = 6959</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(5) = &quot;[&quot;: ValoreExtraAlfabeto(5) 
          = 6972</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(6) = &quot;~&quot;: ValoreExtraAlfabeto(6) 
          = 6973</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(7) = &quot;]&quot;: ValoreExtraAlfabeto(7) 
          = 6974</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(8) = &quot;|&quot;: ValoreExtraAlfabeto(8) 
          = 6976</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ExtraAlfabeto(9) = &quot;&euro;&quot;: ValoreExtraAlfabeto(9) 
          = 7013</li>
        <li>End Sub</li>
      </ol>
      <p>Nelle righe 6-145 abbiamo i 128 simboli standard composti da un solo 
        numero. Il loro numero &egrave; la posizione all'interno dell'array.</p>
      <p>Alle righe 147-156 abbiamo i dieci simboli speciali, composti da due 
        caratteri. Il valore che viene inserito negli elementi di <b>ValoreExtraAlfabeto</b> 
        sono dati dalla concatenazione <a href="../glossary/e.htm#ESADECIMALE">esadecimale</a> 
        dei due simboli separati.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Ad esempio il simbolo <b>&quot;^&quot;</b> si compone dei due caratteri 
        a cui corrispondono i valori esadecimali 1B e 14 ovvero i numeri decimali 
        27 e 20. Concatenando i due valori esadecimali otteniamo il numero esadecimale 
        1B14 ovvero il valore decimale 6932, che abbiamo inserito nell'array <b>ValoreExtraAlfabeto</b>.</p>
      <p>Questo genere di operazione macchinosa si &egrave; resa necessaria per 
        poter distinguere i due bytes di cui si compone ogni simbolo speciale.</p>
      <p>Il modulo si completa con la funzione che si occupa di restituire il 
        codice cui corrisponde ogni simbolo, speciale o non.</p>
      <ol class="codicevb" start="159">
        <li>Public Function TrovaCarattereAlfabeto7(ByVal Carattere As String) 
          As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim Conta As Integer</li>
        <li></li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For Conta = LBound(LettereAlfabeto) To UBound(LettereAlfabeto)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If LettereAlfabeto(Conta) 
          = Carattere Then Exit For</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next Conta</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Conta &gt; UBound(LettereAlfabeto) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For Conta = LBound(ExtraAlfabeto) 
          To UBound(ExtraAlfabeto)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If 
          ExtraAlfabeto(Conta) = Carattere Then Exit For</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next Conta</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Conta &lt;= UBound(ExtraAlfabeto) 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conta 
          = ValoreExtraAlfabeto(Conta)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conta 
          = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TrovaCarattereAlfabeto7 = Conta</li>
        <li>End Function</li>
      </ol>
      <p>La funzione &egrave; denominata <b>TrovaCarattereAlfabeto7</b>, richiede 
        una stringa (il carattere da cercare) e riporta un numero intero corrispondente 
        al codice nell'alfabeto appena visto.</p>
      <p>Alle righe 162-164 effettuiamo un primo controllo dell'alfabeto standard 
        (i 128 elementi) alla ricerca del carattere di cui trovare il codice. 
        Se il codice viene trovato viene forzata l'uscita dal ciclo for (riga 
        163). Pertanto, l'uscita dal ciclo for indicher&agrave; che abbiamo trovato 
        il carattere richiesto oppure che dopo l'intera analisi dell'array <b>LettereAlfabeto</b> 
        il carattere non &egrave; stato trovato. In questo ultimo caso per&ograve;, 
        il valore di Conta sar&agrave; 128 (ovvero un numero superiore alla dimensione 
        dell'array).</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Sfrutteremo pertanto proprio tale valore. Se il valore di <b>Conta</b> 
        &egrave; inferiore o uguale a 127, il valore <b>Conta</b> sar&agrave; 
        il numero che dovremo restituire in uscita alla funzione. Nel caso contrario 
        dovremo controllare il secondo array con i simboli speciali.</p>
      <p>Pertanto alle righe 166-168 effettueremo questo secondo controllo. All'uscita 
        del ciclo Conta avr&agrave; il valore corrispondente alla posizione del 
        carattere speciale nell'array.<br>
        Ecco perch&eacute; alla riga 170 assegniamo a Conta il numero corrispondente 
        nell'array <b>ValoreExtraAlfabeto</b>. Nel caso che il carattere non fosse 
        stato trovato neanche nel secondo alfabeto, cancelleremo il carattere 
        impostando per esso il valore 0.</p>
      <p>La funzione si chiude con la restituzione del numero contenuto in <b>Conta</b>.</p>
      <p>La soluzione, purtroppo &egrave; molto macchinosa, ma l'alfabeto da utilizzare 
        &egrave; molto diverso dall'ASCII utilizzabile sui normali PC.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p align="center"><a href="act_02_2.htm">Segue parte 2 &gt;&gt;</a></p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        7 Novembre 2000<br>
        Corretto il 28 Marzo 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
