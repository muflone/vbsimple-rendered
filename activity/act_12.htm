<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Eseguire un programma esterno</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Eseguire un programma esterno<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Antonio 
        Corrado<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->23 
        Febbraio 2001<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>Vorrei fare in modo che alla pressione di un pulsante venga eseguito 
        un programma .EXE esterno.</i></p>
      <hr>
      <p>L'operazione da svolgere &egrave; molto semplice perch&eacute; Visual 
        Basic provvede nativamente una funzione per richiamare un programma .EXE 
        esterno. La funzione in esame &egrave; <i>Shell</i>.</p>
      <p><img src="../images/activity/att12_01.jpg" width="146" height="82" align="right">Questo 
        progetto si compone di una <i>TextBox</i> <img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
        nome <b>NomeProgramma</b> ed un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>Esegui</b>, con la propriet&agrave; <i>Caption</i> impostata a 
        <i> <b>&quot;Apri il programma indicato&quot;</b></i>.</p>
      <p>La casella di testo dovr&agrave; contenere il percorso completo del programma 
        da eseguire. Il click sopra il pulsante standard richiamer&agrave; la 
        funzione Shell passandole come nome del programma quanto sar&agrave; scritto 
        nella casella di testo soprastante.</p>
      <p>Il codice si compone di una sola routine:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub Esegui_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim Ritorno As Long</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Ritorno = Shell(NomeProgramma.Text, vbNormalFocus)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Ritorno = 0 Then MsgBox &quot;Si &egrave; 
          verificato un errore nell'apertura&quot;, vbCritical + vbOKOnly, &quot;Errore!&quot;</li>
        <li>End Sub</li>
      </ol>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La routine riguarda la pressione del pulsante <b>Esegui</b>.<br>
        Alla riga 4 abbiamo dichiarato una variabile di nome <i><b>Ritorno</b></i>; 
        essa riporter&agrave; il PID (<i>Process IDentifier</i>) del programma 
        eseguito. Esso verr&agrave; utilizzato per verificare se il programma 
        &egrave; stato aperto correttamente.</p>
      <p>Alla riga 5 abbiamo <i><b>dovuto</b></i> inserire una funzione di gestione 
        degli errori. Infatti se l'utente immette un nome di programma errato 
        o non esistente viene generato un errore. Cos&igrave; facendo, in caso 
        di errore l'esecuzione salter&agrave; alla riga successiva all'errore.</p>
      <p>La riga 6 contiene la chiamata alla funzione <i>Shell</i> che richiama 
        un programma esterno. In questo nostro esempio la funzione Shell riceve 
        il testo della propriet&agrave; <i>Text</i> della casella di nome <b>NomeProgramma</b>.<br>
        Al nome del programma segue una costante indicante il tipo di visualizzazione 
        da effettuare; essa pu&ograve; essere una costante dell'<a href="../glossary/e.htm#ENUMERAZIONE">enumerazione</a> 
        <i>VbAppWinstyle</i> ovvero un valore tra i seguenti:</p>
      <ul type="circle">
        <li><b>vbNormalFocus</b><br>
          L'applicazione sar&agrave; aperta normalmente e sar&agrave; mostrata 
          in primo piano.<br>
          <br>
        </li>
        <li><b>vbNormalNoFocus</b><br>
          L'applicazione sar&agrave; aperta normalmente ma non sar&agrave; mostrata 
          in primo piano.<br>
          <br>
        </li>
        <li><b>vbMinimizedNoFocus</b><br>
          L'applicazione sar&agrave; aperta ma sar&agrave; ridotta ad icona nella 
          barra delle applicazioni.<br>
          <br>
        </li>
        <li><b>vbMaximizedFocus<br>
          </b>L'applicazione sar&agrave; aperta in maniera ingrandita e sar&agrave; 
          mostrata in primo piano.<br>
          <br>
        </li>
        <li><b>vbMaximizedNoFocus</b><br>
          L'applicazione sar&agrave; aperta in maniera ingrandita ma non sar&agrave; 
          mostrata in primo piano.<br>
          <b><br>
          </b></li>
        <li><b>vbHide<br>
          </b>L'applicazione verr&agrave; aperta in maniera nascosta (invisibile) 
          all'utente. Non potr&agrave; essere chiusa dall'utente se non mediante 
          l'utilizzo di alcune funzioni <a href="../glossary/a.htm#API">API</a>. 
          Non tutti i programmi supportano questo tipo di apertura.</li>
      </ul>
      <p>La chiamata alla funzione Shell restituisce un valore diverso da 0 se 
        il programma &egrave; stato aperto in maniera corretta, mentre restituisce 
        0 nel caso si fosse verificato qualche problema nell'apertura.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Pertanto, alla riga 7, viene controllato il valore della variabile <b>Ritorno</b> 
        che ha ricevuto il risultato dalla funzione <i>Shell</i>.<br>
        Se il valore contenuto nella variabile <b>Ritorno</b> &egrave; uguale 
        a 0 verr&agrave; mostrato un messaggio di errore che avverte del problema 
        nell'apertura del programma.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il progetto termina qui. L'utilizzo &egrave; di una semplicit&agrave; 
        che non richiede spiegazioni. <img src="../images/icons/smile.gif" width="15" height="15" border="0" align="absmiddle"></p>
      <p>Tuttavia, questa soluzione provvede soltanto l'apertura di un programma 
        e non la sua chiusura. Questa seconda operazione &egrave; molto pi&ugrave; 
        complessa e richiede una differente soluzione nell'apertura. L'apertura 
        e la chiusura di un programma <a href="../howto/ht_032.htm">saranno trattati 
        in un HowTo</a>.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        24 Febbraio 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
