<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Effettuare una connessione ad un database attraverso ADO</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Effettuare una connessione 
    ad un database attraverso ADO<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Rosario 
        Manto<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->7 
        Novembre 2000<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p align="left">Per utilizzare un database all'interno di un progetto Visual 
        Basic &egrave; necessario innanzitutto definire il tipo di interfaccia 
        da utilizzare. Per ogni utilizzo c'&egrave; un'interfaccia che &egrave; 
        <i>migliore</i> di un'altra. Le interfacce rivolte ai dati pi&ugrave; 
        conosciute sono <a href="../glossary/d.htm#DAO">DAO</a> (<a href="../glossary/d.htm#DATAACCESSOBJECT">Data 
        Access Object</a>) e <a href="../glossary/a.htm#ADO">ADO</a> (<a href="../glossary/a.htm#ACTIVEXDATAOBJECTS">ActiveX 
        Data Objects</a>).</p>
      <p align="left">La prima &egrave; un'interfaccia pi&ugrave; vecchia, ma 
        pi&ugrave; robusta e completa.<br>
        La seconda invece &egrave; pi&ugrave; moderna, un po' pi&ugrave; macchinosa, 
        ma permette di utilizzare qualunque fonte dati.</p>
      <p align="left">L'interfaccia DAO &egrave; molto ben documentata nella guida 
        in linea di Visual Basic 5, mentre ADO non &egrave; neanche accennato 
        perch&eacute; uscito dopo la pubblicazione di Visual Basic 5.</p>
      <p align="left">Vedremo quindi come effettuare una connessione a database 
        attraverso ADO. Il database pu&ograve; essere un file sul disco rigido 
        di cui sappiamo il tipo e la posizione oppure un'origine dati <a href="../glossary/d.htm#DSN">DSN</a> 
        di cui sappiamo soltanto il nome.</p>
      <p align="left">In ogni caso all'atto della connessione con ADO dobbiamo 
        conoscere il <b><i><a href="../glossary/p.htm#PROVIDER">Provider</a></i></b> 
        da utilizzare, ovvero la soluzione di accesso al database.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>      <p align="left">Nel nostro esempio faremo una semplice connessione ad un 
        DSN ODBC. Sfrutteremo il DSN DatabaseCDROM che abbiamo creato in un'<a href="act_03.htm">altra 
        richiesta</a>.</p>
      <p align="left">Tutte le connessioni ADO richiedono l'impostazione di una 
        stringa di connessione, un insieme di parametri separati da un punto e 
        virgola. La sintassi tipica di una stringa di connessione &egrave;:</p>
      <blockquote> 
        <p>&quot;Provider=MSDASQL; DRIVER=nomeDriver; DSN=nomeDSN; UID=utente; 
          PWD=password&quot;</p>
      </blockquote>
      <p align="left">Dove Provider=MSDASQL &egrave; il provider utilizzato per 
        accedere ai DSN. Il campo Provider non &egrave; obbligatorio. In sua assenza 
        verr&agrave; usato il valore di default, ovvero <b>MSDASQL</b>. Un altro 
        provider molto comune &egrave; <b>Microsoft.Jet.OLEDB.4.0</b>, utilizzato 
        per accedere a database di Access 2000.</p>
      <p align="left">DRIVER &egrave; il parametro che specifica il nome del driver 
        da utilizzare. Per Access 97 il suo nome &egrave; <b>MS ACCES</b>.</p>
      <p align="left">DSN naturalmente &egrave; il parametro che indica il DSN 
        da aprire. In caso di un DSN su file il parametro si chiamer&agrave; FILEDSN. 
        In taluni casi &egrave; necessario sostituire la parola DSN con DBQ (per 
        le connessioni DSN-less) oppure con Data Source.</p>
      <p align="left">UID indica un nome utente da utilizzare per connettersi 
        al server.<br>
        PWD &egrave; la parola d'ordine corrispondente all'utente specificato 
        in UID.</p>
      <p align="left">Se un database non richiede un nome utente sar&agrave; necessario 
        specificare l'utente ADMIN oppure saltare il parametro.</p>
      <p align="left">Effettuiamo in pratica la connessione al nostro DSN. Abbiamo 
        creato un form ed inserita una ListBox <img src="../images/controls/listbox.gif" width="25" height="25" align="absmiddle"> 
        di nome ListaProgrammi in esso. All'interno della routine Form_Load scriviamo 
        il codice seguente:</p>
      <ol class="codicevb" start="1">
        <li>Dim CONNESSIONE As New ADODB.Connection</li>
        <li>Dim TABELLA As New ADODB.Recordset</li>
        <li>CONNESSIONE.Open &quot;Provider=MSDASQL; Driver=MS Access; DSN=DatabaseCDROM&quot;</li>
        <li>TABELLA.Open &quot;PlayPC&quot;, CONNESSIONE</li>
        <li>While Not TABELLA.Eof</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ListaProgrammi.AddItem TABELLA.Fields(0).Value</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;TABELLA.MoveNext</li>
        <li>Wend</li>
        <li>TABELLA.Close</li>
        <li>CONNESSIONE.Close</li>
        <li>Set TABELLA = Nothing</li>
        <li>Set CONNESSIONE = Nothing</li>
      </ol>
      <p>Le prime due righe dichiarano due variabili: una per la connessione ed 
        una per la tabella (<a href="../glossary/r.htm#RECORDSET">Recordset</a>) 
        da aprire.<br>
        Subito sotto, alla riga 3, abbiamo l'istruzione di apertura di connessione 
        con un DSN.<br>
        La riga successiva dice di aprire la tabella <b>PlayPC</b> dalla connessione.</p>
      <p>Segue un ciclo che si ripete fintanto che la tabella non &egrave; alla 
        fine. EOF indica End Of File, ovvero fine del file.<br>
        All'interno del ciclo c'&egrave; scritto di aggiungere (<i>AddItem</i>) 
        all'interno di ListaProgrammi il valore del primo campo (0) della tabella 
        indicata da TABELLA.<br>
        Compiuta quest'operazione si sposta al record successivo. Questo ciclo 
        continuer&agrave; a ripetersi per ogni singolo record della tabella.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alla fine del ciclo, dobbiamo chiudere la tabella e la connessione, che, 
        altrimenti rimarrebbero aperte, sebbene la vita delle variabili CONNESSIONE 
        e TABELLA si appresta a terminare. Ci rimarrebbero quindi delle risorse 
        bloccate inaccessibili, con un conseguente peggioramento del sistema.</p>
      <p>Nei processi brevi &egrave; bene utilizzare tecniche di questo genere 
        (Apertura - Uso - Chiusura), mentre nei grossi programmi la tecnica da 
        adottare &egrave; quella dell'apertura connessione all'avvio del programma 
        e la chiusura della connessione coincide con la chiusura del programma. 
        Questo permette di risparmiare un po' di tempo negli accessi al database.</p>
      <p>Una volta chiuse tabella e connessione, se siamo sicuri che non ci serviremo 
        pi&ugrave; delle variabili dichiarate, <b>siamo obbligati</b> a deallocare 
        la memoria, ovvero a rendere disponibile la memoria occupata dalle variabili. 
        In mancanza di questo la memoria rimarr&agrave; bloccata nonostante la 
        chiusura del database e della connessione.</p>
      <p>&Egrave; buona regola, in presenza di dichiarazioni dinamiche di oggetti, 
        ricordarsi di deallocare la memoria mediante un'istruzione Set Variabile 
        = Nothing.</p>
      <p>Vediamo il risultato della nostra operazione? Eccolo.</p>
      <p align="center"><img src="../images/activity/att04_01.jpg" width="258" height="265" alt="Figura 1"><br>
        <b>Figura 1</b><br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>L'apertura di una connessione con ADO potr&agrave; sembrare complessa, 
        ma basta conoscere due o tre parametri per avere a disposizione connessioni 
        ai pi&ugrave; disparati database. Infatti, mediante la specifica di Provider 
        e Driver, ADO pu&ograve; aprire ogni tipo di base dati.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        8 Novembre 2000</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
