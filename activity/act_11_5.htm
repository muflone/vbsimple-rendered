<html><!-- #BeginTemplate "/Templates/Richieste.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Generare dei files in base ad un particolare tracciato (quinta parte)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Generare dei files in base 
    ad un particolare tracciato<br>
    (quinta&nbsp;parte)<!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/activity.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Richiesta di: <!-- #BeginEditable "RICHIEDENTE" -->Roberto 
        Corona<!-- #EndEditable --> 
        - <!-- #BeginEditable "DATARICHIESTA" -->12 
        Gennaio 2001<!-- #EndEditable --><br>
        Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level5.gif" width="17" height="18" align="absmiddle"> 
        5<!-- #EndEditable --> / 5 </p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
      <p><i>Ho bisogno di scrivere un programmino che, dopo aver analizzato dei 
        files contenenti dei particolari tracciati, estragga dei dati da un foglio 
        di Excel e tramite questi generi dei files di testo con una particolare 
        struttura determinata dal file del tracciato.</i></p>
      <hr>
      <p align="center"><a href="act_11_4.htm">&lt;&lt; Continua dalla parte 4</a></p>
      <p>Chiarito il funzionamento dell'utility di creazione dei files di definizione, 
        possiamo completare la visione del form <b>MainForm</b>.</p>
      <ol class="codicevb" start="29">
        <li>Private Sub GeneraOutput_Click()</li>
        <li>&nbsp;&nbsp;Dim FILENR As Integer</li>
        <li>&nbsp;&nbsp;Dim BUFFER As String</li>
        <li>&nbsp;&nbsp;Dim SEZIONI As Collection</li>
        <li>&nbsp;&nbsp;Dim TRACCIATO As String</li>
        <li>&nbsp;&nbsp;Dim OGNISEZIONE As Integer</li>
        <li>&nbsp;&nbsp;Dim PRIMORECORD As Boolean</li>
        <li>&nbsp;&nbsp;Dim SEZIONEATTUALE As TIPOSEZIONE</li>
        <li>&nbsp;&nbsp;Dim PUNTOLETTURA As Long</li>
        <li></li>
      </ol>
      <p>La routine legata all'evento Click sul pulsante <b>GeneraOutput</b> &egrave; 
        la pi&ugrave; complessa del form. Sar&agrave; necessario infatti, leggere 
        il file del tracciato, il file di definizione e scrivere il file di output.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Per semplificare un po' le cose memorizzeremo tutte le sezioni in una 
        <i>Collection</i> <b>SEZIONI</b> ed il tracciato in una variabile di nome 
        <b>TRACCIATO</b>. Sar&agrave; necessaria anche una variabile di nome <b>PRIMORECORD</b> 
        per indicare la lettura del primo record del foglio Excel, allo scopo 
        di scrivere quelle righe fisse, che andranno scritte solo una volta.</p>
      <ol class="codicevb" start="39">
        <li>&nbsp;&nbsp;On Error GoTo ERRORE</li>
        <li>&nbsp;&nbsp;If FileEsiste(DatiInputText.Text) = False Then Exit Sub</li>
        <li>&nbsp;&nbsp;If FileEsiste(TracciatoText.Text) = False Then Exit Sub</li>
        <li>&nbsp;&nbsp;If FileEsiste(DefinizioneText.Text) = False Then Exit 
          Sub</li>
        <li>&nbsp;&nbsp;If Len(Trim(NomeFoglioText.Text)) = 0 Then Exit Sub</li>
        <li>&nbsp;&nbsp;If FileEsiste(OutputText.Text) = True Then Exit Sub</li>
        <li></li>
      </ol>
      <p>Prima di iniziare l'elaborazione ci assicuriamo che i file di input, 
        il file del tracciato ed il file di definizione esistano (righe 40-42); 
        inoltre controlleremo che sia stato inserito il nome del foglio Excel 
        e che il file di output non esista (righe 43-44). Infatti la scrittura 
        del file di output non avverr&agrave; se una di queste condizioni non 
        si verifica.</p>
      <ol class="codicevb" start="46">
        <li>&nbsp;&nbsp;Set SEZIONI = New Collection</li>
        <li></li>
        <li>&nbsp;&nbsp;FILENR = FreeFile</li>
        <li>&nbsp;&nbsp;Open DefinizioneText.Text For Input As FILENR</li>
        <li>&nbsp;&nbsp;Input #FILENR, BUFFER</li>
        <li>&nbsp;&nbsp;If UCase(Left(BUFFER, 19)) &lt;&gt; &quot;FIBIA DATA STRIPPER&quot; 
          Then Exit Sub</li>
        <li>&nbsp;&nbsp;While Not EOF(FILENR)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Input #FILENR, BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;SEZIONI.Add BUFFER</li>
        <li>&nbsp;&nbsp;Wend</li>
        <li>&nbsp;&nbsp;Close FILENR</li>
        <li>&nbsp;&nbsp;OrdinaSezioni SEZIONI</li>
        <li></li>
      </ol>
      <p>Come prima operazione prepareremo la <i>Collection</i> <b>SEZIONI</b> 
        istanziando la classe (riga 46), aprendo il file (righe 48-49), controllando 
        che l'intestazione del file sia valida (riga 51) e leggendo una per una 
        le sezioni dal file di definizione, memorizzandole nella Collection (righe 
        52-55). Al termine della lettura, le sezioni saranno ordinate (riga 57).</p>
      <ol class="codicevb" start="59">
        <li>&nbsp;&nbsp;FILENR = FreeFile</li>
        <li>&nbsp;&nbsp;Open TracciatoText.Text For Binary As FILENR</li>
        <li>&nbsp;&nbsp;TRACCIATO = Space(LOF(FILENR))</li>
        <li>&nbsp;&nbsp;Get #FILENR, , TRACCIATO</li>
        <li>&nbsp;&nbsp;Close FILENR</li>
        <li></li>
      </ol>
      <p>Fatto questo passeremo alla lettura del file di tracciato. Tale lettura 
        avverr&agrave; in una istruzione, preparando prima il buffer <b>TRACCIATO</b> 
        (riga 61) e poi leggendo l'intero file.</p>
      <ol class="codicevb" start="65">
        <li>&nbsp;&nbsp;SEZIONEATTUALE.INIZIO = Len(TRACCIATO) + 10</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.FINE = Len(TRACCIATO) + 10</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.CAMPO = 0</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.RIGAFISSA = 0</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.LUNGHEZZAFISSA = 0</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.ALLINEAMENTO = 0</li>
        <li>&nbsp;&nbsp;SEZIONEATTUALE.FILLER = &quot;0&quot;</li>
        <li>&nbsp;&nbsp;SEZIONI.Add Sezione2Riga(SEZIONEATTUALE)</li>
        <li></li>
      </ol>
      <p>Aggiungeremo anche una SEZIONE finta alla <i>Collection</i> delle sezioni 
        per effettuare le corrette operazioni di posizione. Tale sezione infatti 
        sar&agrave; 10 caratteri pi&ugrave; ampia del file tracciato, avendo cos&igrave; 
        la sicurezza che ogni altra sezione sar&agrave; minore di quella inserita 
        per ultima.</p>
      <ol class="codicevb" start="74">
        <li>&nbsp;&nbsp;FILENR = FreeFile</li>
        <li>&nbsp;&nbsp;Open OutputText.Text For Binary As FILENR</li>
        <li>&nbsp;&nbsp;If FILEXLS Is Nothing Then Set FILEXLS = OpenDatabase(DatiInputText.Text, 
          0, 0, &quot;Excel 5.0&quot;)</li>
        <li>&nbsp;&nbsp;If FOGLIOXLS Is Nothing Then Set FOGLIOXLS = FILEXLS.OpenRecordset(NomeFoglioText.Text 
          &amp; &quot;$&quot;)</li>
        <li>&nbsp;&nbsp;FOGLIOXLS.MoveFirst</li>
        <li>&nbsp;&nbsp;PRIMORECORD = True</li>
      </ol>
      <p>Prima di entrare nel ciclo di generazione del file di output preparemo 
        i file, effettuando l'apertura del file di output (righe 74-75), e del 
        file e foglio di Excel (se essi non sono stati gi&agrave; aperti dall'utility 
        di definizione), lo spostamento sulla prima riga e l'inizializzazione 
        della variabile <b>PRIMORECORD</b> (righe 76-79).</p>
      <ol class="codicevb" start="80">
        <li>&nbsp;&nbsp;While Not FOGLIOXLS.EOF</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PUNTOLETTURA = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For OGNISEZIONE = 1 To SEZIONI.Count</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Riga2Sezione SEZIONI.Item(OGNISEZIONE), 
          SEZIONEATTUALE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = &quot;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If SEZIONEATTUALE.INIZIO &gt; 
          0 Then BUFFER = Mid(TRACCIATO, PUNTOLETTURA + 1, SEZIONEATTUALE.INIZIO 
          - PUNTOLETTURA)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put #FILENR, , BUFFER</li>
      </ol>
      <p>Per ogni record del foglio Excel sar&agrave; necessario leggere l'intero 
        file tracciato e tutte le sezioni, e man mano, scrivere quei segmenti 
        del file tracciato che non sono sezioni o meglio dire quelle parti del 
        tracciato che precedono l'inizio di una sezione, a partire dal punto di 
        lettura (righe 83-86).</p>
      <ol class="codicevb" start="87">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If (SEZIONEATTUALE.RIGAFISSA = 
          1) Imp (PRIMORECORD = True) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = Mid(TRACCIATO, 
          SEZIONEATTUALE.INIZIO + 1, SEZIONEATTUALE.FINE - SEZIONEATTUALE.INIZIO 
          + 1)</li>
      </ol>
      <p>Quella che vediamo alla riga 87 &egrave; un'operazione di implicazione 
        logica tra due valori. Per molti programmatori potrebbe sembrare un'operazione 
        nuova, non applicabile ad altri linguaggi direttamente. Per ulteriori 
        informazioni sull'operazione di implicazione logica controllare la pagina 
        dedicata alle <a href="../info/info_06.htm">informazioni aggiuntive sull'algebra 
        booleana</a>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Nel nostro caso verranno eseguite le operazioni all'interno del ciclo 
        IF quando la sezione in analisi non tratta una riga fissa e non ci troviamo 
        in presenza del primo record, ma verr&agrave; eseguita ogni volta che 
        la sezione non &egrave; una riga fissa.</p>
      <p>Cos&igrave;, leggeremo il testo dal file tracciato corrispondente alla 
        sezione in analisi e lo memorizzeremo nella variabile BUFFER (riga 88).</p>
      <ol class="codicevb" start="89">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If SEZIONEATTUALE.LUNGHEZZAFISSA 
          = 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If SEZIONEATTUALE.CAMPO 
          &gt; 0 Then BUFFER = FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value</li>
      </ol>
      <p>Se la sezione in analisi non &egrave; a lunghezza fissa baster&agrave; 
        sostituire le &quot;XXX&quot; della sezione (variabile BUFFER) con il 
        contenuto del campo associato</p>
      <ol class="codicevb" start="91">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If SEZIONEATTUALE.ALLINEAMENTO 
          = 1 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If 
          Len(BUFFER) &gt; Len(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value) 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER 
          = String(Len(BUFFER) - Len(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value), 
          SEZIONEATTUALE.FILLER) &amp; Left(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO 
          - 1).Value &amp; &quot;&quot;, Len(BUFFER))</li>
      </ol>
      <p>Se invece la sezione &egrave; a lunghezza fissa sar&agrave; necessario 
        verificare se il dato estratto dal tracciato &egrave; maggiore del dato 
        estratto dal foglio Excel. In questo caso sar&agrave; necessario controllare 
        l'allineamento che i dati devono avere. Se l'allineamento &egrave; a sinistra, 
        saranno riempiti gli spazi mancanti sulla destra con il carattere specificato 
        nel campo <b>FILLER</b> della sezione.</p>
      <ol class="codicevb" start="95">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER 
          = Left(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value &amp; &quot;&quot;, 
          Len(BUFFER))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End 
          If</li>
      </ol>
      <p>Se invece la lunghezza dei dati &egrave; minore o uguale alla lunghezza 
        dei dati estratti dal foglio di Excel, non sar&agrave; necessaria alcuna 
        operazione; baster&agrave; leggere tanti caratteri per quanto ampia &egrave; 
        la sezione (riga 96).</p>
      <ol class="codicevb" start="98">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If 
          Len(BUFFER) &gt; Len(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value) 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER 
          = Left(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value &amp; &quot;&quot;, 
          Len(BUFFER)) &amp; String(Len(BUFFER) - Len(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO 
          - 1).Value), SEZIONEATTUALE.FILLER)</li>
      </ol>
      <p>Invece, se l'allineamento dei dati &egrave; a sinistra, dovremo controllare 
        la lunghezza dei dati; se la lunghezza della sezione &egrave; maggiore 
        della lunghezza dei dati, riempiremo lo spazio di differenza inserendo 
        a destra il carattere specificato nel campo <b>FILLER</b> della sezione.</p>
      <ol class="codicevb" start="101">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER 
          = Left(FOGLIOXLS.Fields(SEZIONEATTUALE.CAMPO - 1).Value &amp; &quot;&quot;, 
          Len(BUFFER))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End 
          If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put #FILENR, , BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUNTOLETTURA = SEZIONEATTUALE.FINE 
          + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next OGNISEZIONE</li>
      </ol>
      <p>Se invece la lunghezza non &egrave; maggiore della lunghezza dei dati 
        baster&agrave; estrarre tanti caratteri dal foglio Excel per quanto &egrave; 
        ampia la sezione.</p>
      <p>Una volta preparati i dati che sostituiranno le &quot;XXX&quot; della 
        sezione, potremo andare a scrivere i dati nel file di output (riga 106) 
        ed incrementare la posizione di lettura del file tracciato, per permettere 
        l'analisi delle altre sezioni.</p>
      <ol class="codicevb" start="110">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;FOGLIOXLS.MoveNext</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PRIMORECORD = False</li>
        <li>&nbsp;&nbsp;Wend</li>
      </ol>
      <p>Terminata la scansione di tutte le sezioni, si passer&agrave; alla riga 
        successiva del foglio di Excel, ed imposteremo anche il valore della variabile 
        <b>PRIMORECORD</b> a False. In tal modo, tutte le sezioni fisse non saranno 
        riscritte, ma verranno evitate completamente.</p>
      <p>Questa serie di cicli analizzer&agrave; tutte le righe del foglio di 
        Excel e per ogni riga effettuer&agrave; le sostituzioni per tutte le sezioni.</p>
      <ol class="codicevb" start="113">
        <li>&nbsp;&nbsp;FOGLIOXLS.Close</li>
        <li>&nbsp;&nbsp;FILEXLS.Close</li>
        <li>&nbsp;&nbsp;Set FOGLIOXLS = Nothing</li>
        <li>&nbsp;&nbsp;Set FILEXLS = Nothing</li>
        <li>&nbsp;&nbsp;Close FILENR</li>
        <li>&nbsp;&nbsp;Set SEZIONI = Nothing</li>
        <li>&nbsp;&nbsp;MsgBox &quot;Generazione file di output completata!&quot;, 
          vbInformation + vbOKOnly, &quot;Genera output&quot;</li>
        <li>&nbsp;&nbsp;Exit Sub</li>
        <li>ERRORE:</li>
        <li>&nbsp;&nbsp;On Error Resume Next</li>
        <li>&nbsp;&nbsp;MsgBox &quot;Si &egrave; verificato un errore.&quot;, 
          vbCritical + vbOKOnly, &quot;Genera output&quot;</li>
        <li>&nbsp;&nbsp;Set SEZIONI = Nothing</li>
        <li>&nbsp;&nbsp;If FreeFile &gt; FILENR Then Close FILENR</li>
        <li>&nbsp;&nbsp;Set FOGLIOXLS = Nothing</li>
        <li>&nbsp;&nbsp;Set FILEXLS = Nothing</li>
        <li>End Sub</li>
      </ol>
      <p>Finite le righe del foglio Excel potremo andare a chiudere il foglio, 
        il database Excel, deallocare le variabili, chiudere il file di output, 
        svuotare la Collection e completare l'operazione di generazione del file 
        di output con una finestrella che informa dell'avvenuta elaborazione (righe 
        113-120).</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Ogni errore nella generazione del file di output porter&agrave; la visualizzazione 
        di un messaggio di errore e la chiusura dei vari files.</p>
      <p>Le operazioni viste non sono molto complesse, ma le istruzioni per effettuarle 
        sono parecchio complicate. Si consiglia pertanto di effettuare un'operazione 
        di traccia passo passo durante l'elaborazione del file di output.</p>
      <p><img src="../images/activity/att11_06.jpg" width="203" height="174" alt="Figura 1" align="right">La 
        prova del progetto mostrer&agrave; il form principale. Prima di provare 
        la generazione del file di output sar&agrave; necessario avere almeno 
        un file di definizione per il tracciato scelto.</p>
      <p>Pertanto, dopo aver inserito i dati del file di input, il nome del foglio 
        Excel ed il percorso del file tracciato, possiamo premere il pulsante 
        <i> <b>Crea Definizione</b></i>.</p>
      <p>Sar&agrave; richiamata l'utility per la definizione del file di definizione 
        del tracciato, con estensione .FDF.<br>
        Una volta creato tale file, si potr&agrave; completare il processo di 
        generazione del file di output.</p>
      <p align="center"><img src="../images/activity/att11_03.jpg" width="378" height="262" alt="Figura 2"><br>
        <b>Figura 2</b></p>
      <p>La finestra dell'utility di definizione del file tracciato apparir&agrave; 
        come quella mostrata nella figura 2. Baster&agrave; selezionare dei segmenti 
        del testo dalla finestra posta nella parte superiore, scegliere le impostazioni 
        per la sezione dalla parte centrale del form, ed aggiungere ogni volta 
        una sezione per il segmento selezionato.</p>
      <p><img src="../images/activity/att11_04.jpg" width="290" height="116" align="right" alt="Figura 3">Alla 
        fine della preparazione delle sezioni baster&agrave; premere il pulsante 
        Crea Definizione per generare il file FDF scelto nella finestra che richiede 
        il nome del file in cui salvare la definizione.</p>
      <p>Ricordiamo che il salvataggio non effettua alcuna sovrascrittura dei 
        files; pertanto &egrave; necessario che il file con cui si tenta il salvataggio 
        non esista.</p>
      <p><img src="../images/activity/att11_05.jpg" width="290" height="116" align="right" alt="Figura 4">Se 
        vogliamo richiamare un file di definizione tracciato salvato in precenza 
        con quest'utility baster&agrave; specificare la posizione del file FDF 
        da caricare.</p>
      <p>Automaticamente saranno create le sezioni per tale file e sar&agrave; 
        possibile aggiungere o eliminare sezioni a seconda delle necessit&agrave;. 
        Alla fine dell'operazione per&ograve;, sar&agrave; necessario salvare 
        il file con un altro nome, per i motivi accennati prima.</p>
      <p><img src="../images/activity/att11_06.jpg" width="203" height="174" align="right" alt="Figura 5">Terminate 
        le operazioni riguardanti i files di definizione del tracciato, possiamo 
        tornare al nostro form principale, chiudendo l'utility di definizione 
        dei tracciati, oppure premendo in essa il pulsante <b><i>&quot;Chiudi&quot;</i></b>.</p>
      <p>Possedendo adesso il nostro file FDF possiamo lanciare l'elaborazione 
        e la generazione del file output per i dati inseriti nel nostro form.</p>
      <p>Baster&agrave; premere il pulsante <i><b>&quot;Genera output&quot;</b></i> 
        per avviare l'elaborazione.</p>
      <p><img src="../images/activity/att11_07.jpg" width="203" height="95" align="right" alt="Figura 6">Se 
        l'elaborazione procede senza errori, apparir&agrave; una finestra di informazioni 
        che avverte che la generazione del file di output &egrave; completata.</p>
      <p>La mancata apparizione di questa finestra indica che almeno un dato nel 
        form principale &egrave; errato. Controllare pertanto i dati inseriti 
        e riprovare a lanciare la generazione del file di output.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il programma, giunto alla fine, &egrave; abbastanza complesso e richiede 
        uno studio approfondito per carpirne a fondo il funzionamento.</p>
      <p>Pu&ograve; essere uno spunto per effettuare operazioni sui files, in 
        lettura e in scrittura, per effettuare un buon <a href="../glossary/p.htm#PARSING">parsing</a> 
        (analisi di un file) e per effettuare una semplice connessione ad un database 
        mediante l'utilizzo di un driver <a href="../glossary/i.htm#ISAM">ISAM</a>.</p>
      <!-- #EndEditable --><!-- #BeginEditable "CREDITS" --> 
      <p align="right" class="credits2"><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        27 Gennaio 2001</p>
      <!-- #EndEditable --><!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'introduzione delle Richieste dei lettori</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
