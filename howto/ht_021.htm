<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Cambiare lo sfondo del desktop di Windows</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Cambiare lo sfondo del desktop 
    di Windows<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Cambiare lo sfondo del desktop di Windows attraverso un programma Visual 
        Basic &egrave; un'operazione semplicissima. Esiste infatti una funzione 
        <a href="../glossary/a.htm#API">API</a> che permette l'impostazione di 
        valori di sistema, quale lo sfondo del desktop.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>In questo progettino non utilizzeremo alcun form. All'avvio del programma 
        verr&agrave; cambiato lo sfondo del desktop e l'esecuzione terminer&agrave; 
        subito dopo.</p>
      <p>Abbiamo, per cui, bisogno di un progetto senza forms. Creato un progetto 
        <img src="../images/ide/progetto.gif" width="16" height="16" align="absmiddle"> 
        standard, &egrave; necessario rimuovere il form: selezionare il form da 
        rimuovere e cliccare la voce <i><b>Rimuovi Form1.frm</b></i> dal menu 
        <b>Progetto</b>.</p>
      <p>Al posto del form inseriremo un <a href="../glossary/m.htm#MODULO">modulo</a> 
        standard <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
        tramite la voce <b><i>Inserisci modulo</i></b> dal menu <b>Progetto</b>.</p>
      <p>Creato il modulo, inseriamo il codice seguente:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li>Private Declare Function SystemParametersInfo Lib &quot;user32&quot; 
          Alias &quot;SystemParametersInfoA&quot; (ByVal uAction As Long, ByVal 
          uParam As Long, lpvParam As Any, ByVal fuWinIni As Long) As Long</li>
        <li>Private Const SPI_SETDESKWALLPAPER = 20</li>
        <li>Private Const SPIF_UPDATEINIFILE = &amp;H1</li>
        <li>Private Const NOMESFONDO = &quot;SFONDO1.BMP&quot;</li>
        <li></li>
      </ol>
      <p>Alla riga 2 appare la dichiarazione della funzione <i>SystemParametersInfo</i> 
        che verr&agrave; utilizzata per cambiare lo sfondo del desktop di Windows. 
        Essa richiede 4 parametri: <i>uAction</i> definisce il tipo di operazione 
        da effettuare - nel nostro caso il cambiamento del desktop di Windows 
        - i cui valori sono definiti nelle <a href="../glossary/c.htm#COSTANTE">costanti</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" border="0" align="absmiddle"> 
        API alle voci <b>SPI_</b>; <i>uParam</i> &egrave; un parametro aggiuntivo 
        all'operazione uAction; <i>lpvParam</i> &egrave; un parametro specifico 
        per l'operazione da effettuare, e in genere indica il nome di un file 
        da utilizzare - nel nostro caso sar&agrave; il percorso dello sfondo da 
        applicare - ed infine l'ultimo parametro &egrave; <i>fuWinIni</i> che 
        indica la modalit&agrave; di notifica di tali cambiamenti al sistema e 
        i suoi valori si trovano come costanti API alle voci <b>SPIF_</b>.</p>
      <p>Alla riga 3 abbiamo definito l'operazione da effetture: <b>SPI_SETDESKWALLPAPER</b> 
        ovvero impostare lo sfondo del desktop. Alla riga 4 invece abbiamo la 
        modalit&agrave; di aggiornamento dei dati, mediante costante <b>SPIF_UPDATEINIFILE</b>, 
        che aggiorna il contenuto del file <i><b>Win.ini</b></i> e comunica al 
        sistema il cambiamento, applicando subito le modifiche.</p>
      <p>Alla riga 5, abbiamo definito la costante NOMESFONDO che indica il nome 
        del file immagine dello sfondo da applicare. Tale file deve essere presente 
        nella stessa cartella del programma. Nel nostro esempio l'immagine si 
        chiamer&agrave; <b><i>SFONDO1.BMP</i></b>, un semplice paesaggio (generato 
        da me con un semplice programmino parecchi anni fa ^__^).</p>
      <p>Naturalmente sar&agrave; possibile cambiare l'immagine. La nostra immagine 
        &egrave; scaricabile tramite <a href="../dativari/ht_021dat.zip">questo 
        collegamento</a>; una volta scaricata dovr&agrave; essere scompattata 
        nella stessa cartella del programma tramite WinZip o programmi analoghi.</p>
      <ol class="codicevb" start="7">
        <li>Private Sub Main()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PATHSFONDO As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;PATHSFONDO = App.Path &amp; &quot;\&quot; 
          &amp; NOMESFONDO</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;SystemParametersInfo ByVal SPI_SETDESKWALLPAPER, 
          ByVal 0&amp;, ByVal PATHSFONDO, SPIF_UPDATEINIFILE</li>
        <li>End Sub</li>
      </ol>
      <p>Nello stesso modulo abbiamo definito la Sub Main. Essa infatti funge 
        da modalit&agrave; di avvio in mancanza di un form specifico. Per saperne 
        di pi&ugrave; sulle modalit&agrave; di avvio di un progetto vedi la sezione 
        <a href="../info/info_11.htm">Informazioni aggiuntive sulle modalit&agrave; 
        di avvio</a>.</p>
      <p>La funzione sub si compone di tre semplici righe: la riga 8 definisce 
        una variabile di appoggio di nome <b>PATHSFONDO</b>. Essa conterr&agrave; 
        il percorso completo del file immagine da utilizzare come sfondo.<br>
        Infatti, alla riga 9, abbiamo questa impostazione, mediante congiunzione 
        della cartella del programma e della costante NOMESFONDO.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alla riga 10 abbiamo la chiamata alla funzione <i>SystemParametersInfo</i>, 
        per effettuare il cambiamento dello sfondo del desktop. La chiamata viene 
        eseguita passando come parametri la costante <i>SPI_SETDESKWALLPAPER</i> 
        che indica il cambiamento dello sfondo; il secondo parametro contiene 
        uno zero perch&eacute; questo parametro non &egrave; necessario per l'operazione 
        che stiamo effettuando; il terzo parametro conterr&agrave; il percorso 
        del file immagine da impostare, ovvero la variabile <i>PATHSFONDO</i>; 
        l'ultimo parametro &egrave; la modalit&agrave; di aggiornamento, costante 
        <i>SPIF_UPDATEINIFILE</i>. </p>
      <p>Il programma, subito dopo l'esecuzione della riga 10 si chiude, senza 
        richiedere nessuna interazione da parte dell'utente.</p>
      <p>Per eseguire questo progetto sar&agrave; necessario impostare la sub 
        Main come oggetto di avvio, tramite la voce <i><b>Propriet&agrave; progetto</b></i> 
        dal menu <b>Progetto</b>.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Naturalmente si consiglia di non abusare di questa funzione perch&eacute; 
        lo sfondo del desktop di Windows viene scelto dall'utente e sar&agrave; 
        la schermata principale che egli vedr&agrave; ad ogni utilizzo del computer.</p>
      <p>Quindi, prima di eseguire quest'operazione, chiedete sempre il permesso 
        all'utente, mediante la visualizzazione di una videata di richiesta tramite 
        una MessageBox.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=16">Daniel</a> 
        e <a href="../vbmail.htm?id=1">Fibia FBI</a><br>
        18 Gennaio 2001<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
