<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Scorrere orizzontalmente una ListBox</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Scorrere orizzontalmente 
    una ListBox<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Quante volte vi sar&agrave; capitata lo sgradevole comportamento dei 
        controlli ListBox che presentano soltanto la barra di scorrimento verticale 
        per visualizzare le righe che rientrano nell'area visibile del controllo; 
        manca infatti del tutto la barra di scorrimento orizzontale, ad esempio 
        per scorrere verso destra la visuale e mostrare ci&ograve; che va oltre 
        l'area visibile determinata dalla larghezza della ListBox.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Non esiste alcuna propriet&agrave; del controllo per abilitare le barre 
        di scorrimento orizzontali ma basta una semplice chiamata ad una funzione 
        dell'<a href="../glossary/a.htm#API">API</a> per estendere l'area del 
        controllo e quindi scorrere verso destra il resto del testo. Pi&ugrave; 
        precisamente dovremo inviare il <a href="../glossary/m.htm#MESSAGGIO">messaggio</a> 
        <i> <b>LB_SETHORIZONTALEXTENT</b></i> e specificare la larghezza in pixel 
        dell'area da scorrere.</p>
      <p>Questa soluzione si presenta cos&igrave; facile che mi si &egrave; presentato 
        il dubbio sulla necessit&agrave; di pubblicare una soluzione al problema. 
        <img src="../images/smiley/big.gif" width="15" height="15" align="absmiddle"></p>
      <p><img src="../images/howto/howto060_1.png" width="154" height="118" align="right" alt="Figura 1">Per 
        questo progetto di esempio poseremo sopra un form un controllo <i>ListBox</i><img src="../images/controls/listbox.gif" width="25" height="25" align="absmiddle"> 
        di nome <b>lbElenco</b> ed un controllo <i>TextBox</i> <img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle"> 
        di nome <b>txtTesto</b> e gestiremo l'evento KeyPress e verificare se 
        &egrave; stato premuto Enter. Ci&ograve; che stiamo sostanzialmente aggiungendo 
        &egrave; la semplice possibilit&agrave; di inserire dati in una ListBox 
        a scelta dell'utente. Ad ogni inserimento ricalcoleremo la larghezza massima 
        necessaria per visualizzare tutto il testo.</p>
      <p>Senza una gestione della larghezza il testo apparirebbe come nella figura 
        mostrata a fianco, mozzato e impossibile da scorrere verso destra. Il 
        codice si compone di due sole routine:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Const LB_SETHORIZONTALEXTENT = &amp;H194</li>
        <li></li>
        <li>Private Declare Function SendMessage Lib &quot;USER32&quot; Alias 
          &quot;SendMessageA&quot; (ByVal hWnd As Long, ByVal wMsg As Long, ByVal 
          wParam As Long, lParam As Any) As Long</li>
        <li></li>
        <li>Private Sub txtTesto_KeyPress(KeyAscii As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If KeyAscii = vbKeyReturn Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lbElenco.AddItem txtTesto.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBoxAutoScroll 
          lbElenco</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Il codice non dovrebbe richiedere alcun commento fin qui; nel caso venisse 
        premuto il pulsante Enter all'interno della casella di testo, sar&agrave; 
        inserito il testo della casella all'interno dell'elenco e verr&agrave; 
        quindi richiamata la funzione <b>ListBoxAutoScroll</b> che vediamo qui 
        subito esposta:</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <ol start="14" class="codicevb">
        <li>Private Sub ListBoxAutoScroll(ByRef LB As ListBox)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim lngLarghezza As Long</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim lngMax As Long</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim intLoop As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set Me.Font = LB.Font</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For intLoop = 0 To LB.ListCount - 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lngLarghezza = Me.TextWidth(LB.List(intLoop))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If lngLarghezza > 
          lngMax Then lngMax = lngLarghezza</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next intLoop</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;lngMax = IIf(lngMax <= LB.Width, 0, lngMax 
          + Me.ScaleX(12, vbPixels, vbTwips))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;lngMax = Me.ScaleX(lngMax, vbTwips, vbPixels)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call SendMessage(LB.hWnd, LB_SETHORIZONTALEXTENT, 
          lngMax, ByVal 0&)</li>
        <li>End Sub</li>
      </ol>
      <p>La routine <b>ListBoxAutoScroll</b> sostanzialmente calcola la larghezza 
        massima necessaria per visualizzare completamente il testo; per far ci&ograve; 
        effettua un ciclo su tutti gli elementi della ListBox (righe 19-22) ed 
        ogni volta estrae la larghezza del testo di ogni riga; per far ci&ograve; 
        utilizza la funzione <i>TextWidth</i>, che fra l'altro per operare correttamente 
        necessita che il carattere utilizzato dal form sia lo stesso di quello 
        usato nel controllo contenente il testo e pertanto vi abbiamo assegnato 
        lo stesso font (riga 18).</p>
      <p>Di volta in volta la nuova larghezza, se superiore a quella indicata 
        in <b>lngMax</b> prender&agrave; il posto di quest'ultima; in tal modo 
        all'uscita del ciclo avremo all'interno di lngMax la larghezza della riga 
        con il testo pi&ugrave; lungo. Tuttavia questo dato &egrave; rappresentato 
        nell'unit&agrave; di misura preferita di Visual Basic, i twips.</p>
      <p>Alla riga 23 &egrave; verificato che la nuova larghezza sia superiore 
        alla larghezza dell'intera ListBox; se non dovesse esserlo il valore di 
        lngMax verr&agrave; azzerato; in caso contrario saranno aggiunti 12 pixel 
        (convertiti da pixel a twips mediante <b>ScaleX</b> gi&agrave; trattata 
        in <a href="ht_046.htm">un altro articolo di questa sezione</a>) ed infine 
        l'intero valore di lngMax verr&agrave; riconvertito in pixel, l'unit&agrave; 
        di misura richiesta dalle funzioni dell'API.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Al termine di questa operazione lngMax conterr&agrave; il valore 0 oppure 
        la larghezza in pixel del testo pi&ugrave; lungo dell'elenco. Questo valore 
        verr&agrave; utilizzato per specificare la nuova larghezza virtuale dell'area 
        della ListBox e per far ci&ograve; invieremo il messaggio <i><b>LB_SETHORIZONTALEXTENT</b></i> 
        alla ListBox, come indicato alla riga 25.</p>
      <table width="80%" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td align="center" valign="top"><img src="../images/howto/howto060_1.png" width="154" height="118" alt="Figura 2"><br>
            <b>Figura 2</b></td>
          <td align="center" valign="top"><img src="../images/howto/howto060_2.png" width="154" height="118" alt="Figura 3"><br>
            <b>Figura 3</b></td>
          <td width="33%" valign="top" align="center"><img src="../images/howto/howto060_3.png" width="154" height="118" alt="Figura 4"><br>
            <b>Figura 4</b></td>
        </tr>
      </table>
      <p>Nella Figura 2 &egrave; mostrato nuovamente il testo come apparirebbe 
        se non avessimo usato la nostra funzione <b>ListBoxAutoScroll</b>; le 
        figure 3 e 4 mostrano invece la nuova situazione, il testo inserito supera 
        la larghezza dell'elenco ed in basso appare la barra di scorrimento orizzontale. 
        Scorriamo il testo fino all'estrema destra e possiamo notare come l'area 
        di scorrimento coincida con la larghezza del testo (pi&ugrave; i 12 pixel 
        che abbiamo aggiunto per non far sembrare il tutto allineato al bordo).<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Una soluzione facile, veloce e abbastanza sicura per un problema noioso 
        che avrebbe richiesto una propriet&agrave; nativa dei controlli ListBox. 
      </p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        29 Marzo 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
