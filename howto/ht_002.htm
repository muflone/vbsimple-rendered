<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Creare una casella di testo con selezione automatica</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Creare una casella di testo 
    con selezione automatica<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <ul>
        <li><a href="ht_002.htm#STEP1">Una semplice TextBox con selezione automatica</a>.</li>
        <li><a href="ht_002.htm#STEP2">Pi&ugrave; TextBox autoselezionanti in 
          una matrice di controlli</a>.</li>
        <li><a href="ht_002.htm#STEP3">Implementazione della classe AutoSelTextBox</a>.</li>
        <li><a href="ht_002.htm#STEP4">Una soluzione un po' rustica</a>.</li>
      </ul>
      <hr>
      <p align="center" class="size3"> <a name="STEP1"></a>Una semplice TextBox 
        con selezione automatica</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2 / 5</p>
      <p>Sicuramente avrete visto in vari programmi che, non appena una casella 
        diventa l'oggetto attivo, il testo all'interno d'essa viene automaticamente 
        selezionato, in modo che alla digitazione di un numero o una lettera il 
        contenuto precedente scompaia.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Trasformare una casella di testo semplice in una autoselezionante &egrave; 
        molto semplice. La soluzione sta nell'intercettare il momento in cui la 
        casella di testo diventa l'oggetto attivo. Per questo scopo possiamo usare 
        l'<a href="../glossary/e.htm#EVENTO">evento</a> <i>GotFocus</i>.</p>
      <p>Nel momento in cui la casella di testo esegue quell'evento dobbiamo dirgli 
        di selezionare tutto il testo all'interno d'essa. Per fare questo useremo 
        due propriet&agrave; dell'oggetto TextBox: <b>SelStart</b> e <b>SelLength</b>. 
        La prima indica la posizione, all'interno della stringa, del carattere 
        che sta all'inizio della selezione. La seconda propriet&agrave; indica 
        il numero di caratteri selezionati partendo da SelStart verso destra.</p>
      <p>Per cui per selezionare tutto il testo della casella, portare la selezione 
        iniziale (SelStart) a 0 e la lunghezza della selezione (SelLength) uguale 
        alla lunghezza della propriet&agrave; Text.</p>
      <p>Inseriamo una casella di testo di nome <b>Text1</b> sopra un form, apriamo 
        la finestra del codice alla routine legata all'evento <i>GotFocus</i> 
        dell'oggetto Text1 e scriviamo queste due semplici righe:</p>
      <ol class="codicevb" start="1">
        <li>Text1.SelStart = 0</li>
        <li>Text1.SelLength = Len(Text1.Text)</li>
      </ol>
      <hr>
      <p align="center" class="size3"> <a name="STEP2"></a>Pi&ugrave; TextBox 
        autoselezionanti in una matrice di controlli</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3 / 5</p>
      <p>Se volessimo riprodurre il medesimo effetto di autoselezione in una matrice 
        di TextBox dovremmo fare qualche accorgimento. &Egrave; necessario infatti 
        calcolare a quale casella di testo vogliamo selezionare il testo. La nuova 
        routine &egrave;:</p>
      <ol class="codicevb" start="1">
        <li>Private Sub Text2_GotFocus(Index As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Text2(Index).SelStart = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Text2(Index).SelLength = Len(Text2(Index).Text)</li>
        <li>End Sub</li>
      </ol>
      <p>Il parametro <b>Index</b> in pi&ugrave; &egrave; l'indice della casella 
        attiva all'interno della matrice.</p>
      <hr>
      <p align="center" class="size3"> <a name="STEP3"></a>Implementazione della 
        classe AutoSelTextBox</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"> 
        4 / 5</p>
      <p>Proviamo a creare una classe per caselle di testo autoselezionanti da 
        utilizzare attraverso il <a href="../glossary/m.htm#MULTICASTING">Multicasting</a>. 
        La chiameremo AutoSelTextBox. </p>
      <p>Presentiamo subito il codice:</p>
      <ol class="codicevb" start="1">
        <li>Public WithEvents CasellaTesto As TextBox</li>
        <li></li>
        <li>Private Sub CasellaTesto_GotFocus()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;CasellaTesto.SelStart = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;CasellaTesto.SelLength = Len(CasellaTesto.Text)</li>
        <li>End Sub</li>
        <li></li>
        <li>Private Sub Class_Terminate()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set CasellaTesto = Nothing</li>
        <li>End Sub</li>
      </ol>
      <p>La prima riga dichiara una variabile pubblica di nome <b>CasellaTesto</b> 
        di tipo TextBox. Essa sar&agrave; un <a href="../glossary/p.htm#PUNTATORE">puntatore</a> 
        alla casella di cui vogliamo selezionare il testo automaticamente. Abbiamo 
        incluso l'istruzione WithEvents che fornisce la possibilit&agrave; di 
        gestire gli eventi di una variabile.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Applichiamo il codice visto nel primo esempio, senza matrici, nella routine 
        legata all'evento GotFocus della variabile <b>CasellaTesto</b>.</p>
      <p>Alla <a href="../glossary/d.htm#DEALLOCARE">deallocazione</a> della classe 
        scatta l'evento Terminate della classe. Prima di perdere il controllo 
        della classe dobbiamo ricordarci di deallocare anche la variabile <b>CasellaTesto</b> 
        in modo da liberare la memoria. Questo &egrave; quello che fa l'istruzione 
        alla riga 9.</p>
      <p>Il form utilizzatore della classe possieder&agrave; due caselle di testo 
        di nome <b>Text3_1</b> e <b>Tex3_2</b> ed entrambe verranno gestite da 
        due istanze di classe <b>AutoSelTextBox</b>. L'assegnazione (<a href="../glossary/m.htm#MAPPING">mapping</a>) 
        delle caselle di testo alla propriet&agrave; <b>CasellaTesto</b> viene 
        effettuata con questo codice:</p>
      <ol class="codicevb" start="1">
        <li>Private CasellaNumBox1 As New AutoSelTextBox</li>
        <li>Private CasellaNumBox2 As New AutoSelTextBox</li>
        <li></li>
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set CasellaNumBox1.CasellaTesto = Me.Text3_1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set CasellaNumBox2.CasellaTesto = Me.Text3_2</li>
        <li>End Sub</li>
      </ol>
      <p>Le prime due righe definiscono due istanze di AutoSelTextBox.<br>
        Le righe 5 e 6 effettuano il mapping delle caselle di testo con le variabili 
        istanziate.</p>
      <p>&Egrave; fondamentale ricordarsi che prima della chiusura del programma 
        dobbiamo deallocare le due istanze di classe, altrimenti rimarrebbe un'area 
        della memoria bloccata da risorse inaccessibili. La deallocazione si effettua 
        nel solito modo: <code>Set Variabile = Nothing</code>.</p>
      <p>Scriviamo per cui anche queste istruzioni di deallocazione, posizionate 
        nell'evento Terminate del Form, ultimo punto dove &egrave; possibile eseguire 
        operazioni, prima che venga scaricato il form dalla memoria.</p>
      <ol class="codicevb" start="1">
        <li>Private Sub Form_Terminate()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set CasellaNumBox1 = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set CasellaNumBox2 = Nothing</li>
        <li>End Sub</li>
      </ol>
      <p>Come per tutte le classi, quest'operazione &egrave; fondamentale perch&eacute; 
        non viene eseguita automaticamente dal sistema operativo. La mancata attuazione 
        di quest'operazione provoca la diminuzione di risorse disponibili nel 
        computer, rallentamenti ed anche malfunzionamenti.</p>
      <hr>
      <p align="center" class="size3"> <a name="STEP4"></a>Una soluzione un po' 
        rustica </p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2 / 5</p>
      <p align="left">Un'ultima soluzione si pu&ograve; effettuare tramite l'utilizzo 
        dell'istruzione SendKeys.<br>
        Infatti potremmo portare il cursore all'inizio della casella di testo 
        e fargli effettuare la selezione attraverso l'utilizzo dei tasti.</p>
      <p align="left">Questa soluzione &egrave; molto grezza e pu&ograve; provocare 
        errori nel programma. In particolare non funziona quando la casella diventa 
        attiva tramite un click con il mouse.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p align="left">Comunque l'istruzione per l'autoselezione da scrivere dentro 
        la routine dell'evento GotFocus di una casella di testo &egrave;:</p>
      <ol class="codicevb" start="1">
        <li>SendKeys &quot;^{HOME}+^{END}&quot;</li>
      </ol>
      <p>Viene inviato alla casella di testo inizialmente un CTRL&nbsp;HOME che 
        porta il cursore all'inizio ed in seguito viene inviato SHIFT&nbsp;CTRL&nbsp;END 
        che porta il cursore alla fine del testo della casella tenendo premuto 
        il tasto SHIFT utilizzato per fare la selezione. <br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Si sconsiglia fortemente l'uso della terza soluzione perch&eacute; pu&ograve; 
        provocare errori ed il suo comportamento pu&ograve; essere modificato 
        da qualche altra routine.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        18 Novembre 2000<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
