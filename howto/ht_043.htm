<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Bloccare un form sempre in primo piano</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Bloccare un form sempre 
    in primo piano<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Dall'avvento di Windows 95 il numero dei programmi utilizzati contemporaneamente 
        si &egrave; notevolmente innalzato. &Egrave; infatti possibile avviare 
        pi&ugrave; programmi ed utilizzare quello pi&ugrave; utile al momento 
        con un semplice click sulla barra delle applicazioni.<br>
        L'attivazione, per&ograve; di una finestra comporta quasi sempre la sparizione 
        della finestra precedentemente in primo piano. In alcuni casi &egrave; 
        per&ograve; necessario che una determinata finestra rimanga sempre e comunque 
        in primo piano, anche se ne viene attivata un'altra.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Vedremo in questo semplice HowTo come porre una finestra in primo piano 
        rendendola quindi sempre presente nonostante vengato attivate altre finestre. 
        Il trucco sta soltanto nell'uso della funzione <a href="../glossary/a.htm#API">API</a> 
        <i>SetWindowPos</i>, in grado di modificare le dimensioni e le posizioni 
        X, Y o Z di una finestra.</p>
      <p><img src="../images/howto/howto043_01.png" width="136" height="47" align="right" alt="Figura 1">Il 
        progetto sviluppato si compone di un solo form con un singolo controllo 
        <i>CheckButton</i> di nome <b>chkPrimoPiano</b> ed il codice si rivela 
        altrettanto semplice:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Declare Function SetWindowPos Lib &quot;user32&quot; (ByVal 
          hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal 
          y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) 
          As Long</li>
        <li></li>
        <li>Private Const HWND_TOPMOST = -1</li>
        <li>Private Const HWND_NOTOPMOST = -2</li>
        <li>Private Const SWP_NOSIZE = 1</li>
        <li>Private Const SWP_NOMOVE = 2</li>
        <li></li>
        <li>Private Const lngNoChangePos = SWP_NOMOVE + SWP_NOSIZE</li>
        <li></li>
      </ol>
      <p>Alla riga 3 &egrave; dichiarata la funzione <i>SetWindowPos</i> che richiede 
        quali argomenti l'<a href="../glossary/h.htm#HANDLE">handle</a> della 
        finestra da posizionare, le posizioni Z (<b>hWndInsertAfter</b>), X ed 
        Y, le grandezze larghezza ed altezza ed un valore che specifica il tipo 
        di operazioni da effettuare.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alle righe 5 e 6 sono dichiarati due valori API che specificano il blocco 
        e lo sblocco della posizione Z: <i><b>HWND_TOPMOST</b></i> specifica che 
        la finestra dovr&agrave; sempre e comunque stare in primo piano, anche 
        se disattivata, mentre <i><b>HWND_NOTOPMOST</b></i> disattiva questo comportamento.</p>
      <p>Poich&eacute; per i nostri fini non &egrave; necessario spostare o ridimensionare 
        la finestra ma la funzione SetWindowPos richiede comunque un valore, &egrave; 
        possibile utilizzare un valore di flag che specifichi di non utilizzare 
        i valori passati come posizione X ed Y e come dimensioni di larghezza 
        ed altezza. In tal modo la funzione effettuer&agrave; soltanto il blocco 
        sull'asse Z. Le costanti API alle righe 7 ed 8 serviranno proprio a questo 
        scopo: non effettuare lo spostamento n&eacute; il ridimensionamento. Per 
        semplificare la scrittura del codice abbiamo aggiunto anche una terza 
        costante, non definita nell'API, che contenga gli ultimi due valori da 
        passare alla funzione SetWindowPos.</p>
      <ol class="codicevb" start="12">
        <li>Private Sub chkPrimoPiano_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If chkPrimoPiano.Value = vbChecked Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call SetWindowPos(Me.hwnd, 
          HWND_TOPMOST, 0, 0, 0, 0, lngNoChangePos)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call SetWindowPos(Me.hwnd, 
          HWND_NOTOPMOST, 0, 0, 0, 0, lngNoChangePos)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub</li>
      </ol>
      <p>Nel momento in cui l'utente clicca sulla casella di controllo<img src="../images/controls/checkbox.gif" width="25" height="25" align="absmiddle">sar&agrave; 
        effettuato un controllo del suo valore per permettere il blocco o lo sblocco 
        sull'asse Z.</p>
      <p>Se la casella &egrave; selezionata (valore <i><b>vbChecked</b></i> - 
        riga 13) sar&agrave; richiamata la funzione <i>SetWindowPos</i> con l'impostazione 
        <i> <b>HWND_TOPMOST</b></i> per bloccare la finestra in primo piano; nel 
        caso inverso (riga 16) sar&agrave; richiamata la stessa funzione con il 
        valore <i><b>HWND_NOTOPMOST</b></i> per disattivare il blocco precedentemente 
        attivato.</p>
      <p>La costante <b>lngNoChangePos</b> specifica di non modificare n&eacute; 
        posizione X ed Y n&eacute; dimensioni della finestra, ignorando quindi 
        quella serie di 0 passati soltanto perch&eacute; la funzione richiedeva 
        i parametri.</p>
      <p>Il funzionamento del progetto &egrave; davvero molto semplice:</p>
      <table width="90%" border="0" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <td align="center" valign="top"><img src="../images/howto/howto043_02.gif" width="136" height="74" alt="Figura 2"><br>
            <b>Figura 2</b></td>
          <td align="center" valign="top"><img src="../images/howto/howto043_03.gif" width="136" height="74" alt="Figura 3"><br>
            <b>Figura 3</b></td>
        </tr>
      </table>
      <p>Nel momento in cui la casella di controllo non &egrave; selezionata le 
        altre finestra (nel nostro caso il programma <b>APIViewer 2001</b>) potranno 
        posizionarsi di fronte al nostro form come mostrato nella Figura 2.<br>
        Quando la casella di controllo viene selezionata, l'attivazione di un'altra 
        applicazione come dimostra il colore blu della barra del titolo non nasconder&agrave; 
        il nostro form, che rimarr&agrave; sempre e comunque in primo piano pur 
        non essendo pi&ugrave; il form attivo al momento, come mostrato nella 
        Figura 3.<br>
        <br>
      </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il progetto &egrave; davvero molto molto semplice e si &egrave; preferito 
        presentare una scrittura leggermente pi&ugrave; lunga ma pi&ugrave; esplicativa 
        e non presenta alcun difetto particolare.</p>
      <p>Soltanto si raccomanda di non abusare di questa funzionalit&agrave; di 
        Windows perch&eacute; in molte situazioni pu&ograve; risultare davvero 
        fastidioso trovarsi una finestra non desiderata dinanzi e non poterla 
        nascondere dietro le altre finestre. L'utilizzo ideale &egrave; quello 
        di lasciar decidere all'utente se essa dovr&agrave; stare in primo piano 
        mediante un pannello di opzioni ed in ogni caso dovrebbe esistere qualche 
        ragione valida per cui essa debba stare sempre in primo piano.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        29 Marzo 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
