<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Invio di un'email tramite un programma esterno</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Invio di un'email tramite 
    un programma esterno<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Al giorno d'oggi quasi tutti hanno una casella di posta elettronica personale. 
        &Egrave; quindi normale inserire in un programma un collegamento al cui 
        click viene aperto il programma client di posta elettronica predefinito 
        per permettere l'invio di un'e-mail.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Prima di vedere le poche righe di codice di cui si compone questo HowTo, 
        preparemo un piccolo form in cui l'utente potr&agrave; specificare i dati 
        dell'e-mail da inviare.</p>
      <p><img src="../images/howto/howto020_01.jpg" width="250" height="217" align="right" alt="Figura 1">Inseriamo 
        sopra un form:</p>
      <ul>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailVBSimple</b> con la propriet&agrave; <i>Caption</i> impostata 
          a: <b><i>&quot;Clicca qui per inviare un'email a VB Simple&quot;</i></b> 
          e scegliamo per essa un font sottolineato ed il colore blu, classico 
          dei collegamenti internet;</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailToLabel</b> con la propriet&agrave; <i>Caption</i> impostata 
          a: <i><b>&quot;Invia un'email a:&quot;</b></i>;</li>
        <li>Una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailTo</b> posizionata a fianco della label <b>EmailToLabel</b>.</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCCLabel</b> con la propriet&agrave; <i>Caption</i> impostata 
          a: <i><b>&quot;e in copia carbone a:&quot;</b></i>;</li>
        <li>Una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCC</b> a destra della Label EmailCCLabel;</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCCNLabel</b> con la propriet&agrave; <i>Caption</i> impostata 
          a: <i><b>&quot;e in copia nascosta a:&quot;</b></i>;</li>
        <li>Una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCCN</b> a destra della Label EmailCCNLabel;</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailOggettoLabel</b> con la <i>Caption</i> impostata a: <i><b>&quot;Oggetto&quot;</b></i>;</li>
        <li>Una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailOggetto</b> subito a destra della Label precedente;</li>
        <li>Una <i>Label</i><img src="../images/controls/label.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCorpoLabel</b> con la <i>Caption</i> <i><b>&quot;Corpo 
          della lettera:&quot;</b></i>;</li>
        <li>Una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
          nome <b>EmailCorpo</b> con la propriet&agrave; <i>Multiline</i> impostata 
          a True;</li>
        <li>Un <i>CommandButton</i> di nome <b>EmailInvia</b>, con la <i>Caption</i> 
          impostata a <i><b>&quot;Invia E-mail&quot;</b></i></li>
      </ul>
      <p>Al momento del click sulla Label EmailVBSimple vengono automaticamente 
        riempiti i vari campi del programma.</p>
      <p>Utilizzeremo la funzione <a href="../glossary/a.htm#API">API</a> <i>ShellExecute</i> 
        per richiamare il comando in stile Internet per inviare un'email. Il comando 
        in questione &egrave; &quot;mailto:&quot; seguito dall'indirizzo di posta 
        elettronica e seguito da una serie di comandi opzionali.</p>
      <p>Il codice di questo semplice progetto &egrave; il seguente:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li>Private Declare Function ShellExecute Lib &quot;SHELL32&quot; Alias 
          &quot;ShellExecuteA&quot; (ByVal hwnd As Long, ByVal lpOperation As 
          String, ByVal lpFile As String, ByVal lpParameters As String, ByVal 
          lpDirectory As String, ByVal nShowCmd As Long) As Long</li>
        <li></li>
      </ol>
      <p>Alla riga 2 abbiamo dichiarato la funzione API ShellExecute sopra citata.<br>
        Essa richiede specificato l'handle di una finestra resposabile della chiamata., 
        una stringa per specificare il comando da eseguire (<i>lpOperation</i>), 
        il nome del file da eseguire (<i>lpFile</i>), una serie di parametri (<i>lpParameters</i>), 
        la directory di lavoro (<i>lpDirectory</i>) ed infine lo stile della finestra 
        da aprire (<i>nShowComd</i>).</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Seguono due semplicissime routine legate all'evento click sopra la Label 
        <b>EmailVBSimple</b> e quella legata al click sopra il pulsante <b>PulsanteInvia</b>.</p>
      <ol class="codicevb" start="4">
        <li>Private Sub EmailVBSimple_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;EmailTo.Text = &quot;vbsimple@email.it&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;EmailCC.Text = &quot;fibiafbi@hotmail.com&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;EmailOggetto.Text = &quot;Prova di e-mail 
          esterna&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;EmailCorpo.Text = &quot;Corpo della lettera 
          da inviare&quot;</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Il click sopra la Label <b>EmailVBSimple</b> riempir&agrave; i campi 
        del programma con i dati d'esempio di VB Simple.</p>
      <ol class="codicevb" start="11">
        <li>Private Sub PulsanteInvia_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim COMANDO As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;COMANDO = &quot;mailto:&quot; &amp; EmailTo.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;COMANDO = COMANDO &amp; &quot;?cc=&quot; &amp; 
          EmailCC.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;COMANDO = COMANDO &amp; &quot;&ccn=&quot; 
          &amp; EmailCCN.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;COMANDO = COMANDO &amp; &quot;&subject=&quot; 
          &amp; EmailOggetto.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;COMANDO = COMANDO &amp; &quot;&body=&quot; 
          &amp; EmailCorpo.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ShellExecute Me.hwnd, &quot;open&quot;, COMANDO, 
          ByVal 0&amp;, ByVal 0&amp;, ByVal 0&amp;</li>
        <li>End Sub</li>
      </ol>
      <p>La routine vera e propria di questo progetto &egrave; la PulsanteInvia_Click.<br>
        All'interno di essa viene dichiarata la variabile <i><b>COMANDO</b></i> 
        per comporre la stringa Internet per l'invio di un'email.</p>
      <p>Vengono quindi, man mano, aggiunti alla stringa <b><i>COMANDO</i></b> 
        i singoli campi del progetto alla stringa da eseguire.<br>
        La stringa si compone di: <i>&quot;mailto:&quot;</i> seguito dall'indirizzo 
        del destinatario (riga 13).<br>
        &Egrave; inoltre possibile aggiungere una serie di argomenti opzionali. 
        Come per tutti gli argomenti inseriti negli indirizzi internet, il primo 
        deve essere preceduto da un punto interrogativo (?) e gli altri argomenti 
        devono essere separati tra loro da un ampersand (&amp;).<br>
        Abbiamo cos&igrave; inserito l'argomento <i>&quot;cc=&quot;</i> seguito 
        da un indirizzo di posta per identificare il destinatario in copia carbone 
        della lettera (riga 14). Abbiamo anche specificato i destinatari in copia 
        carbone nascosta mediante la specificazione dell'argomento <i>&quot;ccn=&quot;</i> 
        seguito dall'indirizzo email (riga 15).<br>
        Altri argomenti che &egrave; possibile specificare sono l'oggetto della 
        email, identificato dall'argomento <i>&quot;subject=&quot;</i> (riga 16) 
        e il corpo stesso della lettera, identificato da <i>&quot;body=&quot;</i>.</p>
      <p>Una volta creato l'indirizzo internet per scrivere un'email, richiamiamo 
        il client di posta predefinito tramite la funzione <i>ShellExecute</i> 
        passandogli come stringa dell'operazione da eseguire il comando <i>&quot;open&quot;</i> 
        e come nome del file l'indirizzo appena creato e memorizzato nella variabile 
        COMANDO. Tutti gli altri argomenti della funzione ShellExecute li abbiamo 
        voluti lasciare in bianco perch&eacute; inutili ai nostri scopi. Essendo 
        argomenti obbligatori &egrave; stato necessario impostarli a valori nulli 
        tramite <i>ByVal 0&amp;</i>.</p>
      <p>Naturalmente, nel nostro esempio abbiamo voluto inserire un po' di tutto 
        per creare un'email, compreso il testo del messaggio. In altri casi baster&agrave; 
        creare una stringa di comandi minima, senza la necessit&agrave; di presentare 
        all'utente form di compilazione o altro. La chiamata stessa, infatti, 
        aprir&agrave; il client di posta predefinito e tramite quello l'utente 
        potr&agrave; compilare ed inviare l'email.</p>
      <p align="center"> <img src="../images/howto/howto020_02.jpg" width="250" height="217" alt="Figura 2"> 
        <br>
        <b>Figura 2</b></p>
      <p>Il progetto &egrave; semplicissimo da usare, basta riempire i vari campi 
        e cliccare il pulsante &quot;Invia E-mail&quot; per richiamare il programma 
        client di posta predefinito e inviare la lettera.<br>
        <br>
      </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Questa pratica &egrave; usatissima in tantissimi programmi e non comporta 
        rischi particolari.<br>
        Come gi&agrave; detto, abbiamo voluto esagerare in questo esempio, per 
        spiegare le possibilit&agrave; messe a disposizione dalla composizione 
        di un indirizzo internet di tipo &quot;mailto:&quot;; in altre situazioni, 
        il click sopra la label, da solo basterebbe a creare la stringa da eseguire, 
        senza l'aiuto di campi da riempire.</p>
      <p>Un esempio di quest'applicazione si trova nella richiesta sullo <a href="../activity/act_01.htm">sviluppo 
        di un controllo utente per collegamenti internet</a>.</p>
      <p><img src="../images/notes2.gif" width="31" height="32" align="left">Abbiamo 
        gi&agrave; ricevuto <b>decine di e-mail</b> in cui si chiedeva come poter 
        allegare uno o pi&ugrave; files ad un messaggio preparato con questa soluzione. 
        Al giorno d'oggi il <a href="../glossary/p.htm#PROTOCOLLO">protocollo</a> 
        <i>mailto:</i> <b>non consente</b> questa operazione e la soluzione al 
        problema necessita un approccio del tutto differente, molto pi&ugrave; 
        complesso e che richiede una connessione diretta al server SMTP. Si prega 
        quindi di <b>astenersi dall'inviare altre richieste</b> circa quest'argomento.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        16 Gennaio 2001<br>
        Nota del 28 Novembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
