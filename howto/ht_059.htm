<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>File Manifest nelle risorse</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->File Manifest nelle risorse<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Abbiamo visto in un <a href="ht_058.htm">altro HowTo come applicare lo 
        stile visuale di Windows XP</a> ad un'applicazione scritta in Visual Basic. 
        Tutto ci&ograve; che &egrave; fondamentale fare &egrave; inserire due 
        semplici istruzioni ed accludere all'eseguibile un file Manifest con il 
        nome dell'applicazione seguito dall'estensione <i>manifest</i>. Vedremo 
        in quest'articolo come fare a meno di redistribuire il file aggiuntivo 
        ed integreremo lo stesso in un <a href="../glossary/f.htm#FILEDIRISORSE">file 
        di risorse</a> <img src="../images/ide/risorse.gif" width="16" height="16" align="absmiddle"> 
        che verr&agrave; collegato (<a href="../glossary/l.htm#LINKER">linked</a>) 
        al file eseguibile.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto059_1.png" width="203" height="157" align="right" alt="Figura 1">Il 
        procedimento &egrave; estremamente semplice ma si raccomanda la consultazione 
        dell'<a href="ht_016.htm">HowTo dedicato all'utilizzo di un file di risorse</a>, 
        per capire come compilare il file di risorse; il progetto si compone di 
        un solo form ed alcuni controlli senza particolare cura, in quanto serviranno 
        solo a dimostrare l'avvenuto aggiornamento dello stile visuale.</p>
      <p>Il codice conterr&agrave; le solite poche righe per attivare la libreria 
        <i>COMCTL32.DLL</i> e richiedere quindi lo stile visuale:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Declare Function InitCommonControls Lib &quot;Comctl32.dll&quot; 
          () As Long</li>
        <li></li>
        <li>Private Sub Form_Initialize()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call InitCommonControls</li>
        <li>End Sub</li>
      </ol>
      <p>Tutto qui! <img src="../images/smiley/wink.gif" width="15" height="15" align="absmiddle"><br>
        Ci&ograve; che ancora manca &egrave; il file manifest e pertanto a tal 
        scopo ne gereremo uno per il nostro progetto e lo salveremo col nome <b>MANIFEST.TXT</b> 
        (a riprova quindi che il programma eseguibile non utilizzer&agrave; il 
        file <i>programma.exe.manifest</i> nella stessa cartella). &Egrave; possibile 
        <a href="../dativari/nome.exe.manifest">scaricare un file manifest generico 
        qui</a>. Aggiungeremo anche un file di risorse di nome <b>RISORSE.RC</b> 
        che conterr&agrave; il seguente codice:</p>
      <ol start="1" class="codicevb">
        <li>#define CREATEPROCESS_MANIFEST_RESOURCE_ID&nbsp;&nbsp;&nbsp;&nbsp;1</li>
        <li>#define RT_MANIFEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24</li>
        <li></li>
        <li>CREATEPROCESS_MANIFEST_RESOURCE_ID RT_MANIFEST &quot;MANIFEST.TXT&quot;</li>
      </ol>
      <p>Le due costanti <b>CREATEPROCESS_MANIFEST_RESOURCE_ID</b> e <b>RT_MANIFEST</b> 
        indicheranno rispettivamente il numero identificato ed il tipo della risorsa; 
        il nome delle predette costanti non &egrave; importante ma sono ci&ograve; 
        che &egrave; riportato dalla documentazione ufficiale di casa Microsoft. 
        Naturalmente il file che seguir&agrave; i due identificatori &egrave; 
        il nome del nostro file <i>manifest</i>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La documentazione ufficiale raccomanda la scrittura del file manifest 
        su un'unica riga, cio&egrave; senza andare a capo ad ogni tag o attributo 
        e si consiglia quindi si seguire tale indicazione. Tuttavia &egrave; stato 
        verificato il corretto funzionamento anche nella situazione in cui il 
        testo del file &egrave; riportato a capo, come nell'esempio allegato.</p>
      <p><!-- #BeginLibraryItem "/Library/Notes1.lbi" --><img src="../images/notes.gif" width="56" height="57" align="left"><!-- #EndLibraryItem --><img src="../images/howto/howto059_2.png" width="390" height="117" align="right" alt="Figura 2"> 
        <b class="smallerrore">Resta comunque un'importante limitazione</b>: la 
        dimensione in bytes del file manifest deve essere un numero divisibile 
        per 4; ad esempio una dimensione di 623&nbsp;bytes restituisce un errore 
        in fase di avvio del programma; in tali casi baster&agrave; aggiungere 
        qualche spazio tra un attributo e l'altro o modificare la descrizione 
        del programma.<br>
        Nel caso dovesse apparire l'avviso mostrato nella figura a fianco, probabilmente 
        la dimensione del file manifest non &egrave; un numero divisibile per 
        4, oppure non &egrave; stata richiamata correttamente la funzione <i>InitCommonControls</i>.</p>
      <p>Creato il file di risorse, baster&agrave; compilarlo con il comando <span class="fixed">&lt;Cartella&nbsp;in&nbsp;cui 
        &egrave;&nbsp;installato&nbsp;VB&gt;\WIZARDS\RC.EXE&nbsp;RISORSE.RC</span> 
        e verr&agrave; generato un file di nome <b>RISORSE.RES</b> che baster&agrave; 
        aggiungere al progetto mediante l'opzione <i>Inserisci file</i> presente 
        sul menu <b>Progetto</b>. Il file sar&agrave; mostrato nella <a href="../base/bas_02.htm">Finestra 
        di gestione dei progetti</a> con la sua relativa <img src="../images/ide/risorse.gif" width="16" height="16" align="absmiddle"> 
        icona.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Compiliamo quindi il nostro progetto ed avviamolo su qualsiasi macchina 
        che abbia Windows XP ed almeno la versione 6 della libreria <i>COMCTL32.DLL</i>. 
        Il risultato che otterremo &egrave; quello di un look pi&ugrave; moderno 
        al posto delle solite finestre squadrate, come mostrato nella Figura 3.</p>
      <table width="70%" border="0" cellspacing="2" cellpadding="0" align="center">
        <tr> 
          <td align="center" valign="top" width="50%"><img src="../images/howto/howto059_1.png" width="203" height="157" alt="Figura 3"><br>
            <b>Figura 3</b></td>
          <td align="center" width="50%" valign="top"><img src="../images/howto/howto059_3.png" width="203" height="162" alt="Figura 4"><br>
            <b>Figura 4</b></td>
        </tr>
      </table>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Nel caso venisse inserito un file manifest con il nome dell'applicazione 
        seguita dall'estensione .manifest, questo <b>avr&agrave; la priorit&agrave; 
        sul file contenuto nelle risorse</b> del programma eseguibile. Inutile 
        dire che nel caso in cui venisse incluso nelle risorse e non si hanno 
        bisogni particolari, non &egrave; necessario includere il file manifest 
        nella cartella del programma stesso.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        1 Marzo 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
