<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Convertire misure</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Convertire misure<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Utilizzando Visual Basic, funzioni API ed altri componenti ci si imbatte 
        facilmente in diverse unit&agrave; di misura quali i Twips, gli HiMetric, 
        i Pixel o altro. Altre volte si ha un valore in una misura ed &egrave; 
        necessario convertirlo in un'altra. Vedremo in questo HowTo come effettuare 
        questo genere di conversioni con estrema semplicit&agrave;.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto046_01.png" width="207" height="111" align="right" alt="Figura 1">Il 
        form del nostro progetto di esempio si comporr&agrave; di quattro semplici 
        controlli: due <i>ListBox</i><img src="../images/controls/listbox.gif" width="25" height="25" align="absmiddle">poste 
        ai bordi del form, di nome <b>lstFormato1</b> e <b>lstFormato2</b>.</p>
      <p>In mezzo a queste sono presenti un <i>CommandButton</i> di nome <b>cmdConverti</b> 
        ed una <i>TextBox</i> di nome <b>txtGrandezza</b>. Abbiamo aggiunto anche 
        due <b>Label</b> descrittive con le <i><b>Caption</b></i> impostate a 
        <code>&quot;&lt;- Da&quot;</code> ed <code>&quot;A -&gt;&quot;</code> 
        ma non presentano alcuna utilit&agrave; all'interno del progetto.</p>
      <p>Entrambe le <b>ListBox</b> conterranno le diverse unit&agrave; di misura 
        e saranno riempite con questi valori in fase di esecuzione. Ad ogni elemento 
        inserito nelle ListBox sar&agrave; assegnata una <a href="../glossary/c.htm#COSTANTE">costante</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" align="absmiddle"> 
        indicativa l'unit&agrave; di misura, mediante impostazione della propriet&agrave; 
        <i><b>ItemData</b></i>.</p>
      <p>Vediamo il breve e semplice codice di questo progetto:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim ctlControllo As ListBox</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim intConta As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For intConta = 1 To 2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set ctlControllo = 
          IIf(intConta = 1, lstFormato1, lstFormato2)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With ctlControllo</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Clear</li>
      </ol>
      <p>All'avvio del progetto dovranno essere riempite le due <b>ListBox</b>. 
        Sar&agrave; pertanto utilizzato un ciclo eseguito due volte (riga 6). 
        Alla riga 7 verr&agrave; estratta la prima o la seconda ListBox in funzione 
        del valore della variabile <b>intConta</b>. La ListBox estratta sar&agrave; 
        contenuta nella variabile oggetto <b>ctlControllo</b>.</p>
      <p>Ottenuto quindi un riferimento ad una ListBox, utilizziamo l'istruzione 
        With per migliorare l'efficenza e semplificare la scrittura del codice 
        di riempimento della ListBox. Alla riga 9 verr&agrave; innanzitutto svuotata 
        la ListBox selezionata.</p>
      <ol class="codicevb" start="10">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Twips&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbTwips</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Punti&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbPoints</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Pixel&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbPixels</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Caratteri&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbCharacters</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Pollici&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbInches</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Millimetri&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbMillimeters</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;Centimetri&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbCentimeters</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AddItem 
          &quot;HiMetric&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ItemData(.NewIndex) 
          = vbHimetric</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ListIndex 
          = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End With</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next intConta</li>
        <li>End Sub</li>
        <li></li>
      </ol>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alle righe 10-25 vengono inserite le varie unit&agrave; di misura nella 
        ListBox. Ogni unit&agrave; di misura si compone di due righe: la descrizione 
        e la costante nell'<a href="../glossary/e.htm#ENUMERAZIONE">enumerazione</a> 
        <img src="../images/ide/enumeraz.gif" width="16" height="16" align="absmiddle"> 
        <a href="../enum/048.htm">ScaleModeConstants</a>. La <a href="../glossary/m.htm#MATRICE">matrice</a> 
        <i><b>ItemData</b></i> degli oggetti ListBox consente infatti di assegnare 
        un valore numerico ad ogni elemento della lista. La propriet&agrave; <i><b>NewIndex</b></i> 
        invece recupera l'indice dell'ultimo elemento inserito in lista. La riga 
        26 seleziona il primo elemento della lista.</p>
      <ol class="codicevb" start="31">
        <li>Private Sub cmdConverti_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim intFormato1 As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim intFormato2 As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim strTesto As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;intFormato1 = lstFormato1.ItemData(lstFormato1.ListIndex)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;intFormato2 = lstFormato2.ItemData(lstFormato2.ListIndex)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTesto = CStr(Val(txtGrandezza.Text)) &amp; 
          &quot; &quot; &amp; lstFormato1.List(lstFormato1.ListIndex)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTesto = strTesto &amp; &quot; equivalgono 
          a &quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTesto = strTesto &amp; CStr(Me.ScaleX(Val(txtGrandezza.Text), 
          intFormato1, intFormato2))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strTesto = strTesto &amp; &quot; &quot; &amp; 
          lstFormato2.List(lstFormato2.ListIndex)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox strTesto, vbInformation + vbOKOnly, 
          &quot;Converti misure&quot;</li>
        <li>End Sub</li>
      </ol>
      <p>Nel momento in cui l'utente preme il pulsante <b>cmdConverti</b> dovr&agrave; 
        essere effettuata la conversione tra l'unit&agrave; di misura selezionata 
        nella prima ListBox e quella scelta nella seconda ListBox.</p>
      <p>Alle righe 35 e 36 sono recuperate le costanti delle unit&agrave; di 
        misura contenute nelle matrici <i><b>ItemData</b></i> di ognuna delle 
        ListBox. Cos&igrave; <b>intFormato1</b> conterr&agrave; la costante rappresentativa 
        la prima unit&agrave; di misura ed <b>intFormato2</b> conterr&agrave; 
        la seconda costante.</p>
      <p>La conversione tra le due unit&agrave; di misura &egrave; fatta alla 
        riga 39 mediante l'utilizzo del metodo&nbsp; <b>ScaleX</b> del form. Il 
        valore specificato &egrave; quello contenuto nella casella <b>txtGrandezza</b> 
        e le unit&agrave; di misura sono specificate nelle variabili <b>intFormato1</b> 
        ed <b>intFormato2</b>.</p>
      <p>Alle righe 37-40 viene costruita una stringa descrittiva del processo 
        di conversione, che verr&agrave; memorizzata nella variabile <b>strTesto</b>, 
        la quale verr&agrave; mostrata mediante una finestra di avviso alla riga 
        41.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La dimostrazione del funzionamento &egrave; semplicissima: baster&agrave; 
        selezionare un'unit&agrave; di misura nella ListBox a sinistra, un'altra 
        unit&agrave; di misura nella ListBox di destra, immettere un valore nella 
        casella di testo in basso e premere il pulsante <i><b>&quot;Converti Grandezze&quot;</b></i>. 
        Apparir&agrave; un avviso informativo come mostrato nelle figure in basso.</p>
      <table width="85%" border="0" cellspacing="2" cellpadding="2" align="center">
        <tr> 
          <td align="center" valign="top" width="50%"><img src="../images/howto/howto046_02.png" width="207" height="111" alt="Figura 2"><br>
            <b>Figura 2</b></td>
          <td align="center" valign="top" width="50%"><img src="../images/howto/howto046_03.png" width="187" height="95" alt="Figura 3"><br>
            <b>Figura 3</b></td>
        </tr>
      </table>
      <br>
      <br>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il processo di conversione tra le unit&agrave; di misura &egrave; davvero 
        semplice e non presenta alcuna problematica particolare.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        21 Aprile 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
