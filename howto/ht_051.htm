<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Esportare dati da AS/400 in un foglio Excel</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Esportare dati da AS/400 
    in un foglio Excel<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p class="size1" align="center">( <span class="sottolineato">Articolo temporaneo 
        in attesa di essere trasferito ad altra sezione</span> )</p>
      <p>Un problema che affligge parecchi programmatori &egrave; quello di far 
        comunicare un programma scritto in Visual Basic con un <b>AS/400</b>, 
        richiedere l'esportazione di certi dati dal server e reimportarli, ad 
        esempio, in un foglio <i>Excel</i> per semplificarne l'utilizzo sul lato 
        client.</p>
      <p>In questo articolo sar&agrave; spiegato come stabilire una connessione 
        all'AS/400 utilizzando il driver <a href="../glossary/o.htm#ODBC">ODBC</a> 
        fornito con <i>IBM Client Access</i> e <i>Client Access Express</i>.<br>
        A tal scopo &egrave; necessario creare un <b>DSN</b> (<i>Data Source Name</i>) 
        utente o di sistema al <a href="../glossary/d.htm#DATABASE">database</a> 
        posto sul server. Il DSN pu&ograve; essere creato <a href="../activity/act_03.htm">utilizzando 
        il pannello di amministrazione ODBC</a> oppure <a href="../activity/act_13.htm">utilizzando 
        le funzioni API ODBC</a>. La connessione sar&agrave; effettuata mediante 
        i <a href="../database/db_05.htm">modelli dati</a> DAO e ADO.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>L'accesso al foglio Excel richiede l'aggiunta di un riferimento alla 
        <i>Microsoft Excel 8.0 Object Library</i> (EXCEL8.OLB) in caso di Excel&nbsp;97 
        e <i>Microsoft Excel 9.0 Object Library</i> (EXCEL9.OLB) in caso di Excel&nbsp;2000. 
        La cartella Excel si chiamer&agrave; <b>CARTEL1.XLS</b> e sar&agrave; 
        contenuta nella cartella del programma. Nel nostro esempio il server si 
        chiama <b>AS400</b> ed i dati da estrarre sono contenuti nella tabella 
        <b>NOMINATIVI</b> contenuta nel database posto sull'AS/400 nella libreria 
        <b>CLIENTI</b>. L'utente che acceder&agrave; al server si chiamer&agrave; 
        <b>UTENTE</b> e la password associata sar&agrave; <b>PASSWORD</b>. Il 
        DSN utilizzato sar&agrave; chiamato <b>DSNAS400</b> ed utilizzer&agrave; 
        il driver <i>Client Access ODBC Driver (32-bit)</i>.</p>
      <hr>
      <p>La prima delle due soluzioni utilizza il modello dati pi&ugrave; vecchio: 
        <a href="../glossary/d.htm#DATAACCESSOBJECT">Data Access Object</a> (DAO) 
        ed a tal scopo &egrave; necessario aggiungere un riferimento alla libreria 
        <i>Microsoft DAO x.xx Object Library</i> (DAOxx.DLL). Questa soluzione 
        &egrave; necessaria se si utilizza Microsoft Excel 97. Vediamo il codice 
        del progetto:</p>
      <ol class="codicevb">
        <li>Sub EstraiDati(ByVal strSQL As String, ByVal strWbk As String)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim wrkODBC As DAO.Workspace</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim conn As DAO.Connection</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim rs As DAO.Recordset</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlApp As Excel.Application</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlQT As Excel.QueryTable</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlWS As Excel.Worksheet</li>
        <li></li>
      </ol>
      <p>La routine che estrae i dati e li inserisce nel foglio Excel &egrave; 
        chiamata <b>EstraiDati</b> e riceve due argomenti: <b>strSQL</b> &egrave; 
        una stringa SQL, utilizzata per estrarre tutta o parte di una o pi&ugrave; 
        tabelle; <b>strWbk</b> indica invece il percorso della cartella Excel.</p>
      <p>La funzione utilizza parecchi riferimenti ad oggetti: <b>wrkODBC</b> 
        &egrave; l'area di lavoro <i>ODBCDirect</i>, <b>conn</b> &egrave; la connessione 
        basata sull'area di lavoro, mentre <b>rs</b> &egrave; il <a href="../glossary/r.htm#RECORDSET">Recordset</a> 
        che conterr&agrave; i dati.<br>
        Seguono gli oggetti Excel: <b>xlApp</b> indica l'applicazione Microsoft 
        Excel, <b>xlQT</b> &egrave; la QueryTable che ricever&agrave; i dati del 
        Recordset e che verr&agrave; aggiunta al foglio di lavoro <b>xlWS</b>.</p>
      <ol start="9" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;Set wrkODBC = CreateWorkspace(&quot;ODBCAS400&quot;, 
          &quot;UTENTE&quot;, &quot;PASSWORD&quot;, dbUseODBC)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set conn = wrkODBC.OpenConnection(&quot;Conn1&quot;, 
          dbDriverComplete, , &quot;ODBC;DSN=DSNAS400;DATABASE=AS400.CLIENTI&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set rs = conn.OpenRecordset(strSQL)</li>
        <li></li>
      </ol>
      <p>La prima operazione da eseguire sar&agrave; quella di stabilire la connessione 
        alla fonte dati ODBC mediante DSN, ma prima di poter accedere ad una qualsiasi 
        fonte dati ODBC &egrave; necessario creare un'area di lavoro <i>ODBCDirect</i>; 
        in seguito sar&agrave; aperta la connessione ed estratti i dati da essa.</p>
      <p>Alla riga 9 &egrave; creato una nuova area di lavoro (Workspace) di nome 
        <b>ODBCAS400</b>, ma il nome poteva essere qualunque altro valore; il 
        proprietario dell'area di lavoro &egrave; <b>UTENTE</b> ed utilizza la 
        password <b>PASSWORD</b> per accedere alle fonti dati. L'ultimo parametro 
        <i><b>dbUseODBC</b></i> specifica che il Workspace da creare &egrave; 
        di tipo <i>ODBCDirect</i>, opposto al tipo standard Jet. La nuova area 
        di lavoro &egrave; quindi contenuta nella variabile oggetto <b>wrkODBC</b>.</p>
      <p>Alla riga successiva &egrave; avviata la connessione al server; il nome 
        della connessione &egrave; Conn1 ma ci&ograve; non &egrave; rilevante 
        al nostro scopo; il secondo argomento <i><b>dbDriverComplete</b></i> specifica 
        che nel caso venissero forniti i parametri di connessione errati, sar&agrave; 
        proposta la finestra di accesso del driver utilizzato. Il valore &egrave; 
        contenuto nell'<a href="../glossary/e.htm#ENUMERAZIONE">enumerazione</a> 
        <img src="../images/ide/enumeraz.gif" width="16" height="16" align="absmiddle"> 
        <b>DriverPromptEnum</b> e pu&ograve; assumere uno dei seguenti valori:</p>
      <ul>
        <li>dbDriverComplete<br>
          Determina la visualizzazione della finestra di accesso del relativo 
          driver nel caso che le informazioni fornite nella stringa di connessioni 
          siano insufficienti.<br>
          <br>
        </li>
        <li>dbDriverNoPrompt<br>
          Determina l'uso esclusivo della stringa di connessione. Se questa &egrave; 
          errata o incompleta sar&agrave; generato un errore.<br>
          <br>
        </li>
        <li>dbDriverPrompt<br>
          Determina la possibilit&agrave; di scelta fra un elenco di DSN disponibili 
          nel sistema e quindi richiama la finestra di accesso del relativo driver.<br>
          <br>
        </li>
        <li>dbDriverCompleteRequired<br>
          Simile al valore precedente ma nasconde tutte le informazioni non strettamente 
          necessarie.</li>
      </ul>
      <p>Il terzo argomento consente di specificare un valore che indica se la 
        connessione &egrave; effettuata in modalit&agrave; sola lettura oppure 
        siano consentite le modifiche. Il valore &egrave; ignorato in questo articolo.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>L'ultimo argomento della funzione OpenConnection specifica la stringa 
        di connessione da utilizzare per accedere alla fonte dati. Il primo valore 
        (<b>ODBC</b>) specifica il driver da utilizzare e nel nostro caso fa riferimento 
        all'insieme dei DSN; le informazioni che seguono indicano il nome del 
        DSN (<b>DSNAS400</b>) ed il database utilizzato (<b>AS400.CLIENTI</b>). 
        Non sono stati volutamente specificati nome utente e password perch&eacute; 
        tali valori saranno quindi ereditati dall'oggetto Workspace. In caso contrario 
        sarebbe stato necessario specificare <i><b>UID=UTENTE;PWD=PASSWORD</b></i>.</p>
      <p>Infine alla riga 11 sar&agrave; recuperato il Recordset con i dati desiderati 
        dalla connessione <b>conn</b>. I dati da recuperare dipendono dalla variabile 
        <b>strSQL</b>. </p>
      <ol start="13" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;Set xlApp = New Excel.Application</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;With xlApp</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Visible = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Workbooks.Open filename:=strWbk</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlWS = .Sheets(1)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlQT = xlWS.QueryTables.Add(rs, 
          .Range(&quot;A1&quot;))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End With</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlQT.Name = &quot;DB&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlQT.Refresh</li>
        <li></li>
      </ol>
      <p>Alla riga 13 &egrave; richiamata l'applicazione Excel cosicch&eacute; 
        l'oggetto <b>xlApp</b> faccia riferimento alla nuova istanza di Microsoft 
        Excel. In sequenza l'applicazione &egrave; mostrata, viene aperta la cartella 
        di lavoro specificata nell'argomento di funzione <b>strWbk</b>, &egrave; 
        scelto il primo foglio ed a questo viene aggiunta una nuova <i>QueryTable</i> 
        contenente il Recordset <b>rs</b>, alla posizione A1 del foglio di lavoro. 
        Il <i><b>Refresh</b></i> alla riga 21 fa s&igrave; che i dati della <i>QueryTable</i> 
        siano riportati nel foglio di lavoro.</p>
      <ol start="23" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;xlApp.Workbooks(1).Save</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlApp.Workbooks.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlApp.Quit</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;rs.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;conn.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;wrkODBC.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set rs = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set conn = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set wrkODBC = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlQT = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlWS = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlApp = Nothing </li>
        <li>End Sub</li>
      </ol>
      <p>Segue infine la fase di chiusura e pulizia della memoria. Tutti gli oggetti 
        aperti sono chiusi e <a href="../glossary/d.htm#DEALLOCARE">deallocati</a>. 
        La cartella di lavoro Excel prima della chiusura viene salvata (riga 23).</p>
      <hr>
      <p>La seconda soluzione utilizza invece il nuovo modello dati: <a href="../glossary/a.htm#ACTIVEXDATAOBJECTS">ActiveX 
        Data Objects</a> (ADO) e stabilire una connessione risulta ben pi&ugrave; 
        semplice. A tal scopo &egrave; necessario aggiungere un riferimento a 
        Microsoft ActiveX Data Objects 2.x Library (MSADO15.DLL). Questa soluzione 
        &egrave; necessaria se si utilizza Microsoft Excel 2000/XP. La stessa 
        routine EstraiDati pu&ograve; essere riscritta come segue:</p>
      <ol start="1" class="codicevb">
        <li>Sub EstraiDati(ByVal strSQL As String, ByVal strWbk As String)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim conn As ADODB.Connection</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim rs As ADODB.Recordset</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlApp As Excel.Application</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlQT As Excel.QueryTable</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim xlWS As Excel.Worksheet</li>
        <li></li>
      </ol>
      <p>Rispetto la versione precedente &egrave; stato eliminato l'oggetto Workspace, 
        mentre gli oggetti <b>conn</b> e <b>rs</b> cambiano la loro libreria da 
        DAO ad ADODB. Sono mantenuti intatti i riferimenti agli oggetti Excel.</p>
      <ol start="8" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;Set conn = New ADODB.Connection</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;conn.Open &quot;DSN=DSNAS400;DATABASE=AS400.CLIENTI&quot;, 
          &quot;UTENTE&quot;, &quot;PASSWORD&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set rs = New ADODB.Recordset</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;rs.CursorLocation = adUseClient</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;rs.Open strSQL, conn, adOpenStatic, adLockReadOnly</li>
        <li></li>
      </ol>
      <p>Alla riga 8 e 10 sono <a href="../glossary/a.htm#ALLOCARE">allocati</a> 
        rispettivamente una nuova connessione ed un nuovo Recordset. La connessione 
        al DSN &egrave; aperta alla riga 9: tutto ci&ograve; che &egrave; necessario 
        fornire &egrave; il nome del DSN, l'utente e la sua password associata; 
        il nome del database a cui collegarsi &egrave; necessario solo se si utilizza 
        un database differente da quello predefinito per l'utente.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Prima di poter estrarre i dati tramite Recordset &egrave; fondamentale 
        cambiare la posizione del cursore dati da server a client. In caso contrario 
        si generer&agrave; un errore (vedi l'articolo <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q263498">Q263498 
        della Microsoft Knowledge Base</a>). La riga 12 richiama il metodo <b>Open</b> 
        del Recordset con numerose informazioni: il primo argomento specifica 
        la query SQL utilizzata per estrarre i dati; il secondo argomento &egrave; 
        indica la connessione cui l'oggetto <b>rs</b> fa riferimento; il terzo 
        argomento specifica il tipo di cursore dati da utilizzare; l'ultimo argomento 
        specifica invece il tipo di blocco da attivare. Si rimanda alla <a href="../database/index.htm">Sezione 
        Database</a> per un'approfondimento di questi concetti.</p>
      <ol start="14" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;Set xlApp = New Excel.Application</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;With xlApp</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Visible = True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Workbooks.Open filename:=strWbk</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlWS = .Sheets(1)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlQT = xlWS.QueryTables.Add(rs, 
          .Range(&quot;A1&quot;))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End With</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlQT.Name = &quot;DB&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlQT.Refresh</li>
        <li></li>
      </ol>
      <p>Il segmento di codice per l'automazione di Microsoft Excel &egrave; identico 
        a quello utilizzato nella soluzione precedente. Si vuole soltanto sottolineare 
        che il metodo Add dell'insieme QueryTables richiede il passaggio di un 
        oggetto Recordset, cos&igrave; come la soluzione precedente. La differenza 
        sta nella classe di questo oggetto: sono rifiutati i Recordset DAO ma 
        sono ammessi soltanto quelli di tipo ADODB.</p>
      <ol start="24" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;xlApp.Workbooks(1).Save</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlApp.Workbooks.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;xlApp.Quit</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;rs.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;conn.Close</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set rs = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set conn = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlQT = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlWS = Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Set xlApp = Nothing</li>
        <li>End Sub</li>
      </ol>
      <p>Segue la chiusura e la <a href="../glossary/d.htm#DEALLOCARE">deallocazione</a> 
        di tutti gli oggetti utilizzati. La cartella di lavoro &egrave; salvata 
        prima di chiudere l'istanza <b>xlApp</b> di Microsoft Excel.</p>
      <hr>
      <p>La routine per l'esportazione dei dati pu&ograve; essere richiamata con 
        una semplice riga:</p>
      <p align="center" class="codicevb">EstraiDati &quot;SELECT * FROM NOMINATIVI&quot;, 
        App.Path &amp; &quot;\CARTEL1.XLS&quot;<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>La possibilit&agrave; di automatizzare Microsoft Excel e recuperare fonti 
        dati remote per utilizzarle con uno strumento esterno pu&ograve; semplificare 
        numerosi problemi.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a> e <a href="../vbmail.htm?id=8">Marco Rubaltelli</a><br>
        16 Settembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
