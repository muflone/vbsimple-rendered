<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Leggere il contenuto di un file</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Leggere il contenuto di 
    un file<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>La lettura di un file di testo &egrave; un'operazione semplicissima in 
        Visual Basic.<br>
        Vedremo in quest'esempio come visualizzare il contenuto di due files di 
        testo, <b>FILE1.TXT</b> e <b>FILE2.TXT</b> posti all'interno della cartella 
        del programma.</p>
      <p>All'interno di un form inseriamo due pulsanti di comando <img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle"> 
        entrambi di nome <b>PulsanteLeggi</b>. Formeremo quindi una matrice di 
        pulsanti. Il primo avr&agrave; indice 0 ed il secondo indice 1.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Inseriamo anche una casella di testo <img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle"> 
        e chiamiamola <b>CasellaTesto</b>. Impostiamo la sua propriet&agrave; 
        <i>Multiline</i> a True permettendo quindi il ritorno a capo del testo, 
        e la <i>ScollBars</i> a 3&nbsp;-&nbsp;Both, inserendo le barre di scorrimento 
        in entrambe le direzioni. Conviene anche impostare la propriet&agrave; 
        <i>Locked</i> a True in modo da impedire la modifica del testo letto.</p>
      <p>Abbandoniamo l'interfaccia grafica e focalizziamoci sul codice.<br>
        Per comodit&agrave; dichiareremo due <a href="../glossary/c.htm#COSTANTE">costanti</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" border="0" align="absmiddle">: 
        <i>FileDaAprire1</i> e <i>FileDaAprire2</i>. La prima conterr&agrave; 
        il nome del primo file da aprire, ovvero FILE1.TXT e la seconda conterr&agrave; 
        il nome dell'altro file da aprire (FILE2.TXT).</p>
      <ol class="codicevb" start="1">
        <li>Private Const FileDaAprire1 = &quot;FILE1.TXT&quot;</li>
        <li>Private Const FileDaAprire2 = &quot;FILE2.TXT&quot;</li>
        <li></li>
      </ol>
      <p>Segue la funzione legata all'evento Click sopra uno dei due pulsanti. 
        Poich&eacute; gli elementi sono in matrice, entrambi rispondono allo stesso 
        evento. Si differenziano tra loro per il parametro Index passato.<br>
        Ecco il codice completo che analizzeremo passo dopo passo:</p>
      <ol class="codicevb" start="4">
        <li>Private Sub PulsanteLeggi_Click(Index As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim BUFFER As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim NRFILE As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;CasellaTesto.Text = &quot;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;NRFILE = FreeFile</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Index = 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Open App.Path &amp; 
          &quot;\&quot; &amp; FileDaAprire1 For Binary As NRFILE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Open App.Path &amp; 
          &quot;\&quot; &amp; FileDaAprire2 For Binary As NRFILE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If LOF(NRFILE) &gt; 20000 Then MsgBox &quot;Il 
          file &eacute; pi&ugrave; grande di 20KB. Si potrebbe verificare un errore&quot;, 
          vbCritical</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;While Not EOF(NRFILE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = Space(2048)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get NRFILE, , BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = CasellaTesto.Text 
          &amp; BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CasellaTesto.Text 
          = BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Wend</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Close NRFILE</li>
        <li>End Sub</li>
      </ol>
      <p>Alle righe di codice 5 e 6 dichiariamo due variabili: <b><a href="../glossary/b.htm#BUFFER">BUFFER</a></b>, 
        utilizzata per immagazzinare i dati che provengono dalla lettura del file, 
        e <b>NRFILE</b>, un numero che identifica il file aperto.</p>
      <p>La prima operazione di questa routine consiste nell'azzerare il contenuto 
        precedente della casella di testo, con il semplice assegnamento di una 
        stringa nulla alla propriet&agrave; <i>Text</i> di <b>CasellaTesto</b>.</p>
      <p>Segue, alla riga 8, la ricerca di un numero di file libero. Infatti tutti 
        i files aperti con Visual Basic richiedono un numero di file. L'istruzione 
        <b><i>FreeFile</i></b> restituisce il prossimo numero di file libero.</p>
      <p>Subito segue un semplice controllo del parametro Index. Se esso &egrave; 
        0, ovvero &egrave; stato cliccato il primo pulsante, effettua l'apertura 
        del primo file, altrimenti apre il secondo file.</p>
      <p>L'istruzione <b><i>Open</i></b> che abbiamo alla settima e alla nona 
        riga ha questa sintassi:<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<b>Open</b> NOMEFILE <b>For</b> MODALIT&Agrave; 
        <b>As</b> NUMEROFILE</p>
      <p>NOMEFILE ovviamente indica il percorso completo del file da aprire.<br>
        MODALIT&Agrave; indica l'utilizzo che vogliamo effettuare con il file.<br>
        NUMEROFILE indica un numero che identificher&agrave; univocamente il file 
        da aprire.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La modalit&agrave; di apertura cambia il modo di recupero dei dati dal 
        file aperto. Il parametro MODALIT&Agrave; pu&ograve; assumere uno di questi 
        valori:</p>
      <ul>
        <li>APPEND - &Egrave; possibile soltanto aggiungere dati alla fine del 
          file.</li>
        <li>BINARY - Lettura e scrittura in maniera binaria.</li>
        <li>INPUT - Lettura dal file.</li>
        <li>OUTPUT - Scrittura del file.</li>
        <li>RANDOM - Modalit&agrave; casuale.</li>
      </ul>
      <p>Le nostre istruzioni alle righe 10 e 12 innanzitutto ricavano il nome 
        del file da aprire. Abbiamo detto che le costanti <b>FileDaAprire1</b> 
        e <b>FileDaAprire2</b> contengono il nome del file da aprire, ma non il 
        suo percorso fisico. Sappiamo che entrambi i files si trovano all'interno 
        della cartella del programma.<br>
        Effettueremo quindi una ricostruzione del nome del file: <i>App.Path</i> 
        indica il percorso della cartella del programma. A questo aggiungiamo 
        una barra di separazione di directory ed infine il nome del file, attraverso 
        le due costanti viste in precedenza.</p>
      <p>Conoscendo quindi il percorso, l'istruzione effettua un'apertura in modalit&agrave; 
        <b>Binary</b> utilizzando il numero del file contenuto nella variabile 
        <b>NRFile</b>, che in effetti &egrave; il primo numero libero utilizzabile 
        per aprire un file.</p>
      <p>Alla riga 14 abbiamo un controllo d'obbligo: poich&eacute; ci accingiamo 
        a visualizzare il contenuto del file all'interno di una TextBox &egrave; 
        fondamentale considerare che se il testo complessivo supera i 20 KB quasi 
        sicuramente si generer&agrave; un errore.</p>
      <p>Nel nostro progetto abbiamo inserito due files: uno di dimensione piccola 
        ed un altro di dimensione maggiore di 20 KB.</p>
      <p>Il controllo che viene effettuato &egrave; tramite l'istruzione <i>LOF</i> 
        ovvero Length Of File, che riporta la dimensione del file aperto in bytes. 
        Se tale numero &egrave; maggiore di 20000 bytes, avverte l'utente con 
        un avviso, tramite l'istruzione <i>MsgBox</i>.</p>
      <p>Segue un ciclo di lettura che si ripeter&agrave; fin quando non verr&agrave; 
        letto l'intero file:</p>
      <ol class="codicevb" start="15">
        <li>While Not EOF(NRFILE)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = Space(2048)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Get NRFILE, , BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;BUFFER = CasellaTesto.Text &amp; BUFFER</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;CasellaTesto.Text = BUFFER</li>
        <li>Wend</li>
      </ol>
      <p>L'istruzione <i>EOF</i> - End Of File - controlla se la posizione di 
        lettura ha raggiunto la fine del file. Per cui, fintanto che tale posizione 
        non &egrave; raggiunta verranno eseguite le righe 16, 17, 18 e 19.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La prima di queste righe prepara un buffer di lettura di 2 KB.<br>
        Fatto questo possiamo effettuare la vera lettura del file. L'istruzione 
        <i>Get</i> &egrave; quella che si occupa di questa funzione. Essa richiede 
        un numero di file ed il nome di una variabile dove memorizzare i dati 
        (BUFFER).</p>
      <p>Letto il buffer di 2KB aggiungiamo all'inizio d'esso il contenuto attuale 
        della casella di testo, contenuto che verr&agrave; aggiornato alla riga 
        successiva. Le righe 18 e 19 camminano di pari passo. La seconda riceve 
        il contenuto dalla prima e la prima nel passaggio successivo aggiunge 
        il contenuto del buffer al contenuto precedente.</p>
      <p>Lo svantaggio principale di questo genere di operazioni &egrave; che 
        per ogni istruzione vengono passate grosse quantit&agrave; di dati. I 
        2KB di buffer alla seconda operazione diventano 4, poi 6, etc...</p>
      <p>Alla riga 21 segue un'istruzione d'obbligo. La chiusura del file. Infatti 
        tutti i files aperti tramite l'istruzione Open rimangono bloccati fintanto 
        che non viene chiuso il numero del file associato ad essi.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il programmino &egrave; finito. L'utilizzo &egrave; estremamente facile. 
        Il click sopra uno dei due pulsanti effettua la lettura del file corrispondente.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        22 Novembre 2000<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
