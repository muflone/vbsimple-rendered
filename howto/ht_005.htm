<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Centrare un form sullo schermo</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Centrare un form sullo schermo<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <ul>
        <li><a href="ht_005.htm#STEP1">Centrare un form in fase di progettazione</a>.</li>
        <li><a href="ht_005.htm#STEP2">Centrare un form sullo schermo mediante 
          la pressione di un pulsante</a>.</li>
        <li><a href="ht_005.htm#STEP3">Creazione di una funzione per centrare 
          un form sullo schermo</a>.</li>
      </ul>
      <hr>
      <p align="center" class="size3"><a name="STEP1"></a>Centrare un form in 
        fase di progettazione</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"> 
        1 / 5</p>
      <p>Centrare un form sullo schermo in <a href="../glossary/f.htm#FASEDIPROGETTAZIONE">fase 
        di progettazione</a>, ovvero ancora prima che venga avviato il programma, 
        &egrave; un'operazione semplicissima.</p>
      <p>Si tratta, infatti di impostare la propriet&agrave; <i>StartUpPosition</i> 
        a <b>1&nbsp;-&nbsp;CenterOwner</b> oppure a <b>2&nbsp;-&nbsp;CenterScreen</b>. 
        La differenza tra i due valori riguarda la chiamata del form.<br>
        Se un form viene caricato e visualizzato da un altro e la propriet&agrave; 
        <i>StartUpPosition</i> del secondo &egrave; impostata a <b>1&nbsp;-&nbsp;CenterOwner</b>, 
        esso sar&agrave; centrato rispetto al suo form chiamante, e non rispetto 
        allo schermo.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Per posizionare un form al centro dello schermo &egrave; necessario impostare 
        la propriet&agrave; <i>StartUpPosition</i> del form a <b>2&nbsp;-&nbsp;CenterScreen</b>.</p>
      <p>Creiamo un nuovo form di nome <b>Form1</b>, impostiamo la propriet&agrave; 
        <i>StartUpPosition</i> a 2 e proviamo ad eseguire il progetto. All'avvio 
        del programma il form sar&agrave; al centro dello schermo.</p>
      <hr>
      <p align="center" class="size3"><a name="STEP2"></a>Centrare un form sullo 
        schermo mediante la pressione di un pulsante</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"> 
        1 / 5</p>
      <p></p>
      <p>Un caso del tutto differente &egrave; dato dal bisogno di centrare un 
        form sullo schermo in un momento specifico, non necessariamente all'avvio 
        del form. Un momento particolare pu&ograve; essere il click sopra un pulsante.</p>
      <p>A tal scopo inseriamo, sopra un nuovo form di nome <b>Form2</b>, un pulsante 
        <img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle"> 
        di nome <b>Centra</b>, cos&igrave; come appare nella figura 1.</p>
      <p align="center"><img src="../images/howto/howto005_01.jpg" width="306" height="66" alt="Figura 1"><br>
        <b>Figura 1</b></p>
      <p>&Egrave; palese che nel momento in cui l'utente clicca sul pulsante <b>Centra</b> 
        la finestra debba spostarsi al centro dello schermo.</p>
      <p>La formula generale per centrare qualcosa di una certa dimensione all'interno 
        di uno spazio di dimensione maggiore &egrave;: <code><b>(AREA - OGGETTO) 
        / 2</b></code>.</p>
      <p>Applicata al nostro progetto: <code><b>(Screen.Width - Me.Width) / 2</b></code> 
        per quanto riguarda l'asse X e <code><b>(Screen.Height - Me.Height) / 
        2</b></code> per l'asse Y.<br>
        Apriamo la finestra del codice e nella routine legata all'evento <i>Click</i> 
        sul pulsante <b>Centra</b> scriviamo:</p>
      <ol class="codicevb" start="1">
        <li>Dim X As Single</li>
        <li>Dim Y As Single</li>
        <li>X = (Screen.Width - Me.Width) / 2</li>
        <li>Y = (Screen.Height - Me.Height) / 2</li>
        <li>Me.Move X, Y</li>
      </ol>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Le prime due righe definiscono due variabili di nome X e Y. Esse saranno 
        utilizzate per stabilire le coordinate che dovr&agrave; assumere il form.<br>
        Alle righe 3 e 4 troviamo l'applicazione della formula vista poco prima.<br>
        L'ultima riga effettua il movimento del form alle coordinate X e Y.</p>
      <hr>
      <p align="center" class="size3"><a name="STEP3"></a>Creazione di una funzione 
        per centrare un form sullo schermo</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2 / 5</p>
      <p>Proveremo a generare una funzione generale per centrare qualsiasi form, 
        partendo dal codice che abbiamo visto precedentemente.</p>
      <p>Creiamo un nuovo modulo <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
        ed inseriamo all'interno d'esso la nostra funzione <b>CentraForm</b>. 
        Scriveremo per cui:</p>
      <ol class="codicevb" start="1">
        <li>Public Sub CentraForm(ByVal NomeForm As Form)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim X As Single</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim Y As Single</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;X = (Screen.Width - NomeForm.Width) / 2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Y = (Screen.Height - NomeForm.Height) / 2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;NomeForm.Move X, Y</li>
        <li>End Sub</li>
      </ol>
      <p>La funzione non introduce nulla di nuovo. Viene richiesto un parametro 
        di nome <b>NomeForm</b> della classe <i>Form</i>. Notiamo invece l'uso 
        di <i>ByVal</i> per la definizione del parametro.</p>
      <p>In realt&agrave; Visual Basic, cos&igrave; come il linguaggio C, quando 
        viene passato come parametro un oggetto, non viene effettuata una copia 
        intera dell'oggetto, ad esempio un form. Invece ogni riferimento ad un 
        oggetto caricato in memoria viene ridotto ad un semplice <a href="../glossary/p.htm#PUNTATORE">puntatore</a> 
        ad una locazione di memoria. La copia effettuata dall'utilizzo del <i>ByVal</i> 
        non provoca una copia dell'oggetto puntato.</p>
      <p>Nel nostro caso <b>NomeForm</b> contiene l'indirizzo del form caricato 
        in memoria. La copia del puntatore, tuttavia, punter&agrave; alla stessa 
        locazione di memoria.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>In conclusione l'utilizzo di <i>ByVal</i> invece di <i>ByRef</i> non 
        cambia nulla. In entrambi i casi ogni riferimento al parametro passato 
        si riflette sull'oggetto originario.<br>
        Vedi a tal proposito le <a href="../info/info_05.htm">informazioni aggiuntive 
        sulle funzioni</a>.</p>
      <p>Proviamo la nostra funzione: inseriamo un nuovo form di nome <b>Form3</b> 
        nel nostro progetto. All'interno del form inseriamo un pulsante di nome 
        <b>CentraButton</b>, apriamo la finestra del codice e scriviamo all'interno 
        dell'evento Click di CentraButton questa semplice istruzione:</p>
      <blockquote>CentraForm Me</blockquote>
      <p>La chiamata alla funzione <i>CentraForm</i> passer&agrave; come parametro 
        un puntatore al form dentro il quale si trova la chiamata.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>In ogni caso, si consiglia l'utilizzo della terza soluzione per due fondamentali 
        motivi: la riutilizzabilit&agrave; del codice e la semplicit&agrave; d'uso. 
      </p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        28 Novembre 2000<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
