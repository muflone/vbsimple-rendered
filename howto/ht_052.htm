<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Limitare il numero di caratteri in una ComboBox</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Limitare il numero di caratteri 
    in una ComboBox<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <ul>
        <li><a href="ht_052.htm#STEP1">Limitare una ComboBox senza l'utilizzo 
          dell'API</a>.</li>
        <li><a href="ht_052.htm#STEP2">Limitare una ComboBox con l'utilizzo dell'API</a>. 
          <img src="../images/api.gif" width="34" height="24" align="absmiddle"> 
        </li>
      </ul>
      <hr>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p align="center" class="size3"><a name="STEP1"></a>Limitare una ComboBox 
        senza l'utilizzo dell'API</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"> 
        1 / 5</p>
      <p>Stranamente i controlli <b>ComboBox</b> <img src="../images/controls/combobox.gif" width="25" height="25" align="absmiddle"> 
        non possiedono una propriet&agrave; <i>MaxLength</i> che consenta di limitare 
        il numero di carattere ammessi nella casella, analogamente alle <b>TextBox</b>. 
        Talvolta per&ograve; si rende necessario impedire all'utente l'immissione 
        di un numero di caratteri superiore.</p>
      <p>Limitare il numero di caratteri immessi in una ComboBox &egrave; un'operazione 
        molto semplice e questa prima parte dell'articolo utilizzer&agrave; un 
        banalissimo controllo dei tasti digitati, in modo da rifiutare i caratteri 
        in eccesso prima che vengano inviati al controllo e visualizzati.</p>
      <p>Il codice &egrave; orientato intorno all'evento<img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle"><i><b>KeyPress</b></i> 
        della singola ComboBox:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Const lngMaxCaratteri As Long = 10</li>
        <li></li>
        <li>Private Sub cboMetodo1_KeyPress(KeyAscii As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If Len(cboMetodo1.Text) &gt;= intMaxCaratteri 
          And (KeyAscii &lt;&gt; vbKeyBack) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyAscii = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>End Sub</li>
      </ol>
      <p>La costante <b>lngMaxCaratteri</b> stabilisce il numero di caratteri 
        ammessi all'interno della ComboBox <b>cboMetodo1</b>. Alla riga 6 &egrave; 
        svolto il controllo sulla lunghezza attuale del testo inserito nella casella 
        e sull'eventuale tasto BackSpace, in modo da non ammettere ulteriori caratteri 
        ad eccezione del tasto di cancellazione. Al verificarsi di queste due 
        condizioni, il carattere digitato sar&agrave; semplicemente ignorato.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Il controllo sembra funzionare correttamente ma presenta un grossissimo 
        limite: &egrave; impedita s&igrave; la digitazione di un testo pi&ugrave; 
        ampio di quello consentito (10 caratteri) ma non &egrave; impedita l'operazione 
        <i> <b>Incolla</b></i>, effettuabile mediante tastiera oppure mediante 
        Menu popup.</p>
      <hr>
      <p align="center" class="size3"><a name="STEP2"></a>Limitare una ComboBox 
        con l'utilizzo dell'API</p>
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2 / 5</p>
      <p>Tale limite pu&ograve; essere superato facendo uso dell'<a href="../glossary/a.htm#API">API</a>, 
        inviando il <a href="../glossary/m.htm#MESSAGGIO">messaggio</a> <i><b>CB_LIMITTEXT</b></i> 
        alla ComboBox. Il messaggio pu&ograve; essere inviato mediante la funzione 
        <i>SendMessage</i>, trattata in molti altri articoli in questa sezione.</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Declare Function SendMessage Lib &quot;user32&quot; Alias 
          &quot;SendMessageA&quot; (ByVal hwnd As Long, ByVal wMsg As Long, ByVal 
          wParam As Long, lParam As Any) As Long</li>
        <li></li>
        <li>Private Const CB_LIMITTEXT = &amp;H141</li>
        <li>Private Const lngMaxCaratteri As Long = 10</li>
        <li></li>
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call SendMessage(cboMetodo2.hwnd, CB_LIMITTEXT, 
          lngMaxCaratteri, ByVal 0&amp;)</li>
        <li>End Sub</li>
      </ol>
      <p>La funzione API SendMessage &egrave; dichiarata alla riga 3, mentre alla 
        riga 5 &egrave; dichiarata la <a href="../glossary/c.htm#COSTANTE">costante</a> 
        <img src="../images/ide/costante.gif" width="16" height="16" align="absmiddle"> 
        API <i><b>CB_LIMITTEXT</b></i>, utilizzata per specificare il messaggio 
        da inviare alla ComboBox. La costante <b>lngMaxCaratteri</b> specificher&agrave; 
        il numero massimo di caratteri ammessi.<br>
        Cos&igrave; al caricamento del Form sar&agrave; inviato il messaggio alla 
        finestra ComboBox.</p>
      <p>Questa soluzione consente non solo di impedire la digitazione di un numero 
        di caratteri superiore a quelle previsto ma anche di impedire l'operazione 
        Incolla dagli <a href="../glossary/a.htm#APPUNTI">Appunti</a> di Windows. 
        Un altro vantaggio &egrave; quello di poter sfruttare la caratteristica 
        di autoselezione della casella: nel momento in cui la ComboBox diventa 
        il controllo attivo il testo &egrave; <a href="ht_002.htm">automaticamente 
        selezionato</a> e la pressione di un tasto qualsiasi ad eccezione delle 
        freccette provoca la sostituzione del testo precedente con quello appena 
        digitato.</p>
      <p>Inoltre la limitazione pu&ograve; essere disabilitata inviando semplicemente 
        il messaggio <i><b>CB_LIMITTEXT</b></i> ed il valore 0, anzich&eacute; 
        il numero massimo di caratteri ammessi. Questo determina una pi&ugrave; 
        facile gestione della casella combinata.<br>
        <br>
      </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Nella stragrande maggioranza dei casi si raccomanda l'uso della seconda 
        soluzione e nel progetto sviluppato sono utilizzate entrambe le soluzioni 
        per permettere un diretto confronto.</p>
      <p>La possibilit&agrave; di disabilitare con facilit&agrave; la limitazione 
        &egrave; una ragione in pi&ugrave; per preferire la seconda soluzione 
        a quella interamente basata su Visual Basic.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a> e <a href="../vbmail.htm?id=9">Tielle</a><br>
        16 Dicembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
