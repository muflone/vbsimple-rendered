<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Calcolo del numero dei giorni lavorativi tra due date</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Calcolo del numero dei giorni 
    lavorativi tra due date<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>In questo HowTo vedremo come sviluppare una semplice funzione che restituisce 
        il numero dei giorni lavorativi tra due date. La funzione non far&agrave; 
        il calcolo di eventuali feste infrasettimanali, ma conter&agrave; soltanto 
        il numero di giorni della settimana che non sono n&eacute; sabato n&eacute; 
        domenica.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La funzione che andremo a scrivere si chiamer&agrave; <b><i>GiorniLavorativi</i></b> 
        e richieder&agrave; che siano passati come parametri due date: <i>DataInizio</i> 
        e <i>DataFine</i>.</p>
      <ol class="codicevb" start="1">
        <li>Function GiorniLavorativi(DataInizio As Date, DataFine As Date) As 
          Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim GiornoSettimana As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;GiorniLavorativi = 0</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;While DataInizio &lt;= DataFine</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GiornoSettimana = 
          Format(DataInizio, &quot;w&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If (GiornoSettimana 
          &lt;&gt; vbSaturday) And (GiornoSettimana &lt;&gt; vbSunday) Then GiorniLavorativi 
          = GiorniLavorativi + 1</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataInizio = DateAdd(&quot;d&quot;, 
          1, DataInizio)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Wend</li>
        <li>End Function</li>
      </ol>
      <p> Utilizzeremo la variabile <b>GiornoSettimana</b> per ritrovare il giorno 
        all'interno della settimana (luned&igrave;, marted&igrave;, etc...). </p>
      <p>Alla riga 4 inizia un ciclo che durer&agrave; fintanto che DataInizio 
        sar&agrave; minore o uguale di DataFine. All'interno del ciclo viene ritrovato 
        il giorno settimanale tramite la funzione <i>Format</i> e successivamente 
        verr&agrave; controllato se esso non &egrave; n&eacute; sabato n&eacute; 
        domenica. In tal caso il valore di <b>GiorniLavorativi</b> verr&agrave; 
        incrementato di 1 (riga 6).<br>
        Effettuata questa operazione verr&agrave; aumentato il valore di DataInizio 
        di un giorno. Subito dopo l'incremento verr&agrave; paragonato nuovamente 
        il valore di DataInizio con DataFine.</p>
      <p>Alla fine del ciclo la variabile <b>GiorniLavorativi</b> conterr&agrave; 
        il numero di giorni lavorativi che verr&agrave; restituito all'uscita 
        della funzione.</p>
      <p></p>
      <p><img src="../images/howto/howto008_01.jpg" width="258" height="112" align="right" alt="Figura 1">Vediamo 
        ora l'interfaccia grafica. Inseriamo nel nostro form due Frames<img src="../images/controls/frame.gif" width="25" height="25" align="absmiddle">di 
        nome <b>DataInizialeFrame</b> e <b>DataFinaleFrame</b>.<br>
        All'interno del primo inseriremo una matrice di OptionButton<img src="../images/controls/optionbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>DataIniziale</b>; avremo per cui quattro elementi con <i>Index</i> 
        dallo 0 al 3.<br>
        All'interno del secondo frame inseriremo un'altra matrice di OptionButton<img src="../images/controls/optionbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>DataFinale</b>; anch'essa avr&agrave; propriet&agrave; <i>Index</i> 
        da 0 a 3.<br>
        Ogni OptionButton avr&agrave; una data impostata nella sua <i>Caption</i>.</p>
      <p>All'interno del form inseriamo anche un pulsante di comando<img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>Calcola</b> ed una TextBox <img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle"> 
        di nome <b>Risultato</b>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Com'&egrave; facilmente intuibile, al momento del click sopra il pulsante 
        Calcola verr&agrave; calcolato il numero di giorni lavorativi tra le due 
        date selezionate. Il risultato verr&agrave; scritto nella casella di testo 
        in basso a destra. </p>
      <ol class="codicevb" start="1">
        <li>Private Sub Calcola_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim CONTA As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim PrimaData As Date</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim SecondaData As Date</li>
      </ol>
      <p>Abbiamo dichiarato tre variabili: <i>CONTA</i> servir&agrave; per analizzare 
        i quattro elementi delle due matrici, alla ricerca del pulsante tra i 
        quattro selezionato.<br>
        <i>PrimaData</i> e <i>SecondaData</i> serviranno per convertire in formato 
        di data le <i>Caption</i> dei pulsanti di opzione.</p>
      <ol class="codicevb" start="5">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;For CONTA = 0 To 3</li>
      </ol>
      <p>Qui comincia un ciclo che analizza i singoli elementi delle matrici di 
        OptionButtons.</p>
      <ol class="codicevb" start="6">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If DataIniziale(CONTA).Value 
          = True Then PrimaData = DataIniziale(CONTA).Caption</li>
      </ol>
      <p>Questo ciclo si ripeter&agrave; quattro volte: ogni volta viene controllato 
        se l'elemento in analisi ha la propriet&agrave; <i>Value</i> impostata 
        a True. Se non &egrave; cos&igrave;, non accade nulla. Se la propriet&agrave; 
        Value &egrave; True viene memorizzata in formato di data quella indicata 
        nella propriet&agrave; <i>Caption</i> del pulsante di opzione. Questa 
        conversione &egrave; necessaria perch&eacute; la funzione <b>GiorniLavorativi</b> 
        richiede due variabili di <a href="../info/info_04.htm">tipo Date</a>.</p>
      <ol class="codicevb" start="7">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If DataFinale(CONTA).Value 
          = True Then SecondaData = DataFinale(CONTA).Caption</li>
      </ol>
      <p>Lo stesso tipo di controllo viene effettuato sulla data finale.</p>
      <ol class="codicevb" start="8">
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Next CONTA</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Risultato.Text = GiorniLavorativi(PrimaData, 
          SecondaData)</li>
        <li>End Sub</li>
      </ol>
      <p>La riga 9 effettua la chiamata alla funzione <b>GiorniLavorativi</b> 
        e scrive il numero riportato da essa nella casella di testo <b>Risultato</b>.<br>
        <br>
      </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Possiamo provare il progetto.</p>
      <p align="center"><img src="../images/howto/howto008_02.jpg" width="258" height="112" alt="Figura 2"><br>
        <b>Figura 2</b> </p>
      <p>Basta selezionare due pulsanti di opzione, premere il tasto <b>Calcola</b> 
        per vedere apparire il numero di giorni lavorativi tra le due date scelte.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        1 Dicembre 2000<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
