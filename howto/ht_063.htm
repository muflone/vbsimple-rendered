<html>
<!-- #BeginTemplate "/Templates/HowTo.dwt" --> 
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Realizzare un orologio</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr> 
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home 
        Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> 
        <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>
<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Realizzare un orologio<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"> 
        3<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script>
      <!-- #BeginEditable "CORPO" --><p>La domanda mi &egrave; stata posta tantissime 
        volte che date le numerose richieste ho deciso di realizzarne un articolo 
        accessibile a tutti; per una corretta comprensione si raccomanda una conoscenza 
        sommaria della geometria del cerchio.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto063_1.png" width="158" height="202" align="left" alt="Figura 1">Verr&agrave; 
        realizzato un orologio analogico, quello con le lancette, per capirci, 
        il tutto con pochissime righe di codice, sfruttando gli oggetti Line ed 
        assegnando loro le coordinate dovute. Il form si comporr&agrave; di un 
        controllo <b><i>Timer</i></b><img src="../images/controls/timer.gif" width="25" height="25" align="absmiddle"> 
        di nome <b>tmrTimer</b> che scandir&agrave; i secondi, quindi con la sua 
        propriet&agrave; <i>Interval</i> impostata su 1000 millisecondi (1 secondo); 
        ad esso aggiungeremo 3 controlli <i><b>Line</b></i><img src="../images/controls/line.gif" width="25" height="25" align="absmiddle">dai 
        nomi <b>linSeconds</b>, <b>linMinutes</b> e <b>linHours</b>, senza preoccuparci 
        delle loro coordinate. Per distinguere le 3 lancette abbiamo preferito 
        assegnar loro 3 differenti colori (<i>BorderColor</i>) e spessori (<i>BorderWidth</i>). 
        In fondo al form abbiamo anche aggiunto una <i><b>Label</b></i> di nome 
        <b>lblOre</b> che riproduca l'orario in maniera digitale affiancato dalla 
        data corrente.</p>
      <p>Per rendere l'orologio pi&ugrave; realistico abbiamo fatto in modo che 
        lo spostamento della lancetta delle ore avvenisse gradualmente, in maniera 
        legata ai minuti, anzich&eacute; scattare da un'ora all'altra con uno 
        spostamento di 30&deg; (360/12) per volta. Lo stesso procedimento &egrave; 
        stato applicato alla lancetta dei minuti, sincronizzata con l'avanzare 
        dei secondi.</p>
      <p>Quasi tutto il codice si trova all'interno di una routine richiamata 
        dall'evento <i>Timer</i> del controllo <b>tmrTimer</b> ma prima di vederla 
        in dettaglio affrontiamo quei piccoli accorgimenti necessari alla preparazione 
        della superficie su cui si muoveranno le lancette:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Const PI As Single = 3.1415</li>
        <li>Private Const intCenterX As Integer = 1400</li>
        <li>Private Const intCenterY As Integer = 1400</li>
        <li></li>
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;linHours.ZOrder vbSendToBack</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;linMinutes.ZOrder vbBringToFront</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;linSeconds.ZOrder vbBringToFront</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Me.DrawStyle = vbDot</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Me.Circle (intCenterX, intCenterY), 1300, 
          vbRed</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;tmrTimer_Timer</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>La costante <b>PI</b> rappresenta semplicemente il PI greco, fondamentale 
        per qualsiasi operazione basata sulle ellissi. Incredibile a dirsi in 
        Visual Basic questa costante non esiste da nessuna parte. Le altre due 
        costanti <b>intCenterX</b> e <b>intCenterY</b> indicano la posizione del 
        centro dell'orologio. Saranno utilizzate per il posizionamento delle tre 
        lancette.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>All'avvio del form sar&agrave; opportuno assicurare la posizione delle 
        lancette sull'asse Z, ponendo quella delle ore sotto tutte e quella dei 
        secondi sopra tutte le altre, per evitar in tal modo che la lancetta delle 
        ore copra parte di quella dei minuti o dei secondi.</p>
      <p>Alle righe 11 e 12 sar&agrave; disegnato un semplice cerchio all'interno 
        del quale si muovono le nostre lancette; il cerchio ha un raggio poco 
        superiore al raggio della lancetta dei secondi, la pi&ugrave; lunga delle 
        tre. Sar&agrave; immediatamente richiamato l'evento Timer per posizionare 
        subito le nostre lancette e non dover attendere il passaggio del primo 
        secondo per aggiornare lo schermo.</p>
      <ol start="16" class="codicevb">
        <li>Private Sub tmrTimer_Timer()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim Orario As Date</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Orario = Now</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;RefreshLine linHours, (Hour(Orario) Mod 12) 
          + Minute(Orario) / 60, 12, 800</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;RefreshLine linMinutes, (Minute(Orario) + 
          Second(Orario) / 60), 60, 1000</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;RefreshLine linSeconds, Second(Orario), 60, 
          1200</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;lblOre.Caption = &quot;Sono le ore: &quot; 
          &amp; Format$(Orario, &quot;hh:nn:ss&quot;) &amp; vbNewLine &amp; _</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;di &quot; &amp; 
          Format$(Orario, &quot;dddd dd mmmm yyyy&quot;)</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Ad ogni secondo scatter&agrave; questa routine che si occuper&agrave; 
        di richiamare la funzione <b>RefreshLine</b> che ridisegner&agrave; la 
        lancetta specificata nel primo argomento; ogni lancetta sar&agrave; disegnata 
        autonomamente e successivamente saranno indicati nella Label <b>lblOre</b> 
        data e ora correnti.</p>
      <ol start="26" class="codicevb">
        <li>Private Sub RefreshLine(ByRef Line As Line, ByVal Value As Single, 
          ByVal Divisor As Integer, ByVal Radius As Integer)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim SngAngle As Single</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;SngAngle = Value * (2 * PI / Divisor) - (PI 
          / 2)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;With Line</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.X1 = intCenterX</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Y1 = intCenterY</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If (SngAngle &lt; 
          PI) And (SngAngle &gt;= 0) Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Y2 
          = intCenterY + Abs(Radius * Sin(SngAngle))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Y2 
          = intCenterY - Abs(Radius * Sin(SngAngle))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.X2 = intCenterX + 
          Radius * Cos(SngAngle)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End With</li>
        <li>End Sub</li>
      </ol>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto063_2.png" width="158" height="202" align="right" alt="Figura 2">La 
        routine <b>RefreshLine</b> &egrave; il centro di questo problema: essa 
        riceve 4 argomenti di cui il primo indica l'oggetto <i>Line</i> da muovere, 
        il secondo indica il valore del divisore (terzo parametro) e l'ultimo 
        parametro indica il raggio della linea da tracciare. Per chiarire il problema 
        il cerchio di 360&deg; viene diviso in tante parti quante indicate in 
        <b>Divisor</b> e la lancetta verr&agrave; posizionata in funzione dell'argomento 
        <b>Value</b>. La variabile <b>sngAngle</b> verr&agrave; utilizzata per 
        determinare l'angolo in radianti alla cui fine sar&agrave; posizionata 
        la lancetta.</p>
      <p>Il calcolo da effettuare &egrave; molto semplice: determinato l'angolo 
        semplicemente dividendo l'angolo giro (doppio PI greco) in tante parti 
        quante indicate in Divisor e moltiplicando per il valore, sottraiamo 90&deg; 
        (PI / 2) per spostare l'origine alle ore 12, anzich&eacute; alle ore 3, 
        origine del cerchio.</p>
      <p>Ottenuto <b>sngAngle</b>, con due semplici operazioni saranno determinate 
        le coordinate X e Y finali della lancetta; alle righe 30 e 31 sono posizionate 
        le origini, quindi, in funzione che l'angolo sia positivo o negativo, 
        sar&agrave; calcolata la coordinata finale, aggiungendo, in caso di segno 
        positivo, al centro la distanza data da raggio per il seno dell'angolo 
        (coordinata Y) o sottraendola in caso di angolo negativo; per quanto riguarda 
        la coordinata X baster&agrave; moltiplicare il raggio per il coseno dello 
        stesso angolo.</p>
      <p>Questa procedura verr&agrave; ripetuta per tutte e tre le lancette, ed 
        ognuna delle quali verr&agrave; posizionata al suo corrispondente punto. 
        Il risultato &egrave; quello mostrato nella figura a fianco.</p>
      <!-- #EndEditable --></td>
  </tr>
</table>
<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Si tratta di un problema a prima vista difficile ma una semplice conoscenza 
        della geometria di base delle ellissi &egrave; in grado di risolvere il 
        problema con estrema semplicit&agrave;.</p>
      <!-- #EndEditable --> 
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        27 Agosto 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem --> </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr> 
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>
<hr width="80%">
<table width="100%">
  <tr> 
    <td width="100%" align="center"> 
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""--> </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate -->
</html>
