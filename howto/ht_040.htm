<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Avviare le applet del pannello di controllo</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Avviare le applet del pannello 
    di controllo<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Alcuni programmi che operano con le impostazioni del sistema possono 
        dover presentare all'utente la possibilit&agrave; di modificare i dati 
        tramite le applet del pannello di controllo, quei piccoli programmi che 
        regolano il comportamento delle impostazioni del computer in uso.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Vedremo in questo semplice HowTo come richiamare tali applet per permettere 
        all'utente la visualizzazione o la modifica dei dati del sistema. Utilizzeremo 
        una soluzione molto semplice, la stessa che utilizza Windows quando l'utente 
        clicca due volte sull'icona di un file del pannello di controllo; questi 
        files avranno <a href="../glossary/e.htm#ESTENSIONEFILES">estensione</a> 
        CPL.</p>
      <p><img src="../images/howto/howto040_01.png" width="214" height="67" align="right" alt="Figura 1">Il 
        nostro progetto si comporr&agrave; di un solo e semplice form su cui saranno 
        presenti due <i>Label</i> descrittive, una <i>ComboBox</i> <img src="../images/controls/combobox.gif" width="25" height="25" align="absmiddle">di 
        nome <b>cboApplets</b> con la propriet&agrave; <b>Style</b> impostata 
        su <i><b>2&nbsp;-&nbsp;Dropdown List</b></i> in modo da non consentire 
        l'immissione di dati all'utente. Oltre questa abbiamo una <i>TextBox</i> 
        di nome <b>txtNumeroPagina</b> ed un <i>CommandButton</i> di nome <b>cmdApriApplet</b>. 
        Il funzionamento &egrave; davvero semplice: l'utente dovr&agrave; semplicemente 
        scegliere l'applet che desidera aprire tramite la <i>ComboBox</i>, inserire 
        opzionalmente il numero di pagina dell'applet e premere il grande pulsante.</p>
      <p><img src="../images/howto/howto040_02.png" width="327" height="54" align="right" alt="Figura 2">Per 
        numero di pagina intendiamo la scheda (TabStrip) dell'applet richiamata. 
        Quasi tutte le applet, infatti contengono molte informazioni, suddivise 
        in categorie tra le varie pagine. Mediante l'utilizzo di questo codice 
        potremo non solo specificare quale applet avviare ma anche la pagina corrispondente 
        da mostrare all'utente.</p>
      <p>La prima operazione da effettuare all'avvio del nostro progetto sar&agrave; 
        quella di ricercare tutte le applet, ovvero tutti i files con estensione 
        CPL presenti nella cartella System (se usiamo Windows 9x/ME) o System32 
        (se usiamo Windows NT). L'operazione di elencazione di tutti i files corrispondenti 
        ad un criterio &egrave; <a href="ht_014_2.htm">trattata in un altro HowTo</a> 
        con la piccolissima differenza che invece di utilizzare una ListBox questo 
        caso utilizza una ComboBox. Vediamo il nostro codice:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Declare Function GetSystemDirectory Lib &quot;kernel32&quot; 
          Alias &quot;GetSystemDirectoryA&quot; (ByVal lpBuffer As String, ByVal 
          nSize As Long) As Long</li>
        <li>Private Declare Function SendMessage Lib &quot;USER32&quot; Alias 
          &quot;SendMessageA&quot; (ByVal hwnd As Long, ByVal wMsg As Long, ByVal 
          wParam As Long, lParam As Any) As Long</li>
        <li>Private Const CB_DIR = &amp;H145</li>
        <li></li>
      </ol>
      <p>Alla riga 3 abbiamo dichiarato la funzione <a href="../glossary/a.htm#API">API</a> 
        <i>GetSystemDirectory</i> che recuperer&agrave; il percorso della cartella 
        System o System32 del computer. Abbiamo detto infatti che tutte le applet 
        conosciute dal pannello di controllo risiedono l&igrave; dentro.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Alla riga 4 &egrave; dichiarata la funzione API <i>SendMessage</i> che 
        utilizzeremo per recuperare con estrema semplicit&agrave; tutte le applet 
        contenute nella cartella. Il messaggio che invieremo sar&agrave; quello 
        definito alla riga successiva, corrispondente alla costante <img src="../images/ide/costante.gif" width="16" height="16" align="absmiddle"> 
        API <b>CB_DIR</b>.</p>
      <ol class="codicevb" start="7">
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Const lngFilesTutti = vbReadOnly Or vbHidden 
          Or vbSystem Or vbArchive</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim strPercorso As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strPercorso = Space$(255)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strPercorso = Left$(strPercorso, GetSystemDirectory(strPercorso, 
          255)) &amp; &quot;\*.CPL&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call SendMessage(cboApplets.hwnd, CB_DIR, 
          lngFilesTutti, ByVal strPercorso)</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>E cos&igrave;, all'avvio del form viene costruita la stringa che indicher&agrave; 
        il percorso della cartella da cui ritrovare i files CPL. Alla riga 8 definiamo 
        una costante di nome <b>lngFilesTutti</b> corrispondente alla combinazione 
        dei vari attributi dei files. Questa sar&agrave; utilizzata durante la 
        ricerca dei files. Alla riga 10 viene <a href="../glossary/a.htm#ALLOCARE">allocato</a> 
        lo spazio necessario ed alla riga successiva viene ritrovata la cartella 
        System o System32 tramite la funzione API <i>GetSystemDirectory</i>.<br>
        A questo percorso verr&agrave; aggiunto il filtro tramite <a href="../glossary/c.htm#CARATTERIJOLLY">caratteri 
        jolly</a> <b>*.CPL</b>.</p>
      <p>Completata la costruzione del percorso e del filtro di ricerca richiederemo 
        alla funzione API <i>SendMessage</i> l'autoelencazione di tutti i files 
        CPL specificando innanzitutto l'handle della ComboBox, il messaggio CB_DIR, 
        il tipo di ricerca da effettuare ed il percorso.</p>
      <ol class="codicevb" start="15">
        <li>Private Sub cmdApriApplet_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call Shell(&quot;Rundll32.exe shell32.dll,Control_RunDLL 
          &quot; &amp; cboApplets.Text &amp; &quot;,,&quot; &amp; CStr(Val(txtNumeroPagina.Text)))</li>
        <li>End Sub</li>
      </ol>
      <p>L'unico evento da gestire nel nostro progetto riguarda il click sull'unico 
        pulsante <b>cmdApriApplet</b> per richiedere l'apertura dell'applet corrispondente, 
        operazione che effettueremo tramite l'utilizzo dell'utility RUNDLL32. 
        La stringa con cui richiamiamo l'applet proviene dal <a href="../glossary/r.htm#REGISTRO">registro</a> 
        di Windows. Abbiamo infatti detto che lo stesso Windows (pi&ugrave; precisamente 
        Explorer) utilizza questa tecnica per richiamare i files CPL.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>La stringa si compone del nome dell'utility Rundll32 seguita dalla libreria 
        shell32.dll da cui richiamare la funzione API Control_RunDLL. Tra il nome 
        della libreria e della funzione &egrave; richiesta la presenza di una 
        virgola. Tutto quello che seguir&agrave; sono i dati da fornire alla funzione 
        API Control_RunDLL e pi&ugrave; precisamente il nome, senza necessit&agrave; 
        del percorso, dell'applet da richiamare; il secondo parametro non &egrave; 
        utilizzato mentre il terzo indicher&agrave; il numero della pagina da 
        richiamare, specificata nella casella di testo <b>txtNumeroPagina</b>.</p>
      <p>Un esempio di stringa pu&ograve; essere: <code>&quot;Rundll32.exe shell32.dll,Control_RunDLL 
        desk.cpl,,0&quot;</code> che indica l'apertura dell'applet &quot;Propriet&agrave; 
        schermo&quot; alla pagina 1. Tale stringa verr&agrave; poi lanciata tramite 
        l'istruzione <i><b>Shell</b></i>.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p><img src="../images/notes.gif" width="56" height="57" align="right">Un 
        trucchetto interessante consiste nel non passare il nome dell'applet alla 
        funzione Control_RunDLL. Verr&agrave; allora aperto il pannello di controllo 
        dal quale l'utente potr&agrave; scegliere l'applet che desidera caricare.<br>
        Sar&agrave; possibile provare questo trucchetto lanciando il nostro progetto 
        e, senza scegliere alcuna applet dalla <i>ComboBox</i>, premere il <i>CommandButton</i>.</p>
      <p>Il difetto principale di questa soluzione &egrave; rappresentato dall'impossibilit&agrave; 
        di scegliere alcune schede di alcune applet. Questo codice non richiamer&agrave; 
        infatti tutte le pagine a disposizione dell'utente ma soltanto una parte 
        di queste.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        27 Febbraio 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
