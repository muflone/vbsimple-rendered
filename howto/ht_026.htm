<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Scrivere il contenuto di una casella di testo in un file</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Scrivere il contenuto di 
    una casella di testo in un file<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Questo HowTo completa l'operazione effettuata in un <a href="ht_003.htm">altro 
        HowTo</a> ovvero la lettura del contenuto di un file. Questa volta effettueremo 
        l'operazione inversa, ovvero la scrittura del contenuto di una casella 
        di testo in un file di testo.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto026_01.jpg" width="293" height="170" align="right" alt="Figura 1">Il 
        progetto in questione si compone di tre soli controlli posti sopra un 
        form.<br>
        Il primo controllo &egrave; una <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
        nome <b>Testo</b>, con la propriet&agrave; <i>MultiLine</i> impostata 
        a True. Questo far&agrave; s&igrave; che sia possibile scrivere del testo 
        a pi&ugrave; righe, separando le righe tra loro tramite il tasto <b>Invio</b>.</p>
      <p>Il secondo controllo &egrave; un'altra <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle">di 
        nome <b>NomeFile</b>. Essa dovr&agrave; contenere il nome del file con 
        il quale salvare il testo della casella soprastante.</p>
      <p>Infine, l'ultimo controllo &egrave; un <i>CommandButton</i><img src="../images/controls/commandbutton.gif" width="25" height="25" align="absmiddle">di 
        nome <b>btnSalva</b>, che effettuer&agrave; il salvataggio del testo contenuto 
        nella casella di testo <b>Testo</b>.</p>
      <p>Il codice si compone di una sola routine legata all'<a href="../glossary/e.htm#EVENTO">evento</a><img src="../images/ide/evento.gif" width="16" height="16" align="absmiddle">Click 
        sopra il pulsante <b>btnSalva</b>:</p>
      <ol class="codicevb" start="1">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub btnSalva_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim NRFILE As Integer</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;On Error GoTo ERRORE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;NRFILE = FreeFile</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Open NomeFile.Text For Output As NRFILE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Print #NRFILE, Testo.Text</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Close NRFILE</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Salvataggio effettuato!&quot;, 
          vbInformation + vbOKOnly, &quot;Salva&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Exit Sub</li>
        <li>ERRORE:</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Si &egrave; verificato un errore 
          nel salvataggio.&quot;, vbCritical + vbOKOnly, &quot;Salva&quot;</li>
        <li>End Sub</li>
      </ol>
      <p>Alla riga 4 dichiariamo la variabile <b>NRFILE</b> che conterr&agrave; 
        l'<a href="../glossary/h.htm#HANDLE">handle</a> del file in cui verr&agrave; 
        salvato il contenuto della casella di testo.</p>
      <p>Per evitare che gli errori interrompano l'esecuzione del programma, abbiamo 
        inserito una semplice istruzione di gestione degli errori alla riga 5. 
        Nel caso si verificasse qualche errore all'interno di questa routine sar&agrave; 
        mostrato un messaggio di errore (riga 13).</p>
      <p>Per ritrovare un handle di file libero utilizzeremo la funzione <i>FreeFile</i>. 
        Il suo valore sar&agrave; salvato all'interno della variabile <b>NRFILE</b> 
        (riga 6).</p>
      <p>Alla riga 7 viene effettuata l'operazione di apertura del file in modalit&agrave; 
        di scrittura.<br>
        Il file da aprire &egrave; contenuto nella casella di testo <b>NomeFile</b>. 
        La modalit&agrave; di apertura &egrave; Output, ovvero in scrittura. Se 
        il file esiste gi&agrave; esso sar&agrave; sovrascritto automaticamente.<br>
        L'ultimo parametro della funzione Open &egrave; il numero dell'handle 
        <b>NRFILE</b>. </p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Se l'utente ha immesso un nome di file errato oppure ha inserito il nome 
        di una cartella al posto del file, sar&agrave; generato un errore. Tuttavia, 
        l'istruzione di gestione degli errori devier&agrave; l'esecuzione alla 
        fine della Sub, mostrando il messaggio di errore.</p>
      <p>Se non &egrave; stato generato alcun errore, il file sar&agrave; aperto. 
        Sar&agrave; adesso possibile scrivere all'interno del file tramite l'istruzione 
        <b>Print</b> (riga 8).</p>
      <p>L'istruzione di scrittura <i><b>Print</b></i> richiede l'handle del file 
        - preceduto da # - ed il testo da scrivere all'interno del file. Il nostro 
        testo da scrivere &egrave; la propriet&agrave; <i>Text</i> della <i>TextBox</i><img src="../images/controls/textbox.gif" width="25" height="25" align="absmiddle"> 
        <b>Testo</b>. </p>
      <p>Effettuata la scrittura del file sar&agrave; possibile chiudere l'handle 
        utilizzato nell'apertura (riga 9).<br>
        A questo punto segue un messaggio di avvertimento e la funzione termina.</p>
      <p><img src="../images/howto/howto026_02.jpg" width="293" height="170" align="right" alt="Figura 2">Passiamo 
        alla prova del progetto.</p>
      <p>Scriviamo qualcosa all'interno della casella di testo grande, immettiamo 
        nella casella piccola il nome del file in cui salvare e premiamo il tasto 
        Salva per effettuare l'operazione di salvataggio.</p>
      <p>Se l'operazione ha esito positivo sar&agrave; mostrata una finestra informativa; 
        nel caso contrario sar&agrave; mostrato un messaggio di errore.</p>
      <table width="80%" border="0" cellspacing="1" cellpadding="0" align="center">
        <tr> 
          <td align="center"><img src="../images/howto/howto026_03.jpg" width="146" height="95" alt="Figura 3"><br>
            <b>Figura 3</b></td>
          <td align="center"><img src="../images/howto/howto026_04.jpg" width="209" height="95" alt="Figura 4"><br>
            <b>Figura 4</b></td>
        </tr>
      </table>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Il progetto &egrave; estremamente semplice, ma comporta un rischio per 
        l'utilizzatore.<br>
        Infatti l'istruzione Open non effettua alcun controllo d'esistenza del 
        file. Se esso esiste sar&agrave; automaticamente sovrascritto. Ci&ograve; 
        significa che il file precedente sar&agrave; cancellato e sar&agrave; 
        creato un nuovo file che dovr&agrave; contenere il testo della casella 
        di testo.</p>
      <p>Per completare il progetto si consiglia di utilizzare una <a href="ht_011.htm">funzione 
        di verifica dell'esistenza del file</a> prima di effettuare l'apertura.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        13 Febbraio 2001<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
