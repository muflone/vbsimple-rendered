<html>
<!-- #BeginTemplate "/Templates/HowTo.dwt" --> 
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Avviare l'applicazione predefinita per un documento</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr> 
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home 
        Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> 
        <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>
<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Avviare l'applicazione predefinita 
    per un documento<!-- #EndEditable --> <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"> 
        2<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script>
      <!-- #BeginEditable "CORPO" --> 
      <p>Un'attivit&agrave; molto comune &egrave; quella di richiedere l'apertura 
        dell'applicazione predefinita per un documento, ad esempio richiedere 
        l'apertura del <b>browser</b> con riferimento ad un sito internet oppure 
        avviare il <b>Blocco note</b> per visualizzare il contenuto di un file 
        di testo o il <b>lettore multimediale</b> per ascoltare un brano audio. 
        La problematica &egrave; stata affrontata anche in <a href="../activity/act_01.htm">altri 
        articoli</a> ma, viste le continue richieste, ho deciso di pubblicare 
        un articolo dedicato principalmente alla funzione <i><b>ShellExecute</b></i>.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p><img src="../images/howto/howto061_1.png" width="203" height="114" align="left" alt="Figura 1">Il 
        progetto preso in considerazione si comporr&agrave; di un solo form contenente 
        alcuni semplici controlli: una prima Label di nome <b>lblCollegamento</b>, 
        opportunamente adattata graficamente, apparir&agrave; come un normale 
        collegamento ipertestuale. Per far ci&ograve; &egrave; bastato semplicemente 
        assegnare la sottolineatura alla propriet&agrave; <i>Font</i>, modificare 
        il colore, impostare la propriet&agrave; <i>MouseIcon</i> assegnandole 
        il cursore a forma di mano <img src="../images/icons/hand.gif" width="17" height="22" align="absmiddle"> 
        tipico dei browser internet e quindi assegnare il valore 99&nbsp;-&nbsp;Custom 
        alla propriet&agrave; <i>MousePointer</i>.</p>
      <p>Al di sotto di questa esiste un'altra etichetta puramente descrittiva 
        e la relativa casella di testo <b>txtDocumento</b>; essa conterr&agrave; 
        il percorso del documento da aprire. Il primo pulsante <b>cmdAvvia</b> 
        richiamer&agrave; l'applicazione predefinita per il documento indicato, 
        mentre il secondo pulsante <b>cmdTrovaApplicazione</b> mostrer&agrave; 
        il percorso completo dell'applicazione che verr&agrave; richiamata.</p>
      <p>Il codice di questo form &egrave; altrettanto semplice:</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Const MAX_FILENAME_LEN = 260</li>
        <li>Private Declare Function ShellExecute Lib &quot;shell32.dll&quot; 
          Alias &quot;ShellExecuteA&quot; (ByVal hwnd As Long, ByVal lpOperation 
          As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal 
          lpDirectory As String, ByVal nShowCmd As VbAppWinStyle) As Long</li>
        <li>Private Declare Function FindExecutable Lib &quot;shell32.dll&quot; 
          Alias &quot;FindExecutableA&quot; (ByVal lpFile As String, ByVal lpDirectory 
          As String, ByVal lpResult As String) As Long</li>
        <li></li>
      </ol>
      <p>Sono state dichiarate due funzioni dell'API: <i>ShellExecute</i> come 
        gi&agrave; accennato richiamer&agrave; l'applicazione predefinita per 
        il documento specificato nell'argomento <i><b>lpFile</b></i>, ma esiste 
        anche un altro argomento importante di questa funzione; si tratta di <b><i>lpOperation</i></b> 
        che consente di specificare il verbo da eseguire (si raccomanda la consultazione 
        delle <a href="../info/info_19.htm">Informazioni aggiuntive sulla Registrazione 
        delle Estensioni in Windows</a>): <i>open</i> &egrave; il verbo predefinito 
        per richiedere l'apertura del documento e quindi l'avvio dell'applicazione 
        relativa ma per molte estensioni esistono ulteriori verbi: <i>print</i> 
        ad esempio avvia l'applicazione ed effettua la stampa del documento, <i>opennew</i> 
        avvia la pagina web utilizzando una finestra separata e cos&igrave; via. 
        Tutti i verbi sono indicati all'interno del <a href="../glossary/r.htm#REGISTRO">registro 
        di Windows</a> e dipendono dalle singole estensioni. Gli argomenti <i><b>lpParameters</b></i>, 
        <i> <b>lpDirectory</b></i> e <i><b>nShowCmd</b></i> consentono rispettivamente 
        di specificare parametri aggiuntivi nell'esecuzione del comando, di indicare 
        la cartella da cui avviare l'applicazione e la modalit&agrave; di presentazione 
        della finestra come indicato nell'enumerazione <!-- #BeginLibraryItem "/Library/Enumerazione.lbi" --><img src="../images/ide/enumeraz.gif" width="16" height="16" align="absmiddle">&nbsp;<!-- #EndLibraryItem --> 
        <i>VbAppWinStyle</i>.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>L'altra funzione <i>FindExecutable</i> semplicemente ricevendo il percorso 
        di un documento restituisce il percorso dell'applicazione dedicata all'esecuzione.</p>
      <ol start="7" class="codicevb">
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;txtDocumento.Text = App.Path &amp; &quot;\info.txt&quot;</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>All'avvio della nostra applicazione la casella <b>txtDocument</b> conterr&agrave; 
        il percorso del file INFO.TXT contenuto nella cartella del programma; 
        questo solo per inizializzare i controlli e presentare il percorso di 
        un documento sicuramente esistente.</p>
      <ol start="11" class="codicevb">
        <li>Private Sub lblCollegamento_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ShellExecute Me.hwnd, &quot;open&quot;, lblCollegamento.Caption, 
          &quot;&quot;, CurDir, vbMaximizedFocus</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>Al click sopra l'etichetta <b>lblCollegamento</b> sar&agrave; richiamata 
        la funzione <i>ShellExecute</i> per richiedere l'apertura del browser 
        (o pi&ugrave; precisamente dell'applicazione dedicata alla visualizzazione 
        degli indirizzi con protocollo http). Il verbo specificato &egrave; <i><b>open</b></i>, 
        il predefinito per l'esecuzione, mentre il documento da avviare &egrave; 
        il percorso indicato nell'etichetta stessa (<i>http://www.vbsimple.net</i>). 
        L'ultimo argomento <i>vbMaximizedFocus</i> indicher&agrave; di mostrare 
        la finestra in maniera ingrandita e attivata.</p>
      <ol start="15" class="codicevb">
        <li>Private Sub cmdAvvia_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;ShellExecute Me.hwnd, &quot;open&quot;, txtDocumento.Text, 
          &quot;&quot;, CurDir, vbNormalFocus</li>
        <li>End Sub</li>
        <li></li>
      </ol>
      <p>In maniera analoga alla precedente, il click sopra il pulsante cmdAvvia 
        avvier&agrave; l'applicazione predefinita per il documento indicato nella 
        casella <b>txtDocumento</b>, sempre utilizzando il verbo open. A differenza 
        dal caso precedente non sar&agrave; modificata la visuailzzazione della 
        finestra ma indicando la costante <i>vbNormalFocus</i> sar&agrave; mostrata 
        semplicemente la finestra senza.</p>
      <ol start="19" class="codicevb">
        <li>Private Sub cmdTrovaApplicazione_Click()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Dim strPercorso As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;strPercorso = Space$(MAX_FILENAME_LEN)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call FindExecutable(txtDocumento.Text, vbNullChar, 
          strPercorso)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;L'applicazione predefinita è: 
          &quot; & vbNewLine & _</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left$(strPercorso, 
          InStr(1, strPercorso, vbNullChar) - 1), _</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbInformation, &quot;Applicazione 
          predefinita&quot;</li>
        <li>End Sub</li>
      </ol>
      <p>L'ultimo evento &egrave; quello legato al pulsante <b>cmdTrovaApplicazione</b> 
        che si occuper&agrave; di riportare il percorso dell'applicazione dedicata 
        all'apertura del documento. Allocato il buffer (riga&nbsp;21) baster&agrave; 
        chiamare la funzione <i>FindExecutable</i> specificando il percorso del 
        documento per ricevere il percorso dell'applicazione all'interno del buffer 
        preallocato.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Sar&agrave; naturalmente necessario eliminare il carattere Null finale 
        alla stringa di testo restituita. Il risultato ottenuto &egrave; il seguente:</p>
      <table width="70%" border="0" cellspacing="4" cellpadding="0" align="center">
        <tr> 
          <td width="30%" align="center" valign="top"><img src="../images/howto/howto061_2.png" width="203" height="114" alt="Figura 2"><br>
            <b>Figura 2</b></td>
          <td width="40%" align="center" valign="top"><img src="../images/howto/howto061_3.png" width="198" height="95" alt="Figura 3"><br>
            <b>Figura 3</b></td>
        </tr>
        <tr> 
          <td colspan="2" align="center" valign="top"><img src="../images/howto/howto061_4.png" width="296" height="222" alt="Figura 4"><br>
            <b>Figura 4</b></td>
        </tr>
      </table>
      <p>Al passaggio del cursore del mouse sopra l'etichetta sar&agrave; mostrata 
        la manina tipica dei collegamenti ipertestuali (<b>Figura 2</b>) ed al 
        click verr&agrave; avviato il browser e mostrata l'home page di VBSimple; 
        al click del pulsante <i><b>Trova applicazione</b></i> sar&agrave; indicato 
        il percorso dell'applicazione dedicata all'esecuzione per l'avvio del 
        documento specificato nella casella di testo (<b>Figura&nbsp;3</b>); il 
        click sul pulsante <i><b>Avvia</b></i> invece avvier&agrave; l'applicazione 
        e quindi il documento indicato (<b>Figura 4</b>).</p>
      <p>Alla stessa maniera pu&ograve; essere avviato anche il programma di posta 
        elettronica predefinito semplicemente richiedendo l'apertura di un documento 
        composto da mailto: e seguito dall'indirizzo di posta elettronica; questa 
        tecnica &egrave; stata trattata nell'<a href="ht_020.htm">HowTo dedicato 
        all'invio di un'email tramite un programma esterno</a>.</p>
      <!-- #EndEditable --></td>
  </tr>
</table>
<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>La funzione <i>ShellExecute</i> si presta a tantissime operazioni, alcune 
        delle quali gi&agrave; indicate, altre trattate invece in altri articoli 
        di questa sezione.</p>
      <!-- #EndEditable --> 
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        24 Aprile 2004<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem --> </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr> 
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>
<hr width="80%">
<table width="100%">
  <tr> 
    <td width="100%" align="center"> 
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""--> </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate -->
</html>
