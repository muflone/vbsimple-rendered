<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Associare un programma ad un'estensione (seconda parte)</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Associare un programma ad 
    un'estensione<br>
    (seconda parte)<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><img src="../images/api.gif" width="34" height="24" align="absmiddle"><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --><img src="../images/icons/level2.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level3.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level4.gif" width="17" height="18" align="absmiddle"><img src="../images/icons/level5.gif" width="17" height="18" align="absmiddle"> 
        5<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" -->
<p align="center"><a href="ht_054.htm">&lt;&lt; Continua dalla parte 1</a></p>
      <p>Segue l'unico metodo pubblico della classe: <b>Register</b>, che consente 
        di registrare nel sistema l'estensione specificata ed associarvi un verbo, 
        completo di descrizione aggiuntiva e del percorso del programma da richiamare.</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <ol start="106" class="codicevb">
        <li>Public Function Register(ByVal newName As String, ByVal newFullName 
          As String, ByVal newCommandPath As String) As Boolean</li>
        <li>&nbsp;&nbsp;Dim fbiRegistry As clsFBIRegistry</li>
        <li>&nbsp;&nbsp;Dim strNewPath As String</li>
        <li>&nbsp;&nbsp;Register = False</li>
        <li>&nbsp;&nbsp;m_SavedPath = &quot;&quot;</li>
        <li>&nbsp;&nbsp;If ShowError(Len(m_strExt) = 0, &quot;Specificare un valore 
          per la propriet&agrave; Extension&quot;) Then Exit Function</li>
        <li>&nbsp;&nbsp;If ShowError(Len(m_strFileType) = 0, &quot;Specificare 
          un valore per la propriet&agrave; FileType&quot;) Then Exit Function</li>
        <li>&nbsp;&nbsp;If ShowError(Len(newName) = 0, &quot;Specificare un valore 
          per il nome del verbo&quot;) Then Exit Function</li>
        <li>&nbsp;&nbsp;Set fbiRegistry = New clsFBIRegistry</li>
        <li></li>
      </ol>
      <p>Alla riga 107 &egrave; dichiarata la variabile <b>fbiRegistry</b> che 
        verr&agrave; utilizzata per accedere al registro mediante la classe <i>clsFBIRegistry</i>. 
        Alla riga 114 &egrave; istanziata la variabile <b>fbiRegistry</b>. L'altra 
        variabile <b>strNewPath</b> sar&agrave; utilizzata per determinare la 
        posizione in cui andranno memorizzate le impostazioni.</p>
      <p>La funzione restituisce un valore booleano corrispondente all'avvenuta 
        registrazione. Durante l'avvio saranno verificati i valori delle propriet&agrave; 
        <b>Extension</b>, <b>FileType</b> e del verbo da registrare. In caso di 
        valori nulli sar&agrave; generato un errore e la funzione sar&agrave; 
        interrotta.</p>
      <ol start="116" class="codicevb">
        <li> &nbsp;&nbsp;With fbiRegistry</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(HKEY_CLASSES_ROOT, &quot;.&quot; 
          & m_strExt)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;If m_PreserveSettings Then</li>
        <li> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strNewPath = .Valore(&quot;&quot;) 
          &amp; &quot;&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(strNewPath) &gt; 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_DeferSettings = 
          True</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(HKEY_CLASSES_ROOT, 
          strNewPath)</li>
      </ol>
      <p>Poich&eacute; verr&agrave; utilizzata dappertutto l'istanza <b>fbiRegistry</b> 
        si &egrave; scelto di attivare il qualificatore immediato con With. La 
        prima operazione da effettuare &egrave; quella di aprire (o creare se 
        inesistente) la chiave corrispondente all'estensione da registrare.</p>
      <p>La riga 118 spezza la funzione in due grosse parti: se la propriet&agrave; 
        <b>PreserveSettings</b> &egrave; impostata su True allora dovranno essere 
        rilevate le impostazioni attuali e preservate; in caso contrario dovranno 
        essere utilizzate le altre propriet&agrave; della classe, senza alcun 
        rispetto dei valori attuali.</p>
      <p>Nel caso si scelga di preservare le impostazioni attuali, la prima operazione 
        da eseguire sar&agrave; quella di capire se attualmente &egrave; utilizzato 
        il deferring e tale verifica &egrave; fatta alle righe 119-120. Se esiste 
        un valore di deferring sar&agrave; ridefinito il valore della propriet&agrave; 
        <b>DeferSettings</b> e sar&agrave; aperta la chiave puntata dal valore 
        di deferring.</p>
      <ol start="123" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If .ApriChiave(CHIAVE_APERTA, 
          &quot;shell&quot;) &lt;&gt; 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_DeferSettings 
          = False</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strNewPath 
          = &quot;.&quot; &amp; m_strExt</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If m_DeferSettings 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strNewPath 
          = m_DeferredPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call 
          .ApriChiave(HKEY_CLASSES_ROOT, &quot;.&quot; &amp; m_strExt)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Valore(&quot;&quot;, 
          REG_SZ) = strNewPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strNewPath 
          = &quot;.&quot; &amp; m_strExt</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(HKEY_CLASSES_ROOT, 
          strNewPath)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If (Len(m_strFileType) 
          &gt; 0) And (m_DeferSettings) Then .Valore(&quot;&quot;, REG_SZ) = m_strFileType</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
      </ol>
      <p>Le cose si complicano se la registazione attuale non utilizza deferring. 
        Ci&ograve; infatti pu&ograve; significare che la chiave non esiste oppure 
        esiste ma semplicemente non fa uso di una registrazione reinviata.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Il primo controllo quindi da effettuare consiste nel verificare che esista 
        una sottochiave di nome <i><b>shell</b></i> (riga 124). In tal caso sar&agrave; 
        ridefinito il valore della propriet&agrave; <b>DeferSettings</b> per informare 
        l'utente che le impostazioni attuali non utilizzano deferring e ci si 
        prepara a lavorare con una chiave non rinviata.</p>
      <p>Nel caso che la sottochiave shell non esista invece il programma dovr&agrave; 
        comportarsi secondo le impostazioni delle propriet&agrave; <b>DeferSettings</b> 
        e <b>DeferredPath</b>. Alla riga 131 sar&agrave; assegnato il valore per 
        la chiave reinviata che sar&agrave; creata alla riga 137.</p>
      <p>Se la propriet&agrave; <b>FileType</b> contiene qualche valore e si sta 
        applicando il deferring allora sar&agrave; aggiunta anche la descrizione 
        aggiuntiva del tipo di file.</p>
      <ol start="140" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_SavedPath = &quot;HKEY_CLASSES_ROOT\&quot; 
          &amp; strNewPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          &quot;shell&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(m_strDefaultVerb) &gt; 
          0 Then .Valore(&quot;&quot;) = m_strDefaultVerb</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          newName &amp; &quot;\command&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If ShowError(Len(.Valore(&quot;&quot;, 
          REG_SZ) &amp; &quot;&quot;) &gt; 0, &quot;Impossibile sovrascrivere 
          il verbo &quot; &amp; UCase$(newName) & vbNewLine &amp; &quot;se la 
          propriet&agrave; PreserveSettings &egrave; impostata su True&quot;) 
          Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set fbiRegistry = 
          Nothing</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit Function</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ApriChiave(HKEY_CLASSES_ROOT, 
          strNewPath)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(m_strDefaultIcon) 
          &gt; 0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          &quot;DefaultIcon&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Valore(&quot;&quot;, 
          REG_SZ) = m_strDefaultIcon</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ApriChiave(HKEY_CLASSES_ROOT, 
          strNewPath &amp; &quot;\shell\&quot; &amp; newName)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
      </ol>
      <p>Questa &egrave; la parte pi&ugrave; complessa del codice. Dopo aver registrato 
        il valore della chiave in cui andranno memorizzati i verbi viene creata 
        la sottochiave <i><b>shell</b></i> (riga 141). Se &egrave; stato assegnato 
        un valore alla propriet&agrave; <b>DefaultVerb</b> questo sar&agrave; 
        immediatamente scritto nel valore predefinito della chiave appena creata.</p>
      <p>Saranno quindi create con una sola riga le due sottochiavi corrispondenti 
        al verbo richiesto nella registrazione (<b>newName</b>) e la corrispondente 
        sottochiave <i><b>command</b></i>. Se la chiave esistesse gi&agrave; e 
        ci fosse un valore predefinito l'elaborazione non dovr&agrave; procedere 
        ulteriormente per non sovrascrivere i dati preesistenti. Infatti la propriet&agrave; 
        <b>PreserveSettings</b> non consente di sovrascrivere verbi esistenti. 
        Saranno quindi in ordine generato l'evento <i><b>Error</b></i>, chiusa 
        l'ultima chiave usata, deallocata la variabile <b>fbiRegistry</b> ed interrotta 
        l'esecuzione della funzione (righe 144-147).</p>
      <p>Se invece la chiave non esistesse sar&agrave; semplicemente chiusa la 
        chiave <i><b>command</b></i> aperta in precedenza ed aperta la chiave 
        corrispondente al punto di registrazione (estensione o deferring). Dovr&agrave; 
        quindi essere registrata l'icona specificata nella propriet&agrave; <b>DefaultIcon</b> 
        (righe 151-155).</p>
      <p>Completate queste premesse ci si potr&agrave; preparare alla registrazione 
        del verbo vero e proprio.</p>
      <ol start="158" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If m_DeferSettings Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Valore(&quot;&quot;, 
          REG_SZ) = m_DeferredPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(HKEY_CLASSES_ROOT, 
          m_DeferredPath, False)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_SavedPath = &quot;HKEY_CLASSES_ROOT\&quot; 
          &amp; m_DeferredPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(m_strFileType) 
          &gt; 0 Then .Valore(&quot;&quot;, REG_SZ) = m_strFileType</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .EliminaValore(&quot;&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_SavedPath = &quot;HKEY_CLASSES_ROOT\.&quot; 
          &amp; m_strExt</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(m_strDefaultIcon) &gt; 
          0 Then</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          &quot;DefaultIcon&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Valore(&quot;&quot;, 
          REG_SZ) = m_strDefaultIcon</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .ApriChiave(HKEY_CLASSES_ROOT, 
          IIf(m_DeferSettings, m_DeferredPath, &quot;.&quot; &amp; m_strExt))</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          &quot;shell&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Len(m_strDefaultVerb) &gt; 
          0 Then .Valore(&quot;&quot;) = m_strDefaultVerb</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, 
          newName)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;End If</li>
      </ol>
      <p>Resta da valutare l'intera situazione in cui &egrave; stato scelto di 
        non preservare le impostazioni attuali. Sar&agrave; verificato se dalla 
        propriet&agrave; <b>DeferSettings</b> &egrave; stato scelto di usare il 
        deferring: in tal caso sar&agrave; applicato immediatamente registrandone 
        il valore e creando la nuova chiave (righe 159-162). Sar&agrave; inoltre 
        aggiunta la descrizione completa del tipo di file (riga 163).<br>
        Nel caso non si desiderasse utilizzare il deferring &egrave; fondamentale 
        assicurarsi che sia eliminato l'eventuale deferring preesistente, che 
        altrimenti avrebbe la priorit&agrave; (riga 165).</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Se &egrave; stata impostata un'icona nella propriet&agrave; <b>DefaultIcon</b> 
        essa sar&agrave; registrata alle righe 168-173. Lo stesso vale per il 
        verbo di default (riga 175).</p>
      <p>Al raggiungimento della riga 178 la chiave correntemente aperta punter&agrave; 
        esattamente al verbo da registrare (righe 156 e 176).</p>
      <ol start="178" class="codicevb">
        <li> &nbsp;&nbsp;&nbsp;&nbsp;If Len(newFullName) &gt; 0 Then .Valore(&quot;&quot;, 
          REG_SZ) = newFullName</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call .CreaChiave(CHIAVE_APERTA, &quot;command&quot;)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;.Valore(&quot;&quot;, REG_SZ) = newCommandPath</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Call .ChiudiChiave</li>
        <li>&nbsp;&nbsp;End With</li>
        <li>&nbsp;&nbsp;Set fbiRegistry = Nothing</li>
        <li>&nbsp;&nbsp;Register = True</li>
        <li>End Function</li>
      </ol>
      <p>Segue la fase conclusiva della registrazione: la scrittura della descrizione 
        aggiuntiva al verbo, se esiste nel parametro <b>newFullName</b>. Sar&agrave; 
        infine creata la chiave <i><b>command</b></i> in cui sar&agrave; scritto 
        il percorso del programma da richiamare per il verbo indicato.</p>
      <p>La routine volge al termine con la chiusura dell'ultima chiave usata, 
        la <a href="../glossary/d.htm#DEALLOCARE">deallocazione</a> della variabile 
        <b>fbiRegistry</b> e l'impostazione del valore di ritorno a True, ad indicare 
        la corretta registrazione del verbo.<br>
        <br>
      </p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>Nell'esempio allegato &egrave; presente anche un progetto che utilizza 
        questa classe con dati dimostrativi ma fondalmente inutili. Saranno utilizzate 
        tutte le propriet&agrave; e le due modalit&agrave; di registrazione dei 
        dati, mediante scrittura sulla chiave dell'estensione e mediante deferring.</p>
      <p>Si raccomanda di guardare i cambiamenti direttamente sul registro di 
        Windows man mano che vengono chiamate le funzioni <b>Register</b>.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        22 Dicembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
