<html><!-- #BeginTemplate "/Templates/HowTo.dwt" -->
<head>
<script language="JavaScript" src="../funzioni.js"></script>
<script language="JavaScript" src="../scroller.js"></script>
<!-- #BeginEditable "doctitle" --> 
<title>Array Pubblici in un Form</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../stili.css" rel="stylesheet" type="text/css" title="stili">
<link href="../codicevb.css" rel="stylesheet" type="text/css" title="codicevb">
<link href="../colori.css" rel="stylesheet" type="text/css" title="colori">
<meta name="description" content="Visual Basic Simple &egrave; l'unico sito in Italia che tratta la programmazione in Visual Basic in un'ottica mai vista prima d'ora. Tutti gli articoli sono spiegati passo dopo passo ed in una maniera davvero semplice per consentire a tutti di comprendere gli argomenti trattati.">
<meta name="keywords" content="VB, Visual, Basic, Simple, programmazione, codici, esempi, manuali, studio, sviluppo, ActiveX, OCX, articoli, notizie, apprendere, QBasic, API, COM, database">
</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0">
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
  <tr>
    <td width="400" align="left" bgcolor="#FFFFFF"><img src="../images/vbslogo.jpg" width="400" height="80" border="0" alt="Visual Basic Simple"></td>
    <td width="100%" align="right" bgcolor="#FFFFFF"> 
      <div class="intestazioni"><a href="../home.htm">Home Page</a> <a href="../home.htm"><img src="../images/icons/dothome.gif" align="absmiddle" border="0" alt="Home Page" width="25" height="25"></a><br>
        <a href="../history.htm">Novit&agrave;</a> <a href="../history.htm"><img src="../images/icons/dotinfo.gif" align="absmiddle" border="0" alt="Informazioni su VB Simple" width="25" height="25"></a><br>
        <a href="../help.htm">Aiuto</a> <a href="../help.htm"><img src="../images/icons/dothelp.gif" align="absmiddle" border="0" alt="Hai bisogno d'aiuto?" width="25" height="25"></a></div>
    </td>
    <td width="160" align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 160x90, creato 02/02/09 */
google_ad_slot = "8970907891";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>
  </tr>
</table>

<div align="center"> 
  <div class="titolo"><!-- #BeginEditable "TITOLO" -->Array Pubblici in un Form<!-- #EndEditable --> 
    <!-- #BeginEditable "API" --><!-- #EndEditable --></div>
  <script language="Javascript">NomePagina();</script>
  <table width="80%" border="1" cellspacing="1" cellpadding="3" bordercolorlight="#000000" bordercolordark="#000000" class="dontprint">
    <tr class="size0"> 
      <td align="center" width="25%"><a href="../ftv21/howto.htm" target="treeframe"><img src="../images/icons/search%20window.gif" width="16" height="16" border="0" alt="Sincronizza Indice"><br>
        Sincronizza Indice</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
        Scarica il progetto</a></td>
      <td align="center" width="25%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
        Testo dell'articolo</a></td>
      <td align="center" width="25%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
        Stampa l'articolo</a></td>
    </tr>
  </table>
</div>
<table width="100%" border="0">
  <tr> 
    <td width="80%"> 
      <table width="100%"><tr><td align="left" nowrap><style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.it/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-8218922773694577:rv2o52-qh5a" />
        <input type="hidden" name="ie" value="ISO-8859-1" />
        <input type="text" name="q" size="20" />
        <input type="submit" name="sa" value="Cerca" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Ricerca personalizzata
  </div>
</div></td><td align="right">
      <p align="right" class="size3">Difficolt&agrave;: <img src="../images/icons/level1.gif" width="17" height="18" align="absmiddle"><!-- #BeginEditable "DIFFICOLTA" --> 
        1<!-- #EndEditable --> / 5</p>
</td></tr></table>
      <script language="JavaScript">ShowArticlesScroller();</script><!-- #BeginEditable "CORPO" --> 
      <p>Un limite davvero pesante, noioso e del tutto ingiustificato &egrave; 
        quello imposto dall'impossibilit&agrave; di dichiarare un <a href="../glossary/a.htm#ARRAY">array</a> 
        pubblico di qualsiasi tipo all'interno di un modulo di oggetto, quale 
        un Form.<br>
        Ad esempio una dichiarazione del genere non &egrave; valida e genera un 
        errore in fase di compilazione se posto all'interno di un Form:</p>
      <p class="codicevb" align="center">Public arr1(2, 1) As String</p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo grafica */
google_ad_slot = "0981518759";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Vedremo in quest'articolo come superare questo limite che avr&agrave; 
        creato delle grane a pi&ugrave; di una persona, senza obbligare il programmatore 
        a porre tali dati all'interno di un modulo <img src="../images/ide/modulo.gif" width="16" height="16" align="absmiddle"> 
        standard.</p>
      <p>Accontentiamo il compilatore e dichiariamo tale vettore con Private, 
        rendendolo quindi inaccessibile dall'esterno. Per consentire l'uso indiretto 
        dell'array da parte di altre parti del codice utilizzeremo una propriet&agrave; 
        <img src="../images/ide/propr.gif" width="16" height="16" align="absmiddle"> 
        <a href="../glossary/w.htm#WRAPPER">wrapper</a> in lettura e scrittura 
        che maneggi i dati del vettore come se fossero accessibili direttamente 
        dall'esterno.</p>
      <p>Sviluppiamo un progettino composto da due soli form, senza interfaccia. 
        Il primo form conterr&agrave; l'array privato e la propriet&agrave; pubblica.</p>
      <ol start="1" class="codicevb">
        <li>Option Explicit</li>
        <li>Private arr1(2, 1) As String</li>
        <li></li>
        <li>Public Property Get Array1(ByVal Indice1 As Integer, ByVal Indice2 
          As Integer) As String</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Array1 = arr1(Indice1, Indice2)</li>
        <li>End Property</li>
        <li></li>
        <li>Public Property Let Array1(ByVal Indice1 As Integer, ByVal Indice2 
          As Integer, ByVal Valore As String)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(Indice1, Indice2) = Valore</li>
        <li>End Property </li>
        <li></li>
      </ol>
      <p>La propriet&agrave; in questione si chiama <b>Array1</b> e richiede il 
        passaggio di due argomenti, corrispondenti alle due dimensioni dell'array 
        <b>arr1</b>. La propriet&agrave; in lettura (righe 4-6) recupera i dati 
        dall'array utilizzando i due indici forniti alla propriet&agrave; e li 
        restituisce in uscita, mentre la propriet&agrave; in scrittura (righe 
        8-10) effettua l'operazione inversa.</p>
      <p><img src="../images/notes.gif" width="56" height="57" align="left"><b class="colorerosso">Nota 
        bene!</b><br>
        L'uso di propriet&agrave; che richiedono il passaggio di almeno un argomento 
        durante la lettura necessitano una cura maggiore. Infatti la controparte 
        in scrittura richiede gli stessi argomenti (nell'esempio <b>Indice1</b> 
        ed <b>Indice2</b>) ed il passaggio del nuovo valore da assegnare. L'ordine 
        con cui questi argomenti sono dichiarati potrebbe generare confusione: 
        in tali situazioni &egrave; fondalmentale ricordare che il nuovo valore 
        della propriet&agrave; <b>va dichiarato per ultimo</b>, in fondo all'elenco 
        degli argomenti obbligatori della propriet&agrave;.</p>
    <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* Contenuti 468x60 */
google_ad_slot = "0785185013";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <p>Aggiungiamo un paio di righe giusto per effettuare un controllo di funzionamento:</p>
      <ol start="12" class="codicevb">
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(0, 0) = &quot;Ciao&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(0, 1) = &quot;Ciccio&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(1, 0) = &quot;Hello&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(1, 1) = &quot;Paperino&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(2, 0) = &quot;Bonjour&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;arr1(2, 1) = &quot;Topolino&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Load Form2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Unload Form2</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Unload Me</li>
        <li>End Sub</li>
      </ol>
      <p>Le righe 13-18 inizializzano l'array all'interno del primo form con dei 
        valori.<br>
        Alla riga 19 &egrave; caricato il secondo form, che si occuper&agrave; 
        di leggere e modificare i valori della matrice dall'esterno. poich&eacute; 
        i due form non ci servono ad altro saranno normalmente scaricati.</p>
      <p>All'interno del secondo form abbiamo un codice ancora pi&ugrave; semplice:</p>
      <ol class="codicevb">
        <li>Option Explicit</li>
        <li></li>
        <li>Private Sub Form_Load()</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox Form1.Array1(0, 1)</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;Form1.Array1(0, 1) = &quot;Ciccino&quot;</li>
        <li>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox Form1.Array1(0, 1)</li>
        <li>End Sub</li>
      </ol>
      <p>Al caricamento del form viene inizialmente presentato un valore della 
        matrice nel primo form (dimostrando quindi la possibilit&agrave; di leggerne 
        i valori), corrispondente a <i><b>&quot;Ciccio&quot;</b></i>. Alla riga 
        5 tale valore &egrave; modificato in <i><b>&quot;Ciccino&quot;</b></i> 
        (dimostrando quindi la possibilit&agrave; di modificare i valori). Alla 
        riga 6 lo stesso valore &egrave; riletto (per dimostrare ancora l'avvenuta 
        scrittura).<br>
        <br>
      </p>
      <p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-8218922773694577";
/* 468x60 solo testo */
google_ad_slot = "6726967947";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
      <!-- #EndEditable --></td>
  </tr>
</table>

<table width="100%">
  <tr> 
    <td><!-- #BeginEditable "FINALE" --> 
      <p>La stessa soluzione pu&ograve; essere applicata per accedere a variabili 
        e stringhe a lunghezza fissa.</p>
      <p> Non si tratta di un'idea geniale per evitare una limitazione del linguaggio. 
        &Egrave; piuttosto l'applicazione di un concetto di base della <a href="../glossary/p.htm#PROGRAMMAZIONEADOGGETTI">programmazione 
        ad oggetti</a> ed in linea generale teorica nessun dato all'interno di 
        una classe dovrebbe essere accessibile dall'esterno se non mediante l'uso 
        di un <a href="../glossary/m.htm#METODO">metodo</a>&nbsp;<img src="../images/ide/metodo.gif" width="16" height="16" align="absmiddle"> 
        o di una propriet&agrave; della classe stessa.</p>
      <!-- #EndEditable -->
      <p align="right" class="credits2"><!-- #BeginEditable "CREDITS" --><a href="../vbmail.htm?id=1">Fibia 
        FBI</a><br>
        21 Dicembre 2002<!-- #EndEditable --></p>
      <!-- #BeginLibraryItem "/Library/Toolbar.lbi" -->
      <table width="80%" border="1" cellspacing="1" cellpadding="3" align="center" bordercolor="#000000" class="dontprint">
        <tr> 
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaZIP();"><img src="../images/icons/tool%20download.gif" width="16" height="18" border="0" alt="Scarica il progetto"><br>
            <span class="size1">Scarica il progetto</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:ScaricaPDF();"><img src="../images/icons/tool%20pdf.gif" width="16" height="18" alt="Scarica il testo dell'articolo" border="0"><br>
            <span class="size1">Scarica il testo dell'articolo</span></a></td>
          <td align="center" valign="top" width="33%"><a href="javascript:Stampa();"><img src="../images/icons/tool%20print.gif" width="16" height="18" alt="Stampa l'articolo" border="0"><br>
            <span class="size1">Stampa l'articolo</span></a></td>
        </tr>
      </table><!-- #EndLibraryItem -->
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tr>
    <td align="left"><a href="index.htm"><img src="../images/vbprev.jpg" width="49" height="32" align="absmiddle" border="0"> 
      Torna all'indice degli HowTo</a></td>
    <td align="right">&nbsp;</td>
  </tr>
</table>

<hr width="80%">
<table width="100%">
  <tr>
    <td width="100%" align="center">
      <script language="Javascript">Banner();</script>
      <!--#echo banner=""-->
    </td>
  </tr>
</table>
<script language="Javascript">FibiaWebStats();</script>
</body>
<!-- #EndTemplate --></html>
